cscope 15 /afs/cs.wisc.edu/p/paradyn/development/wenbin/spi/spi/src/Agent               0000145881
	@SpAddrSpace.C

1 
	~"SpAddrS·û.h
"

2 
	~"SpObjeù.h
"

4 
usšg
 
	gdt
::
Add»ss
;

5 
usšg
 
	g¥
::
SpAddrS·û
;

6 
usšg
 
	gph
::
P©chObjeù
;

8 
Çme¥aû
 
	g¥
 {

12 
	gSpAddrS·û
::
SpAddrS·û
(è: 
ph
::
AddrS·û
() {

13 
upd©e_mem_m­s
();

18 
SpAddrS·û
*

19 
	gSpAddrS·û
::
ü—‹
(
P©chObjeù
* 
obj
) {

20 
as£¹
(
obj
);

21 
SpAddrS·û
* 
	g»t
 = 
Ãw
 SpAddrSpace;

22 ià(!
	g»t
) „et;

23 
	g»t
->
š™
(
obj
);

24  
	g»t
;

28 
Add»ss


29 
	gSpAddrS·û
::
m®loc
(
P©chObjeù
* 
obj
, 
size_t
 
size
, 
Add»ss
 
Ã¬
) {

30 
Add»ss
 
	gbuf
 = 0;

31 
	gbuf
 = (
Add»ss
)::
m®loc
(
size
+ 
g‘·gesize
() -1);

32 ià(!
	gbuf
)  0;

33 
	gbuf
 = (((
Add»ss
)
buf
 + 
g‘·gesize
()-1) & ~(getpagesize()-1));

34  
	gbuf
;

37 
Add»ss
 
	gps
 = 
g‘·gesize
();

38 
Add»ss
 
	gr_Ã¬
 = ((
Ã¬
 + 
ps
 -1) & ~(ps - 1));

39 
Add»ss
 
	gr_size
 = ((
size
 + 
ps
 -1) & ~(ps - 1));

40 
	gbuf
 = 
r_Ã¬
;

44 * 
	gm
 = 
NULL
;

45 
	gfd
 = -1;

46 !
	gm
 || ()m == -1) {

47 
buf
 -ğ
r_size
;

48 
¥_´št
("lookšg fÜ %lx", 
buf
);

49 
	gm
 = 
mm­
((*)
buf
,

50 
r_size
,

51 
PROT_WRITE
 | 
PROT_READ
,

52 
MAP_PRIVATE
 | 
MAP_FIXED
 | 
MAP_ANONYMOUS
,

53 
fd
,

56 ià(!
	gm
)  0;

58  (
	gAdd»ss
)
	gm
;

62 
boŞ


63 
	gSpAddrS·û
::
wr™e
(
P©chObjeù
* 
obj
, 
Add»ss
 
to
, Add»s 
äom
, 
size_t
 
size
) {

64  (
memıy
((*)
to
, (*)
äom
, 
size
) == (*)to);

68 
boŞ


69 
	gSpAddrS·û
::
ä“
(
P©chObjeù
* 
obj
, 
Add»ss
 
Üig
) {

72 ::
ä“
((*)
Üig
);

73  
	gŒue
;

77 
boŞ


78 
	gSpAddrS·û
::
£t_¿nge_³rm
(
Add»ss
 
a
, 
size_t
 
Ëngth
, 
³rm
) {

79 
boŞ
 
	g»t
 = 
çl£
;

85 
	gMemM­pšgs
::
™”©Ü
 
mi
 = 
mem_m­s_
.
begš
();

86 
	gmi
 !ğ
mem_m­s_
.
’d
(); mi++) {

87 
Add»ss
 
	g¡¬t
 = 
mi
->
fœ¡
;

88 
	gMemM­pšg
& 
	gmm
 = 
mi
->
£cÚd
;

89 
Add»ss
 
	g’d
 = 
mm
.
’d
;

90 
Add»ss
 
	gcode_’d
 = 
a
 + 
Ëngth
;

91 ià((
	ga
 >ğ
¡¬t
 && 
code_’d
 < 
’d
) ||

92 (
a
 <ğ
¡¬t
 && 
code_’d
 >ğ¡¬ˆ&& code_’d <ğ
’d
) ||

93 (
a
 >ğ
¡¬t
 &&‡ < 
’d
 && 
code_’d
 >=ƒnd)) {

94 
¥_debug
("PERM - [%lx, %lxèov”Ïp (%lx, %lx)", 
¡¬t
, 
’d
, 
a
, 
code_’d
);

95 ià(
m´Ùeù
((*)
¡¬t
, 
’d
 - s¹, 
³rm
) < 0) {

96 
¥_´št
("MPROTECT - Failedo change memory‡ccess…ermission");

97 
³¼Ü
("mprotect");

98  
	gçl£
;

100 
	g»t
 = 
Œue
;

106 ià(!
	g»t
) {

107 
Add»ss
 
	g®igÃd
 = 
a
;

108 
size_t
 
	gpz
 = 
g‘·gesize
();

109 
	g®igÃd
 = (
Add»ss
)(((Add»ssè
®igÃd
 + 
pz
-1) & ~(pz-1));

110 ià(
m´Ùeù
((*)
®igÃd
, 
Ëngth
, 
³rm
) < 0) {

111 
¥_´št
("MPROTECT - Failedo change memory‡ccess…ermission");

112 
³¼Ü
("mprotect");

113  
	gçl£
;

115 
	g»t
 = 
Œue
;

119  
	g»t
;

122 
boŞ


123 
	gSpAddrS·û
::
»¡Üe_¿nge_³rm
(
Add»ss
 
a
, 
size_t
 
Ëngth
) {

124 
boŞ
 
	g»t
 = 
çl£
;

125 
	gMemM­pšgs
::
™”©Ü
 
mi
 = 
mem_m­s_
.
begš
();

126 
	gmi
 !ğ
mem_m­s_
.
’d
(); mi++) {

127 
Add»ss
 
	g¡¬t
 = 
mi
->
fœ¡
;

128 
	gMemM­pšg
& 
	gmm
 = 
mi
->
£cÚd
;

129 
Add»ss
 
	g’d
 = 
mm
.
’d
;

130 
Add»ss
 
	gcode_’d
 = 
a
 + 
Ëngth
;

131 ià((
	ga
 >ğ
¡¬t
 && 
code_’d
 < 
’d
) ||

132 (
a
 <ğ
¡¬t
 && 
code_’d
 >ğ¡¬ˆ&& code_’d <ğ
’d
) ||

133 (
a
 >ğ
¡¬t
 &&‡ < 
’d
 && 
code_’d
 >=ƒnd)) {

135 ià(
m´Ùeù
((*)
¡¬t
, 
’d
 - s¹, 
mem_m­s_
[¡¬t].
³rms
) < 0) {

136 
¥_´št
("MPROTECT - Failedo change memory‡ccess…ermission");

137  
	gçl£
;

139 
	g»t
 = 
Œue
;

143  
	g»t
;

148 
	gSpAddrS·û
::
upd©e_mem_m­s
() {

150 
m­s_fe
[256];

151 
¥rštf
(
m­s_fe
, "/´oc/%d/m­s", 
g‘pid
());

153 
FILE
* 
	gå
 = 
fİ’
(
m­s_fe
, "r");

154 ià(!
	gå
) {

155 
¥_³¼Ü
("FAILEDØİ’ memÜy m­pšg f%s", 
m­s_fe
);

157 
	glšebuf
[2048];

158 
fg‘s
(
lšebuf
, 2048, 
å
è!ğ
NULL
) {

159 * 
¡¬t_addr_s
 = 
lšebuf
;

160 * 
	g’d_addr_s
 = 
¡rchr
(
lšebuf
, '-');

161 *
	g’d_addr_s
 = '\0';

162 
	g’d_addr_s
++;

164 * 
	g³rms_s
 = 
¡rchr
(
’d_addr_s
, ' ');

165 *
	g³rms_s
 = '\0';

166 
	g³rms_s
++;

168 * 
	goff£t_s
 = 
¡rchr
(
³rms_s
, ' ');

169 *
	goff£t_s
 = '\0';

170 
	goff£t_s
++;

172 * 
	gdev_s
 = 
¡rchr
(
off£t_s
, ' ');

173 *
	gdev_s
 = '\0';

174 
	gdev_s
++;

176 * 
	gšode_s
 = 
¡rchr
(
dev_s
, ' ');

177 *
	gšode_s
 = '\0';

178 
	gšode_s
++;

180 * 
	gpch
 = 
¡¹ok
(
šode_s
, " \n\r");

181 
	gšode_s
 = 
pch
;

182 * 
	g·th_s
 = 
NULL
;

183 ià(
	gpch
 !ğ
NULL
) {

184 
pch
 = 
¡¹ok
(
NULL
, " \n\r");

185 ià(
	gpch
) {

186 
	g·th_s
 = 
pch
;

190 * 
	gpDummy
;

191 
Add»ss
 
	g¡¬t
 = 
¡¹Şl
(
¡¬t_addr_s
, &
pDummy
, 16);

194 ià(
	gmem_m­s_
.
fšd
(
¡¬t
è=ğ
mem_m­s_
.
’d
()) {

195 
MemM­pšg
& 
m­pšg
 = 
mem_m­s_
[
¡¬t
];

196 
	gm­pšg
.
	g¡¬t
 = 
¡¬t
;

197 
	gm­pšg
.
	g’d
 = 
¡¹Ş
(
’d_addr_s
, &
pDummy
, 16);

198 
	gm­pšg
.
	goff£t
 = 
¡¹Ş
(
off£t_s
, &
pDummy
, 16);

199 
	gm­pšg
.
	gdev
 = 
dev_s
;

200 
	gm­pšg
.
	gšode
 = 
¡¹Ş
(
šode_s
, &
pDummy
, 16);

201 ià(
	g·th_s
è
	gm­pšg
.
	g·th
 = 
·th_s
;

202 
	g³rms
 = 0;

203 
	gcouÁ
 = 0;

204 ià(
	g³rms_s
[0] == 'r') {

205 
³rms
 |ğ
PROT_READ
;

206 ++
	gcouÁ
;

208 ià(
	g³rms_s
[1] == 'w') {

209 
³rms
 |ğ
PROT_WRITE
;

210 ++
	gcouÁ
;

212 ià(
	g³rms_s
[2] == 'x') {

213 
³rms
 |ğ
PROT_EXEC
;

214 ++
	gcouÁ
;

216 ià(
	gcouÁ
 =ğ3è
³rms
 = 
PROT_NONE
;

217 
	gm­pšg
.
	g³rms
 = 
³rms
;

220 
fşo£
(
å
);

224 
	gSpAddrS·û
::
dump_mem_m­s
() {

225 #iâdeà
SP_RELEASE


226 
¥_debug
("MMAPS - %lu memÜy m­pšgs", 
mem_m­s_
.
size
());

228 
	gMemM­pšgs
::
™”©Ü
 
mi
 = 
mem_m­s_
.
begš
(); 
	gmi
 !ğmem_m­s_.
’d
(); mi++) {

229 #iâdeà
SP_RELEASE


230 
	gMemM­pšg
& 
	gm­pšg
 = 
mi
->
£cÚd
;

231 
¥_debug
("MMAP - Range[%lx ~ %lx], Offset %lx, Perm %x, Dev %s, Inode %lu, Path %s",

232 
m­pšg
.
¡¬t
, m­pšg.
’d
, m­pšg.
off£t
, m­pšg.
³rms
,

233 
m­pšg
.
dev
.
c_¡r
(), m­pšg.
šode
, m­pšg.
·th
.c_str());

238 
	gSpAddrS·û
::
lßdLib¿ry
(
ph
::
P©chObjeù
* 
obj
) {

239 
lßdObjeù
(
obj
);

240 
´e_®loc_Ã¬
(
¡©ic_ÿ¡
<
SpObjeù
*>(
obj
));

247 
	gSpAddrS·û
::
´e_®loc_Ã¬
(
¥
::
SpObjeù
* 
obj
) {

250 
	gbuf_size_
 = 1024;

251 
	gmax_buf_num_
 = 10;

252 
size_t
 
	gmax_size
 = 
max_buf_num_
 * 
buf_size_
;

254 
Add»ss
 
	gps
 = 
g‘·gesize
();

255 
Add»ss
 
	gr_Ã¬
 = ((
obj
->
lßd_addr
(è+ 
ps
 -1) & ~(ps - 1));

256 
Add»ss
 
	gr_size
 = ((
max_size
 + 
ps
 -1) & ~(ps - 1));

257 
Add»ss
 
	gbuf
 = 
r_Ã¬
;

259 
upd©e_mem_m­s
();

260 
dump_mem_m­s
();

261 
¥_´št
("codeBa£: %lx,„_Ã¬: %lx,„_size: %lu", 
obj
->
codeBa£
(), 
r_Ã¬
, 
r_size
);

263 * 
	gm
 = 
NULL
;

264 
	gfd
 = -1;

265 !
	gm
 || ()m == -1) {

266 
buf
 -ğ
r_size
;

268 
	gm
 = 
mm­
((*)
buf
,

269 
r_size
,

270 
PROT_WRITE
 | 
PROT_READ
,

271 
MAP_PRIVATE
 | 
MAP_FIXED
 | 
MAP_ANONYMOUS
,

272 
fd
,

276 ià(!
	gm
) {

280 
¥_´št
("g‘ buf: %lx", (
Dynš¡
::
Add»ss
)
m
);

286 
	gSpAddrS·û
::
g‘_Ã¬
(
ph
::
Pošt
* 
±
) {

287  
NULL
;

	@SpAgent.C

1 
	~"SpAg’t.h
"

2 
	~"SpUts.h
"

3 
	~"SpCÚ‹xt.h
"

5 
usšg
 
	g¥
::
SpAg’t
;

6 
usšg
 
	g¥
::
SpP¬£r
;

7 
usšg
 
	g¥
::
SpCÚ‹xt
;

9 
usšg
 
	gph
::
P©chMgr
;

10 
usšg
 
	gph
::
AddrS·û
;

11 
usšg
 
	gph
::
P©chObjeù
;

13 
usšg
 
	g³
::
CodeObjeù
;

16 
	gSpAg’t
::
±r


17 
SpAg’t
::
	$ü—‹
() {

20 ià(
	`g‘’v
("SP_COREDUMP")) {

21 
¾im™
 
cÜe_lim™
;

22 
cÜe_lim™
.
¾im_cur
 = 
RLIM_INFINITY
;

23 
cÜe_lim™
.
¾im_max
 = 
RLIM_INFINITY
;

24 ià(
	`£Œlim™
(
RLIMIT_CORE
, &
cÜe_lim™
) < 0) {

25 
	`¥_³¼Ü
("ERROR: failedo setup core dump‡bility\n");

28  
	`±r
(
Ãw
 
	`SpAg’t
());

29 
	}
}

31 
	gSpAg’t
::
	$SpAg’t
() {

32 
š™_ev’t_
 = 
SpEv’t
::
	`±r
();

33 
fši_ev’t_
 = 
SpEv’t
::
	`±r
();

34 
·r£r_
 = 
SpP¬£r
::
	`±r
();

36 
·r£_Úly_
 = 
çl£
;

37 
dœeùÿÎ_Úly_
 = 
çl£
;

38 
®low_c_
 = 
çl£
;

39 
	}
}

41 
	gSpAg’t
::~
	$SpAg’t
() {

44 
	}
}

48 
SpAg’t
::
£t_·r£r
(
SpP¬£r
::
±r
 
·r£r
) {

49 
·r£r_
 = 
·r£r
;

53 
	gSpAg’t
::
£t_š™_ev’t
(
SpEv’t
::
±r
 
e
) {

54 
š™_ev’t_
 = 
e
;

58 
	gSpAg’t
::
£t_fši_ev’t
(
SpEv’t
::
±r
 
e
) {

59 
š™_ev’t_
 = 
e
;

63 
	gSpAg’t
::
	$£t_š™_befÜe
(
¡ršg
 
p
) {

64 
š™_befÜe_
 = 
p
;

65 
	}
}

68 
	gSpAg’t
::
	$£t_š™_aá”
(
¡ršg
 
p
) {

69 
š™_aá”_
 = 
p
;

70 
	}
}

73 
	gSpAg’t
::
£t_š™_´İ–Ër
(
SpPrİ–Ër
::
±r
 
p
) {

74 
š™_´İ–Ër_
 = 
p
;

78 
	gSpAg’t
::
	$£t_·r£_Úly
(
boŞ
 
b
) {

79 
·r£_Úly_
 = 
b
;

80 
	}
}

83 
	gSpAg’t
::
	$£t_dœeùÿÎ_Úly
(
boŞ
 
b
) {

84 
dœeùÿÎ_Úly_
 = 
b
;

85 
	}
}

88 
	gSpAg’t
::
	$£t_c
(
boŞ
 
b
) {

89 
®low_c_
 = 
b
;

90 
	}
}

94 
	gSpAg’t
::
	$go
() {

96 #iâdeà
SP_RELEASE


97 
	`¥_debug
("=========ğS¹ S–f-´İ–Ëd in¡rum’tiÚ @ Proûs %d ==========", 
	`g‘pid
());

101 
SŒšgS‘
 
Ëg®_exes
;

102 
Ëg®_exes
.
	`š£¹
("lsof");

103 
Ëg®_exes
.
	`š£¹
("bash");

104 
Ëg®_exes
.
	`š£¹
("Injector");

105 
Ëg®_exes
.
	`š£¹
("sh");

106 
Ëg®_exes
.
	`š£¹
("ssh");

107 
Ëg®_exes
.
	`š£¹
("xauth");

108 
Ëg®_exes
.
	`š£¹
("scp");

109 
Ëg®_exes
.
	`š£¹
("cp");

110 
Ëg®_exes
.
	`š£¹
("netstat");

112 ià(
¥
::
	`is_Ëg®_exe
(
Ëg®_exes
)) {

113 
	`¥_debug
("ILLEGAL EXE -‡void instrumenting");

118 ià(!
š™_ev’t_
) {

119 #iâdeà
SP_RELEASE


120 
	`¥_debug
("INIT EVENT - Use defaultƒvent");

122 
š™_ev’t_
 = 
SyncEv’t
::
	`ü—‹
();

124 ià(!
fši_ev’t_
) {

125 #iâdeà
SP_RELEASE


126 
	`¥_debug
("FINI EVENT - Use defaultƒvent");

128 
fši_ev’t_
 = 
SpEv’t
::
	`ü—‹
();

130 ià(
š™_befÜe_
.
	`size
() == 0) {

131 #iâdeà
SP_RELEASE


132 
	`¥_debug
("BEFORE_PAYLOAD - Use default…ayload before calls");

134 
š™_befÜe_
 = "default_before";

136 ià(
š™_aá”_
.
	`size
() == 0) {

137 #iâdeà
SP_RELEASE


138 
	`¥_debug
("AFTER_PAYLOAD - No…ayload‡fter calls");

140 
š™_aá”_
 = "";

142 ià(!
·r£r_
) {

143 #iâdeà
SP_RELEASE


144 
	`¥_debug
("PARSER - Use default…arser");

146 
·r£r_
 = 
SpP¬£r
::
	`ü—‹
();

148 ià(!
š™_´İ–Ër_
) {

149 #iâdeà
SP_RELEASE


150 
	`¥_debug
("PROPELLER - Use default…ropeller");

153 
š™_´İ–Ër_
 = 
SpPrİ–Ër
::
	`ü—‹
();

155 #iâdeà
SP_RELEASE


156 ià(
dœeùÿÎ_Úly_
) {

157 
	`¥_debug
("DIRECT CALL ONLY - only instrument direct calls, ignoring indirect calls");

159 
	`¥_debug
("DIRECT/INDIRECT CALL - instrument both direct‡nd indirect calls");

161 ià(
®low_c_
) {

162 
	`¥_debug
("MULTI PROCESS - support multiprocess instrumentation");

164 
	`¥_debug
("SINGLE PROCESS - only support single-process instrumentation");

169 
cÚ‹xt_
 = 
SpCÚ‹xt
::
	`ü—‹
(
š™_´İ–Ër_
,

170 
š™_befÜe_
,

171 
š™_aá”_
,

172 
·r£r_
);

173 
cÚ‹xt_
->
	`£t_dœeùÿÎ_Úly
(
dœeùÿÎ_Úly_
);

174 
cÚ‹xt_
->
	`£t_®low_c
(
®low_c_
);

176 ià(
·r£_Úly_
) {

177 #iâdeà
SP_RELEASE


178 
	`¥_debug
("PARSE ONLY -ƒxit‡fter…arsing, without instrumentation");

185 
š™_ev’t_
->
	`»gi¡”_ev’t
(
cÚ‹xt_
);

186 
fši_ev’t_
->
	`»gi¡”_ev’t
(
cÚ‹xt_
);

187 
	}
}

	@SpArch-i386.C

1 
	~"SpEv’t.h
"

2 
	~"SpP¬£r.h
"

3 
	~"SpCÚ‹xt.h
"

4 
	~"SpSn³t.h
"

5 
	~"SpUts.h
"

6 
	~"SpPošt.h
"

8 
usšg
 
	gdt
::
Add»ss
;

10 
usšg
 
	gš
::
ResuÉ
;

11 
usšg
 
	gš
::
Vis™Ü
;

12 
usšg
 
	gš
::
ImmedŸ‹
;

13 
usšg
 
	gš
::
c_C®lIn¢
;

14 
usšg
 
	gš
::
Ex´essiÚ
;

15 
usšg
 
	gš
::
In¡ruùiÚ
;

16 
usšg
 
	gš
::
D”eã»nû
;

17 
usšg
 
	gš
::
Regi¡”AST
;

18 
usšg
 
	gš
::
Bš¬yFunùiÚ
;

20 
Çme¥aû
 
	g¥
 {

27 
size_t


28 
	gSpSn³t
::
em™_§ve
(* 
buf
, 
size_t
 
off£t
, 
boŞ
) {

29 * 
	gp
 = 
buf
 + 
off£t
;

32 *
	gp
++ = 0x60;

34 
size_t
 
	gš¢size
 = 
em™_§ve_¥
(
p
, 0);

35 
	gp
 +ğ
š¢size
;

37  (
	gp
 - (
	gbuf
 + 
	goff£t
));

41 
size_t


42 
	gSpSn³t
::
em™_»¡Üe
Ğ* 
buf
, 
size_t
 
off£t
, 
boŞ
) {

43 * 
	gp
 = 
buf
 + 
off£t
;

45 *
	gp
++ = 0x61;

46  (
	gp
 - (
	gbuf
 + 
	goff£t
));

50 
size_t


51 
	gSpSn³t
::
em™_çuÉ
(* 
buf
, 
size_t
 
off£t
) {

52 * 
	gp
 = 
buf
 + 
off£t
;

55 *
	gp
++ = ()0xc7;

56 *
	gp
++ = ()0x05;

58 *
	gp
++ = ()0x00;

59 *
	gp
++ = ()0x00;

60 *
	gp
++ = ()0x00;

61 *
	gp
++ = ()0x00;

63 *
	gp
++ = ()0x00;

64 *
	gp
++ = ()0x00;

65 *
	gp
++ = ()0x00;

66 *
	gp
++ = ()0x00;

68  (
	gp
 - (
	gbuf
 + 
	goff£t
));

75 
size_t


76 
	gSpSn³t
::
em™_§ve_¥
(* 
buf
, 
size_t
 
off£t
) {

77 * 
	gp
 = 
buf
 + 
off£t
;

79 *
	gp
++ = 0x89;

80 *
	gp
++ = 0x25;

82 * 
	gl
 = (*)
p
;

83 *
	gl
 = ()&
§ved_cÚ‹xt_loc_
;

84 
	gp
 += ();

86  (
	gp
 - (
	gbuf
 + 
	goff£t
));

90 
size_t


91 
em™_push_imm32
(
imm
, * 
buf
, 
size_t
 
off£t
) {

92 * 
	gp
 = 
buf
 + 
off£t
;

95 *
	gp
++ = 0x68;

96 * 
	gi
 = (*)
p
;

97 *
	gi
 = 
imm
;

98 
	gp
 += ();

100  (
	gp
 - (
	gbuf
 + 
	goff£t
));

104 
size_t


105 
em™_pİ_imm32
(* 
buf
, 
size_t
 
off£t
) {

106 * 
	gp
 = 
buf
 + 
off£t
;

108 *
	gp
++ = 0x58;

109  (
	gp
 - (
	gbuf
 + 
	goff£t
));

116 
size_t


117 
	gSpSn³t
::
em™_·ss_·¿m
(
pošt
, 
·ylßd
, * 
buf
, 
size_t
 
off£t
) {

118 * 
	gp
 = 
buf
 + 
off£t
;

119 
size_t
 
	gš¢size
 = 0;

121 ià(
	g·ylßd
) {

123 
	gš¢size
 = 
em™_push_imm32
(()
·ylßd
, 
p
, 0);

124 
	gp
 +ğ
š¢size
;

128 
	gš¢size
 = 
em™_push_imm32
(()
pošt
, 
p
, 0);

129 
	gp
 +ğ
š¢size
;

131  (
	gp
 - (
	gbuf
 + 
	goff£t
));

138 
size_t


139 
	gSpSn³t
::
em™_ÿÎ_abs
(
ÿÎ“
, * 
buf
, 
size_t
 
off£t
, 
boŞ
 
»¡Üe
) {

140 * 
	gp
 = 
buf
 + 
off£t
;

141 
Add»ss
 
	g»ddr
 = (Add»ss)
p
+5;

142 
size_t
 
	gš¢size
 = 0;

143 
Add»ss
 
	g»l_addr
 = (
ÿÎ“
 - 
»ddr
);

145 ià(
	g¥
::
is_di¥32
(
»l_addr
)) {

147 *
p
++ = 0xe8;

148 * 
	g»l_p
 = (*)
p
;

149 *
	g»l_p
 = 
»l_addr
;

150 
	gp
 += ();

152 
¥_³¼Ü
("largerhan 4 bytes for call‡ddress");

155 ià(
	g»¡Üe
) {

157 
	gš¢size
 = 
em™_pİ_imm32
(
p
, 0);

158 
	gp
 +ğ
š¢size
;

160 ià(
	gcÚ‹xt_
->
®low_c
()) {

162 
	gš¢size
 = 
em™_pİ_imm32
(
p
, 0);

163 
	gp
 +ğ
š¢size
;

167  (
	gp
 - (
	gbuf
 + 
	goff£t
));

175 
size_t


176 
	gSpSn³t
::
em™_jump_abs
(
Œg
, * 
buf
, 
size_t
 
off£t
, 
boŞ
 
abs
) {

177 * 
	gp
 = 
buf
 + 
off£t
;

178 
size_t
 
	gš¢size
 = 0;

180 
Add»ss
 
	g»ddr
 = (Add»ss)
p
+5;

181 
Add»ss
 
	g»l_addr
 = (
Œg
 - 
»ddr
);

183 ià(
	g¥
::
is_di¥32
(
»l_addr
è&& !
abs
) {

185 *
p
++ = 0xe9;

186 * 
	g»l_p
 = (*)
p
;

187 *
	g»l_p
 = 
»l_addr
;

188 
	gp
 += 4;

191 
	gš¢size
 = 
em™_push_imm32
(
Œg
, 
p
, 0);

192 
	gp
 +ğ
š¢size
;

194 *
	gp
++ = 0xc3;

197  (
	gp
 - (
	gbuf
 + 
	goff£t
));

203 
size_t


204 
	gSpSn³t
::
em™_ÿÎ_Üig
(
¤c
, 
size_t
 
size
, * 
buf
, size_ˆ
off£t
) {

205 * 
	gp
 = 
buf
 + 
off£t
;

206 * 
	gp¤c
 = (*)
¤c
;

207 
memıy
(
p
, 
p¤c
, 
size
);

208  
	gsize
;

212 
size_t


213 
	gSpSn³t
::
»loc_š¢
(
Add»ss
 
¤c_š¢
, 
In¡ruùiÚ
::
PŒ
 
š¢
,

214 
Add»ss
 
Ï¡
, * 
buf
) {

218 
Add»ss
 
	ga
 = 
¤c_š¢
;

219 ià(
	ga
 =ğ
Ï¡
)  0;

222 * 
	gp
 = 
buf
;

223 ià(
	gš¢
->
g‘C©egÜy
(è=ğ
c_C®lIn¢
 &&

224 
a
 !ğ
Ï¡
) {

229 *
p
++ = 0xbb;

230 * 
	gÃw_ebx
 = (*)
p
;

231 *
	gÃw_ebx
 = ()(
a
+5);

235 
memıy
(
p
, 
š¢
->
±r
(), in¢->
size
());

236  
	gš¢
->
size
();

245 
Add»ss


246 
	gSpSn³t
::
g‘_´e_sigÇl_pc
(* 
cÚ‹xt
) {

247 
ucÚ‹xt_t
* 
ùx
 = (ucÚ‹xt_t*)
cÚ‹xt
;

248  
	gùx
->
	guc_mcÚ‹xt
.
	gg»gs
[
REG_EIP
];

252 
Add»ss


253 
	gSpSn³t
::
£t_pc
(
Add»ss
 
pc
, * 
cÚ‹xt
) {

254 
ucÚ‹xt_t
* 
	gùx
 = (ucÚ‹xt_t*)
cÚ‹xt
;

255 
	gùx
->
	guc_mcÚ‹xt
.
	gg»gs
[
REG_EIP
] = 
pc
;

259 
Add»ss


260 
	gSpSn³t
::
g‘_§ved_»g
(
Dynš¡
::
MachRegi¡”
 
»g
) {

264 
	#EDI
 0

	)

265 
	#ESI
 4

	)

266 
	#EBP
 8

	)

267 
	#ESP
 12

	)

268 
	#EBX
 16

	)

269 
	#EDX
 20

	)

270 
	#ECX
 24

	)

271 
	#EAX
 28

	)

273 
	#»g_v®
(
i
è(*(*)(
§ved_cÚ‹xt_loc_
+(i)))

	)

279 
usšg
 
Çme¥aû
 
Dynš¡
::
x86
;

280 ià(
	g»g
 =ğ
edi
è 
»g_v®
(
EDI
);

281 ià(
	g»g
 =ğ
esi
è 
»g_v®
(
ESI
);

282 ià(
	g»g
 =ğ
ebp
è 
»g_v®
(
EBP
);

283 ià(
	g»g
 =ğ
e¥
è 
»g_v®
(
ESP
);

284 ià(
	g»g
 =ğ
ebx
è 
»g_v®
(
EBX
);

285 ià(
	g»g
 =ğ
edx
è 
»g_v®
(
EDX
);

286 ià(
	g»g
 =ğ
ecx
è 
»g_v®
(
ECX
);

287 ià(
	g»g
 =ğ
—x
è 
»g_v®
(
EAX
);

293 
boŞ


294 
	gSpP¬£r
::
is_pc
(
Dynš¡
::
MachRegi¡”
 
r
) {

295 ià(
r
 =ğ
Dynš¡
::
x86
::
e
è 
Œue
;

296  
	gçl£
;

301 
size_t


302 
	gSpSn³t
::
jump_abs_size
() {

311 
	gSpSn³t
::
pİ_¬gum’t
(
Argum’tHªdË
* 
h
, 
size_t
 
size
) {

312 * 
	ga
 = (*)(
§ved_cÚ‹xt_loc_
 + 32 + 
h
->
off£t
);

313 
	gh
->
	goff£t
 +ğ
size
;

314  
	ga
;

319 
	gSpSn³t
::
g‘_»t_v®
() {

320  
g‘_§ved_»g
(
Dynš¡
::
x86
::
—x
);

	@SpArch-x86_64.C

1 
	~"SpEv’t.h
"

2 
	~"SpP¬£r.h
"

3 
	~"SpCÚ‹xt.h
"

4 
	~"SpSn³t.h
"

5 
	~"SpPošt.h
"

6 
	~"SpUts.h
"

8 
usšg
 
	gdt
::
Add»ss
;

10 
usšg
 
	gph
::
P©chFunùiÚ
;

12 
usšg
 
	gš
::
ResuÉ
;

13 
usšg
 
	gš
::
Vis™Ü
;

14 
usšg
 
	gš
::
ImmedŸ‹
;

15 
usšg
 
	gš
::
Ex´essiÚ
;

16 
usšg
 
	gš
::
In¡ruùiÚ
;

17 
usšg
 
	gš
::
D”eã»nû
;

18 
usšg
 
	gš
::
Regi¡”AST
;

19 
usšg
 
	gš
::
Bš¬yFunùiÚ
;

22 
Çme¥aû
 
	g¥
 {

24 
SpCÚ‹xt
* 
g_cÚ‹xt
;

31 
size_t


32 
	gSpSn³t
::
em™_§ve
(* 
buf
, 
size_t
 
off£t
, 
boŞ
 
šdœeù
) {

33 * 
	gp
 = 
buf
 + 
off£t
;

36 *
	gp
++ = 0x57;

37 *
	gp
++ = 0x56;

38 *
	gp
++ = 0x52;

39 *
	gp
++ = 0x51;

40 *
	gp
++ = 0x41;

41 *
	gp
++ = 0x50;

42 *
	gp
++ = 0x41;

43 *
	gp
++ = 0x51;

44 *
	gp
++ = 0x50;

48 
	gp
 +ğ
em™_§ve_¥
(
p
, 0);

51 ià(
	gšdœeù
) {

52 *
	gp
++ = 0x41;

53 *
	gp
++ = 0x52;

54 *
	gp
++ = 0x41;

55 *
	gp
++ = 0x53;

56 *
	gp
++ = 0x53;

57 *
	gp
++ = 0x41;

58 *
	gp
++ = 0x54;

59 *
	gp
++ = 0x41;

60 *
	gp
++ = 0x55;

61 *
	gp
++ = 0x41;

62 *
	gp
++ = 0x56;

63 *
	gp
++ = 0x41;

64 *
	gp
++ = 0x57;

65 *
	gp
++ = 0x55;

68  (
	gp
 - (
	gbuf
 + 
	goff£t
));

72 
size_t


73 
	gSpSn³t
::
em™_»¡Üe
(* 
buf
, 
size_t
 
off£t
, 
boŞ
 
šdœeù
) {

74 * 
	gp
 = 
buf
 + 
off£t
;

77 ià(
	gšdœeù
) {

78 *
	gp
++ = 0x5d;

79 *
	gp
++ = 0x41;

80 *
	gp
++ = 0x5f;

81 *
	gp
++ = 0x41;

82 *
	gp
++ = 0x5e;

83 *
	gp
++ = 0x41;

84 *
	gp
++ = 0x5d;

85 *
	gp
++ = 0x41;

86 *
	gp
++ = 0x5c;

87 *
	gp
++ = 0x5b;

88 *
	gp
++ = 0x41;

89 *
	gp
++ = 0x5b;

90 *
	gp
++ = 0x41;

91 *
	gp
++ = 0x5a;

95 *
	gp
++ = 0x58;

96 *
	gp
++ = 0x41;

97 *
	gp
++ = 0x59;

98 *
	gp
++ = 0x41;

99 *
	gp
++ = 0x58;

100 *
	gp
++ = 0x59;

101 *
	gp
++ = 0x5a;

102 *
	gp
++ = 0x5e;

103 *
	gp
++ = 0x5f;

105  (
	gp
 - (
	gbuf
 + 
	goff£t
));

111 
size_t


112 
	gSpSn³t
::
em™_§ve_¥
(* 
buf
, 
size_t
 
off£t
) {

113 * 
	gp
 = 
buf
 + 
off£t
;

116 *
	gp
++ = 0x48;

117 *
	gp
++ = 0xb8;

118 * 
	gl
 = (*)
p
;

119 *
	gl
 = ()&
§ved_cÚ‹xt_loc_
;

120 
	gp
 += ();

123 *
	gp
++ = 0x48;

124 *
	gp
++ = 0x89;

125 *
	gp
++ = 0x20;

127  (
	gp
 - (
	gbuf
 + 
	goff£t
));

131 
size_t


132 
	gSpSn³t
::
em™_çuÉ
(* 
buf
, 
size_t
 
off£t
) {

133 * 
	gp
 = 
buf
 + 
off£t
;

136 *
	gp
++ = ()0x48;

137 *
	gp
++ = ()0xc7;

138 *
	gp
++ = ()0x04;

139 *
	gp
++ = ()0x25;

140 *
	gp
++ = ()0x00;

141 *
	gp
++ = ()0x00;

142 *
	gp
++ = ()0x00;

143 *
	gp
++ = ()0x00;

144 *
	gp
++ = ()0x00;

145 *
	gp
++ = ()0x00;

146 *
	gp
++ = ()0x00;

147 *
	gp
++ = ()0x00;

148  (
	gp
 - (
	gbuf
 + 
	goff£t
));

152 
size_t


153 
em™_mov_imm64_rdi
(
imm
, * 
buf
, 
size_t
 
off£t
) {

154 * 
	gp
 = 
buf
 + 
off£t
;

156 *
	gp
 = ()0x48;…++;

157 *
	gp
 = ()0xbf;…++;

158 *((*)
	gp
èğ()
imm
;

163 
size_t


164 
em™_mov_imm64_rsi
(
imm
, * 
buf
, 
size_t
 
off£t
) {

165 * 
	gp
 = 
buf
 + 
off£t
;

167 *
	gp
 = ()0x48;…++;

168 *
	gp
 = ()0xbe;…++;

169 *((*)
	gp
èğ()
imm
;

176 
size_t


177 
	gSpSn³t
::
em™_·ss_·¿m
(
pošt
, 
·ylßd
, * 
buf
, 
size_t
 
off£t
) {

178 * 
	gp
 = 
buf
 + 
off£t
;

179 
size_t
 
	gš¢size
 = 0;

182 
	gš¢size
 = 
em™_mov_imm64_rdi
(()
pošt
, 
p
, 0);

183 
	gp
 +ğ
š¢size
;

185 ià(
	g·ylßd
) {

187 
	gš¢size
 = 
em™_mov_imm64_rsi
(()
·ylßd
, 
p
, 0);

188 
	gp
 +ğ
š¢size
;

191  (
	gp
 - (
	gbuf
 + 
	goff£t
));

195 
size_t


196 
em™_push_imm64
(
imm
, * 
buf
, 
size_t
 
off£t
) {

197 * 
	gp
 = 
buf
 + 
off£t
;

204 
	gi
 = 3; i >= 0; i--) {

205 
	gwÜd
 = 
¡©ic_ÿ¡
<>((
imm
 >> (16 * 
i
)) & 0xffff);

206 *
	gp
++ = 0x66;

207 *
	gp
++ = 0x68;

208 *(*)
	gp
 = 
wÜd
;

209 
	gp
 += 2;

211  (
	gp
 - (
	gbuf
 + 
	goff£t
));

215 
size_t


216 
	gSpSn³t
::
em™_ÿÎ_abs
(
ÿÎ“
, * 
buf
, 
size_t
 
off£t
, 
boŞ
) {

217 * 
	gp
 = 
buf
 + 
off£t
;

218 
Add»ss
 
	g»ddr
 = (Add»ss)
p
+5;

219 
Add»ss
 
	g»l_addr
 = (
ÿÎ“
 - 
»ddr
);

221 ià(
	g¥
::
is_di¥32
(
»l_addr
)) {

225 *
p
++ = 0xe8;

226 * 
	g»l_p
 = (*)
p
;

227 *
	g»l_p
 = 
»l_addr
;

228 
	gp
 += 4;

233 *
	gp
++ = 0x48;

234 *
	gp
++ = 0xb8;

235 * 
	gÿÎ_addr
 = (*)
p
;

236 *
	gÿÎ_addr
 = 
ÿÎ“
;

237 
	gp
 += ();

240 *
	gp
++ = 0xff;

241 *
	gp
++ = 0xd0;

244  (
	gp
 - (
	gbuf
 + 
	goff£t
));

248 
size_t


249 
	gSpSn³t
::
em™_jump_abs
(
Œg
, * 
buf
, 
size_t
 
off£t
, 
boŞ
 
abs
) {

250 * 
	gp
 = 
buf
 + 
off£t
;

251 
size_t
 
	gš¢size
 = 0;

253 
Add»ss
 
	g»ddr
 = (Add»ss)
p
+5;

254 
Add»ss
 
	g»l_addr
 = (
Œg
 - 
»ddr
);

256 ià(
	g¥
::
is_di¥32
(
»l_addr
è&& !
abs
) {

260 *
p
++ = 0xe9;

261 * 
	g»l_p
 = (*)
p
;

262 *
	g»l_p
 = 
»l_addr
;

263 
	gp
 += 4;

268 
	gš¢size
 = 
em™_push_imm64
(
Œg
, 
p
, 0);

269 
	gp
 +ğ
š¢size
;

272 *
	gp
++ = 0xc3;

274  (
	gp
 - (
	gbuf
 + 
	goff£t
));

282 
Add»ss


283 
	gSpSn³t
::
g‘_´e_sigÇl_pc
(* 
cÚ‹xt
) {

284 
ucÚ‹xt_t
* 
ùx
 = (ucÚ‹xt_t*)
cÚ‹xt
;

285  
	gùx
->
	guc_mcÚ‹xt
.
	gg»gs
[
REG_RIP
];

289 
Add»ss


290 
	gSpSn³t
::
£t_pc
(
Add»ss
 
pc
, * 
cÚ‹xt
) {

291 
ucÚ‹xt_t
* 
	gùx
 = (ucÚ‹xt_t*)
cÚ‹xt
;

292 
	gùx
->
	guc_mcÚ‹xt
.
	gg»gs
[
REG_RIP
] = 
pc
;

293  
	gpc
;

297 
Add»ss


298 
	gSpSn³t
::
g‘_§ved_»g
(
Dynš¡
::
MachRegi¡”
 
»g
) {

300 
	#RAX
 (0)

	)

301 
	#R9
 (8)

	)

302 
	#R8
 (16)

	)

303 
	#RCX
 (24)

	)

304 
	#RDX
 (32)

	)

305 
	#RSI
 (40)

	)

306 
	#RDI
 (48)

	)

307 
	#RSP
 (56)

	)

309 
	#R10
 (-8)

	)

310 
	#R11
 (-16)

	)

311 
	#RBX
 (-24)

	)

312 
	#R12
 (-32)

	)

313 
	#R13
 (-40)

	)

314 
	#R14
 (-48)

	)

315 
	#R15
 (-56)

	)

316 
	#RBP
 (-64)

	)

318 
	#»g_v®
(
i
è(*(*)(
§ved_cÚ‹xt_loc_
+()(i)))

	)

325 
usšg
 
Çme¥aû
 
Dynš¡
::
x86_64
;

327 ià(
	g»g
 =ğ
¿x
è 
»g_v®
(
RAX
);

328 ià(
	g»g
 =ğ
rbx
è 
»g_v®
(
RBX
);

329 ià(
	g»g
 =ğ
rcx
è 
»g_v®
(
RCX
);

330 ià(
	g»g
 =ğ
rdx
è 
»g_v®
(
RDX
);

331 ià(
	g»g
 =ğ
rsi
è 
»g_v®
(
RSI
);

332 ià(
	g»g
 =ğ
rdi
è 
»g_v®
(
RDI
);

333 ià(
	g»g
 =ğ
r8
è 
»g_v®
(
R8
);

334 ià(
	g»g
 =ğ
r9
è 
»g_v®
(
R9
);

335 ià(
	g»g
 =ğ
r10
è 
»g_v®
(
R10
);

336 ià(
	g»g
 =ğ
r11
è 
»g_v®
(
R11
);

337 ià(
	g»g
 =ğ
r12
è 
»g_v®
(
R12
);

338 ià(
	g»g
 =ğ
r13
è 
»g_v®
(
R13
);

339 ià(
	g»g
 =ğ
r14
è 
»g_v®
(
R14
);

340 ià(
	g»g
 =ğ
r15
è 
»g_v®
(
R15
);

341 ià(
	g»g
 =ğ
r¥
è (
§ved_cÚ‹xt_loc_
+
RSP
);

343 ià(
	g»g
 =ğ
rbp
è 
»g_v®
(
RBP
);

345 ià(
	g»g
 =ğ
—x
è 
»g_v®
(
RAX
);

346 ià(
	g»g
 =ğ
ebx
è 
»g_v®
(
RBX
);

347 ià(
	g»g
 =ğ
ecx
è 
»g_v®
(
RCX
);

348 ià(
	g»g
 =ğ
edx
è 
»g_v®
(
RDX
);

349 ià(
	g»g
 =ğ
esi
è 
»g_v®
(
RSI
);

350 ià(
	g»g
 =ğ
edi
è 
»g_v®
(
RDI
);

351 ià(
	g»g
 =ğ
e¥
è (
§ved_cÚ‹xt_loc_
+
RSP
);

353 ià(
	g»g
 =ğ
ebp
è 
»g_v®
(
RBP
);

359 
boŞ


360 
	gSpP¬£r
::
is_pc
(
Dynš¡
::
MachRegi¡”
 
r
) {

361 ià(
r
 =ğ
Dynš¡
::
x86_64
::
r
è 
Œue
;

362  
	gçl£
;

365 şas 
	cR–ocVis™Ü
 : 
public
 
Vis™Ü
 {

366 
public
:

367 
R–ocVis™Ü
(
SpP¬£r
::
±r
 
p
è: 
Vis™Ü
(), 
p_
Õ), 
u£_pc_
(
çl£
) {}

368 
vœtu®
 
vis™
(
Regi¡”AST
* 
r
) {

369 ià(
	gp_
->
is_pc
(
r
->
g‘ID
())) {

370 
	gu£_pc_
 = 
Œue
;

373 
vœtu®
 
vis™
(
Bš¬yFunùiÚ
* 
b
) {

375 
vœtu®
 
vis™
(
ImmedŸ‹
* 
i
) {

377 
vœtu®
 
vis™
(
D”eã»nû
* 
d
) {

379 
boŞ
 
u£_pc
(ècÚ¡ {  
	gu£_pc_
; }

380 
	g´iv©e
:

381 
SpP¬£r
::
±r
 
p_
;

382 
boŞ
 
	gu£_pc_
;

415 
g‘_di¥
(
In¡ruùiÚ
::
PŒ
 
š¢
, * 
š¢_buf
) {

416 * 
	gdi¥
 = 
NULL
;

418 
	gdi¥_off£t
 = 0;

420 ià((
	gš¢_buf
[
di¥_off£t
] & 0xf0) == 0x40) {

421 ++
di¥_off£t
;

425 ià(
	gš¢_buf
[
di¥_off£t
] == 0x0f) {

426 ++
di¥_off£t
;

430 ++
	gdi¥_off£t
;

433 ++
	gdi¥_off£t
;

435 
	gdi¥
 = (*)&
š¢_buf
[
di¥_off£t
];

436  
	gdi¥
;

440 şas 
	cEmuVis™Ü
 : 
public
 
Vis™Ü
 {

441 
public
:

442 
EmuVis™Ü
(
Add»ss
 
a
)

443 : 
Vis™Ü
(), 
imm_
(0), 
a_
(
a
) { }

444 
vœtu®
 
vis™
(
Regi¡”AST
* 
r
) {

446 
	gimm_
 = 
a_
;

447 
	g¡ack_
.
push
(
imm_
);

449 
vœtu®
 
vis™
(
Bš¬yFunùiÚ
* 
b
) {

450 
Add»ss
 
	gi1
 = 
¡ack_
.
tİ
();

451 
	g¡ack_
.
pİ
();

452 
Add»ss
 
	gi2
 = 
¡ack_
.
tİ
();

453 
	g¡ack_
.
pİ
();

455 ià(
	gb
->
isAdd
()) {

456 
	gimm_
 = 
i1
 + 
i2
;

457 } ià(
	gb
->
isMuÉly
()) {

458 
	gimm_
 = 
i1
 * 
i2
;

460 
as£¹
(0);

462 
	g¡ack_
.
push
(
imm_
);

464 
vœtu®
 
vis™
(
ImmedŸ‹
* 
i
) {

465 
ResuÉ
 
	g»s
 = 
i
->
ev®
();

466 
	g»s
.
size
()) {

468 
imm_
 =
»s
.
v®
.
u8v®
;

472 
imm_
 =
»s
.
v®
.
u16v®
;

476 
imm_
 =
»s
.
v®
.
u32v®
;

480 
imm_
 =
»s
.
v®
.
u64v®
;

484 
	g¡ack_
.
push
(
imm_
);

486 
vœtu®
 
vis™
(
D”eã»nû
* 
d
) {

491 
Add»ss
 
imm
() const {

492  
	gimm_
;

495 
	g´iv©e
:

496 
¡d
::
¡ack
<
Add»ss
> 
¡ack_
;

497 
Add»ss
 
	gimm_
;

498 
Add»ss
 
	ga_
;

514 
size_t


515 
emuÏ‹_pc£n
(
In¡ruùiÚ
::
PŒ
 
š¢
, 
Ex´essiÚ
::PŒ 
e
, 
Add»ss
 
a
, * 
buf
) {

516 * 
	gp
 = 
buf
;

517 * 
	gš¢_buf
 = (*)
š¢
->
±r
();

522 
	g»x
 = 0;

523 
	gmodrm_off£t
 = 1;

524 ià((
	gš¢_buf
[0] & 0xf0) == 0x40) {

525 
»x
 = 
š¢_buf
[0];

526 ++
	gmodrm_off£t
;

529 
	gesÿ³
 = 0;

530 ià(
	gš¢_buf
[
modrm_off£t
-1] == 0x0f) {

531 
esÿ³
 = 0x0f;

532 ++
	gmodrm_off£t
;

536 
	gmodrm
 = 
š¢_buf
[
modrm_off£t
];

539 
	g»g
 = 0;

540 ià(
	g»x
) {

542 ià(
	g»x
 & 0x04è
	g»g
 |= 0x08;

544 
	g»g
 |ğ((
modrm
 & 0x38) >> 3);

549 ià(
	g»g
 != 0x08) {

551 *
p
++ = 0x41;

552 *
	gp
++ = 0x50;

555 *
	gp
++ = 0x41;

556 *
	gp
++ = 0x51;

562 *
	gp
++ = 0x49;

563 ià(
	g»g
 != 0x08) {

564 *
p
++ = 0xb8;

566 *
	gp
++ = 0xb9;

568 * 
	gl
 = (*)
p
;

571 
EmuVis™Ü
 
vis™Ü
(
a
+
š¢
->
size
());

572 
	ge
->
­¶y
(&
vis™Ü
);

573 *
	gl
 = 
vis™Ü
.
imm
();

574 
	gp
 +ğ(
l
);

577 ià(
	g»x
) {

578 
	g»x
 |= 0x01;

579 *
	gp
++ = 
»x
;

581 *
	gp
++ = 0x41;

585 ià(
	gesÿ³
) {

586 *
	gp
++ = 0x0f;

590 *
	gp
++ = 
š¢_buf
[
modrm_off£t
-1];

591 
	gÃw_modrm
 = 
modrm
;

592 ià(
	g»g
 != 0x08) {

593 
Ãw_modrm
 &= 0xf8;

595 
	gÃw_modrm
 &= 0xf9;

597 *
	gp
++ = 
Ãw_modrm
;

600 
	gi
 = 
modrm_off£t
+1+4; i < 
	gš¢
->
size
(); i++) {

601 *
	gp
++ = 
š¢_buf
[
i
];

607 ià(
	g»g
 != 0x08) {

609 *
p
++ = 0x41;

610 *
	gp
++ = 0x58;

613 *
	gp
++ = 0x41;

614 *
	gp
++ = 0x59;

617  (
	gsize_t
)(
	gp
 - 
	gbuf
);

620 
size_t


621 
»loc_š¢_š‹º®
(
Add»ss
 
a
, 
In¡ruùiÚ
::
PŒ
 
š¢
,

622 
¡d
::
£t
<
Ex´essiÚ
::
PŒ
>& 
exp
, 
boŞ
 
u£_pc
, * 
p
) {

623 ià(
	gu£_pc
) {

625 
	gš¢_buf
[20];

626 
memıy
(
š¢_buf
, 
š¢
->
±r
(), in¢->
size
());

627 * 
	gdis_buf
 = 
g‘_di¥
(
š¢
, 
š¢_buf
);

628 
	gŞd_r
 = 
a
;

629 
	gÃw_r
 = ()
p
;

631 
	glÚg_Ãw_dis
 = (
Şd_r
 - 
Ãw_r
è+ *
dis_buf
;

633 ià(
	g¥
::
is_di¥32
(
lÚg_Ãw_dis
)) {

635 *
dis_buf
 = ()
lÚg_Ãw_dis
;

636 
memıy
(
p
, 
š¢_buf
, 
š¢
->
size
());

637  
	gš¢
->
size
();

640 
size_t
 
	gš¢_size
 = 
emuÏ‹_pc£n
(
š¢
, *
exp
.
begš
(), 
a
, 
p
);

641  
	gš¢_size
;

645 
memıy
(
p
, 
š¢
->
±r
(), in¢->
size
());

646  
	gš¢
->
size
();

651 
size_t


652 
	gSpSn³t
::
»loc_š¢
(
Add»ss
 
¤c_š¢
, 
In¡ruùiÚ
::
PŒ
 
š¢
,

653 
Add»ss
 
Ï¡
, * 
buf
) {

655 ià(
	g¤c_š¢
 =ğ
Ï¡
) {  0; }

658 
	g£t
<
	gEx´essiÚ
::
PŒ
> 
İS‘
;

659 ià(
	gš¢
->
»adsMemÜy
()èš¢->
g‘MemÜyR—dO³¿nds
(
İS‘
);

660 ià(
	gš¢
->
wr™esMemÜy
()èš¢->
g‘MemÜyWr™eO³¿nds
(
İS‘
);

662 
boŞ
 
	gu£_pc
 = 
çl£
;

663 
	g£t
<
	gEx´essiÚ
::
PŒ
>::
™”©Ü
 
i
 = 
İS‘
.
begš
(); 
	gi
 !ğİS‘.
’d
(); i++) {

664 
R–ocVis™Ü
 
vis™Ü
(
cÚ‹xt_
->
·r£r
());

665 (*
	gi
)->
­¶y
(&
vis™Ü
);

666 
	gu£_pc
 = 
vis™Ü
.
u£_pc
();

670  
»loc_š¢_š‹º®
(
¤c_š¢
, 
š¢
, 
İS‘
, 
u£_pc
, 
buf
);

674 
size_t


675 
	gSpSn³t
::
	$jump_abs_size
() {

679 
	}
}

683 
size_t


684 
	gSpSn³t
::
	$em™_ÿÎ_Üig
(
¤c
, 
size_t
 
size
,

685 * 
buf
, 
size_t
 
off£t
) {

686 * 
p
 = 
buf
 + 
off£t
;

687 
boŞ
 
u£_pc
 = 
çl£
;

690 
In¡ruùiÚ
::
PŒ
 
š¢
 = 
	`g‘_Üig_ÿÎ_š¢
();

691 
R–ocVis™Ü
 
	`vis™Ü
(
cÚ‹xt_
->
	`·r£r
());

692 
Ex´essiÚ
::
PŒ
 
Œg
 = 
š¢
->
	`g‘CÚŒŞFlowT¬g‘
();

693 
£t
<
Ex´essiÚ
::
PŒ
> 
İS‘
;

694 ià(
Œg
) {

695 
Œg
->
	`­¶y
(&
vis™Ü
);

696 
u£_pc
 = 
vis™Ü
.
	`u£_pc
();

697 
İS‘
.
	`š£¹
(
Œg
);

699  
	`»loc_š¢_š‹º®
(
¤c
, 
š¢
, 
İS‘
, 
u£_pc
, 
p
);

700 
	}
}

704 
	gSpSn³t
::
	$pİ_¬gum’t
(
Argum’tHªdË
* 
h
, 
size_t
 
size
) {

705 
usšg
 
Çme¥aû
 
Dynš¡
::
x86_64
;

706 ià(
h
->
num
 < 6) {

707 
Add»ss
 
a
 = 0;

708 
h
->
num
) {

710 
a
 = 
	`g‘_§ved_»g
(
rdi
);

713 
a
 = 
	`g‘_§ved_»g
(
rsi
);

716 
a
 = 
	`g‘_§ved_»g
(
rdx
);

719 
a
 = 
	`g‘_§ved_»g
(
rcx
);

722 
a
 = 
	`g‘_§ved_»g
(
r8
);

725 
a
 = 
	`g‘_§ved_»g
(
r9
);

728 
	`as£¹
(0);

730 * 
b
 = 
h
->
	`š£¹_buf
(
size
);

731 
	`memıy
(
b
, &
a
, 
size
);

732 ++
h
->
num
;

733  
b
;

736 * 
a
 = (*)(
§ved_cÚ‹xt_loc_
 + 
RSP
 + 
h
->
off£t
);

737 
h
->
off£t
 +ğ
size
;

738 ++
h
->
num
;

739  
a
;

740 
	}
}

744 
	gSpSn³t
::
	$g‘_»t_v®
() {

745  
	`g‘_§ved_»g
(
Dynš¡
::
x86_64
::
¿x
);

746 
	}
}

	@SpContext.C

1 
	~"SpCÚ‹xt.h
"

2 
	~"SpPrİ–Ër.h
"

3 
	~"SpP¬£r.h
"

4 
	~"SpUts.h
"

6 
usšg
 
	gsk
::
F¿me
;

7 
usšg
 
	gsk
::
W®k”
;

9 
usšg
 
	gsb
::
Symb
;

11 
usšg
 
	g¥
::
SpP¬£r
;

12 
usšg
 
	g¥
::
SpCÚ‹xt
;

13 
usšg
 
	g¥
::
SpPrİ–Ër
;

15 
usšg
 
	gph
::
Pošt
;

16 
usšg
 
	gph
::
P©chMgr
;

17 
usšg
 
	gph
::
AddrS·û
;

18 
usšg
 
	gph
::
P©chObjeù
;

19 
usšg
 
	gph
::
P©chMgrPŒ
;

20 
usšg
 
	gph
::
P©chFunùiÚ
;

22 
usšg
 
	g³
::
SymbCodeSourû
;

24 
	gSpCÚ‹xt
::
SpCÚ‹xt
(
SpPrİ–Ër
::
±r
 
p
,

25 
SpP¬£r
::
±r
 
·r£r
) {

26 
š™_´İ–Ër_
 = 
p
;

27 
	g·r£r_
 = 
·r£r
;

28 
	gc_mgr_
 = 
NULL
;

29 
	g®low_c_
 = 
çl£
;

32 
·r£
();

34 
š™_w–l_known_libs
();

37 
SpCÚ‹xt
*

38 
	gSpCÚ‹xt
::
ü—‹
(
SpPrİ–Ër
::
±r
 
´İ–Ër
,

39 
¡ršg
 
š™_befÜe
,

40 
¡ršg
 
š™_aá”
,

41 
SpP¬£r
::
±r
 
·r£r
) {

42 
SpCÚ‹xt
* 
»t
 = 
Ãw
 SpCÚ‹xt(
´İ–Ër
,

43 
·r£r
);

44 
as£¹
(
»t
);

45 
	g»t
->
	gš™_befÜe_
 = (*)
»t
->
·r£r
()->
g‘_func_addr
(
š™_befÜe
);

46 
	g»t
->
	gš™_aá”_
 = (*)
»t
->
·r£r
()->
g‘_func_addr
(
š™_aá”
);

47 
	g»t
->
	gš™_befÜe_Çme_
 = 
š™_befÜe
;

48 
	g»t
->
	gš™_aá”_Çme_
 = 
š™_aá”
;

49 
	g»t
->
	gw¿µ”_befÜe_
 = (*)
»t
->
·r£r
()->
g‘_func_addr
("wrapper_before");

50 
	g»t
->
	gw¿µ”_aá”_
 = (*)
»t
->
·r£r
()->
g‘_func_addr
("wrapper_after");

51  
	g»t
;

56 
	gSpCÚ‹xt
::
	$š™_w–l_known_libs
() {

57 
w–l_known_libs_
.
	`push_back
("libc-");

58 
w–l_known_libs_
.
	`push_back
("libm-");

59 
w–l_known_libs_
.
	`push_back
("ld-");

60 
w–l_known_libs_
.
	`push_back
("libdl-");

61 
w–l_known_libs_
.
	`push_back
("libstdc++");

62 
w–l_known_libs_
.
	`push_back
("libgcc");

63 
w–l_known_libs_
.
	`push_back
("libagent.so");

64 
w–l_known_libs_
.
	`push_back
("libpthread-");

66 ià(
·r£r_
->
	`šjeùed
())

67 
w–l_known_libs_
.
	`push_back
(
·r£r_
->
	`g‘_ag’t_Çme
());

68 
	}
}

75 
	gSpCÚ‹xt
::
	$g‘_ÿÎ¡ack
(
C®lSck
* 
ÿÎ_¡ack
) {

76 
pc
, 
¥
, 
bp
;

77 
·r£r_
->
	`g‘_äame
(&
pc
, &
¥
, &
bp
);

78 
	`¥_debug
("GET FRAME -…c: %lx, sp: %lx, bp: %lx", 
pc
, 
¥
, 
bp
);

79 
¡d
::
veùÜ
<
F¿me
> 
¡ackw®k
;

80 
W®k”
 *
w®k”
 = W®k”::
	`ÃwW®k”
();

81 
F¿me
* 
f
 = F¿me::
	`ÃwF¿me
(
pc
, 
¥
, 
bp
, 
w®k”
);

82 
w®k”
->
	`w®kSckFromF¿me
(
¡ackw®k
, *
f
);

83 
i
=0; i<
¡ackw®k
.
	`size
(); i++) {

84 
¡ršg
 
s
;

85 
¡ackw®k
[
i
].
	`g‘Name
(
s
);

86 
dt
::
Add»ss
 
¿
 = (dt::Add»ss)
¡ackw®k
[
i
].
	`g‘RA
();

89 
P©chFunùiÚ
* 
func
 = 
·r£r_
->
	`fšdFunùiÚ
(
¿
);

90 ià(!
func
) {

91 #iâdeà
SP_RELEASE


92 
	`¥_debug
("SKIPPED - FunùiÚ % ÿÂÙ b»sŞved", 
s
.
	`c_¡r
());

98 #iâdeà
SP_RELEASE


99 
	`¥_debug
("FOUND - FunùiÚ % i šhÿÎ sck", 
s
.
	`c_¡r
());

102 
ÿÎ_¡ack
->
	`push_back
(
func
);

104 
	}
}

107 
	gSpCÚ‹xt
::
	$·r£
() {

108 #iâdeà
SP_RELEASE


109 
	`¥_debug
("START PARSING - start…arsing binary code");

111 
mgr_
 = 
·r£r_
->
	`·r£
();

112 #iâdeà
SP_RELEASE


113 
	`¥_debug
("FINISH PARSING - finish…arsing binary code");

115 
	}
}

117 
boŞ


118 
	gSpCÚ‹xt
::
	$is_w–l_known_lib
(
¡ršg
 
lib
) {

119 
i
 = 0; i < 
w–l_known_libs_
.
	`size
(); i++) {

120 ià(
lib
.
	`fšd
(
w–l_known_libs_
[
i
]è!ğ
¡ršg
::
Åos
è 
Œue
;

122  
çl£
;

123 
	}
}

127 
	gSpCÚ‹xt
::
	$»¡Üe
() {

129 
	`sigaùiÚ
(
SIGTRAP
, &
Şd_aù_
, 
NULL
);

130 
	}
}

133 
P©chFunùiÚ
*

134 
	gSpCÚ‹xt
::
	$ÿÎ“
(
Pošt
* 
±
) {

135  
	`·r£r
()->
	`ÿÎ“
(
±
, 
dœeùÿÎ_Úly_
 =ğ
çl£
);

136 
	}
}

138 
	gSpCÚ‹xt
::~
	$SpCÚ‹xt
() {

139 
d–‘e
 
c_mgr_
;

140 
	}
}

143 
	gSpCÚ‹xt
::
	$£t_®low_c
(
boŞ
 
b
) {

144 
®low_c_
 = 
b
;

145 ià(
b
 && !
c_mgr_
) {

146 
c_mgr_
 = 
Ãw
 
	`SpIpcMgr
();

148 
	}
}

	@SpEvent.C

1 
	~"SpEv’t.h
"

2 
	~"SpUts.h
"

3 
	~"SpP¬£r.h
"

4 
	~"SpCÚ‹xt.h
"

6 
usšg
 
	g¥
::
SpEv’t
;

7 
usšg
 
	g¥
::
SpP¬£r
;

8 
usšg
 
	g¥
::
SpCÚ‹xt
;

9 
usšg
 
	g¥
::
SyncEv’t
;

10 
usšg
 
	g¥
::
AsyncEv’t
;

11 
usšg
 
	g¥
::
SpPrİ–Ër
;

13 
usšg
 
	gph
::
P©chFunùiÚ
;

15 
Çme¥aû
 
	g¥
 {

17 
	gSpEv’t
::
SpEv’t
() {

21 
SpEv’t
::
»gi¡”_ev’t
(
SpCÚ‹xt
* 
c
) {

26 (*
ev’t_hªdËr_t
)(, 
	tsigšfo_t
*, *);

28 
SpCÚ‹xt
* 
	gg_cÚ‹xt
 = 
NULL
;

31 
async_ev’t_hªdËr
(
signum
, 
sigšfo_t
* 
šfo
, * 
cÚ‹xt
) {

32 
as£¹
(0 && "TODO");

42 
	gAsyncEv’t
::
AsyncEv’t
(
signum
, 
£c
)

43 : 
aá”_£cs_
(
£c
), 
signum_
(
signum
) {

44 
	ghªdËr_
 = (*)
async_ev’t_hªdËr
;

48 
	gAsyncEv’t
::
»gi¡”_ev’t
(
SpCÚ‹xt
* 
c
) {

49 
g_cÚ‹xt
 = 
c
;

50 
sigaùiÚ
 
	gaù
;

51 
	gaù
.
	g§_sigaùiÚ
 = (
ev’t_hªdËr_t
)
hªdËr_
;

52 
	gaù
.
	g§_æags
 = 
SA_SIGINFO
;

53 
sigaùiÚ
(
signum_
, &
aù
, 
NULL
);

54 ià(
	gsignum_
 =ğ
SIGALRM
è
®¬m
(
aá”_£cs_
);

58 
	gSyncEv’t
::
SyncEv’t
(
¡d
::
¡ršg
 
func_Çme
)

59 : 
SpEv’t
(), 
func_Çme_
(
func_Çme
) {

64 
	gSyncEv’t
::
»gi¡”_ev’t
(
SpCÚ‹xt
* 
c
) {

65 
g_cÚ‹xt
 = 
c
;

67 ià(!
	gg_cÚ‹xt
->
·r£r
()->
šjeùed
()) {

68 #iâdeà
SP_RELEASE


69 
¥_debug
("PRELOAD -…reload‡gent.so,‡nd instrument main()");

71 
P©chFunùiÚ
* 
	gf
 = 
c
->
·r£r
()->
fšdFunùiÚ
("main");

72 
	gc
->
š™_´İ–Ër
()->
go
(
f
, 
c
, c->
š™_befÜe
(), c->
š™_aá”
());

78 
	gSpCÚ‹xt
::
C®lSck
 
ÿÎ_¡ack
;

79 
	gg_cÚ‹xt
->
g‘_ÿÎ¡ack
(&
ÿÎ_¡ack
);

80 
¥_debug
("CALLSTACK - %lu c®l šhÿÎ sck", 
ÿÎ_¡ack
.
size
());

81 
	gi
 = 0; i < 
	gÿÎ_¡ack
.
size
(); i++) {

82 
P©chFunùiÚ
* 
	gf
 = 
ÿÎ_¡ack
[
i
];

83 
	gg_cÚ‹xt
->
š™_´İ–Ër
()->
go
(
f
, 
g_cÚ‹xt
,

84 
g_cÚ‹xt
->
š™_befÜe
(),

85 
g_cÚ‹xt
->
š™_aá”
());

86 ià(
	gf
->
Çme
().
com·»
("main") == 0) {

	@SpInstrumenter.C

1 
	~"SpIn¡rum’‹r.h
"

2 
	~"SpSn³t.h
"

3 
	~"SpCÚ‹xt.h
"

4 
	~"SpAddrS·û.h
"

5 
	~"SpUts.h
"

6 
	~"SpPošt.h
"

8 
usšg
 
	gdt
::
Add»ss
;

10 
usšg
 
	g¥
::
SpSn³t
;

11 
usšg
 
	g¥
::
SpCÚ‹xt
;

12 
usšg
 
	g¥
::
SpSn³t
;

13 
usšg
 
	g¥
::
SpAddrS·û
;

14 
usšg
 
	g¥
::
SpIn¡rum’‹r
;

16 
usšg
 
	gš
::
In¡ruùiÚ
;

18 
usšg
 
	gph
::
Pošt
;

19 
usšg
 
	gph
::
Sn³t
;

20 
usšg
 
	gph
::
AddrS·û
;

21 
usšg
 
	gph
::
P©chBlock
;

22 
usšg
 
	gph
::
P©chObjeù
;

23 
usšg
 
	gph
::
P©chMgrPŒ
;

24 
usšg
 
	gph
::
In¡ªûPŒ
;

25 
usšg
 
	gph
::
P©chFunùiÚ
;

26 
usšg
 
	gph
::
PushBackCommªd
;

28 
Çme¥aû
 
	g¥
 {

30 
SpCÚ‹xt
* 
g_cÚ‹xt
;

34 
SpIn¡rum’‹r
*

35 
	gSpIn¡rum’‹r
::
ü—‹
(
AddrS·û
* 
as
) {

36  
Ãw
 
SpIn¡rum’‹r
(
as
);

40 
	gSpIn¡rum’‹r
::
SpIn¡rum’‹r
(
AddrS·û
* 
as
)

41 : 
In¡rum’‹r
(
as
) {

46 
¡d
::
	tm­
<
	tAdd»ss
, 
	tSpSn³t
::
	t±r
> 
	tIn¡M­
;

47 
In¡M­
 
	gg_š¡_m­
;

52 
	gSpIn¡rum’‹r
::
Œ­_hªdËr
(
sig
, 
sigšfo_t
* 
šfo
, * 
c
) {

53 
Add»ss
 
	gpc
 = 
SpSn³t
::
g‘_´e_sigÇl_pc
(
c
) - 1;

55 
	gIn¡M­
& 
	gš¡_m­
 = 
g_š¡_m­
;

56 ià(
	gš¡_m­
.
fšd
(
pc
è=ğ
š¡_m­
.
’d
()) {

61 
	gSpSn³t
::
±r
 
¥_¢
 = 
š¡_m­
[
pc
];

64 * 
	gblob
 = (*)
¥_¢
->
buf
();

65 
	g³rm
 = 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
;

66 
P©chMgrPŒ
 
	gmgr
 = 
g_cÚ‹xt
->
mgr
();

67 
SpAddrS·û
* 
	gas
 = 
dyÇmic_ÿ¡
<SpAddrS·û*>(
mgr
->
as
());

68 ià(!
	gas
->
£t_¿nge_³rm
((
Add»ss
)
blob
, 
¥_¢
->
size
(), 
³rm
)) {

69 
	gas
->
dump_mem_m­s
();

70 
ex™
(0);

74 
	gSpSn³t
::
£t_pc
((
Add»ss
)
blob
, 
c
);

78 
boŞ


79 
	gSpIn¡rum’‹r
::
run
() {

82 
CommªdLi¡
::
™”©Ü
 
c
 = 
u£r_commªds_
.
begš
(); 
	gc
 !ğu£r_commªds_.
’d
(); c++) {

83 
PushBackCommªd
* 
	gcommªd
 = 
¡©ic_ÿ¡
<PushBackCommªd*>(*
c
);

85 ià(
	gcommªd
) {

86 
In¡ªûPŒ
 
	gš¡ªû
 = 
commªd
->
š¡ªû
();

87 
Pošt
* 
	g±
 = 
š¡ªû
->
pošt
();

88 
SpPošt
* 
	g¥t
 = 
¡©ic_ÿ¡
<SpPošt*>(
±
);

91 ià(!
	g±
->
g‘C®Ëe
(è&& 
	gg_cÚ‹xt
->
dœeùÿÎ_Úly
()) ;

93 #iâdeà
SP_RELEASE


94 ià(
	g¥t
->
š¡rum’‹d
()) {

95 
¥_debug
("SKIPED -…iÚˆ%lx i š¡rum’‹d, sk it", 
±
->
block
()->
Ï¡
());

98 ià(!
	g¥t
->
š¡rum’‹d
()) {

99 
	gSn³t
<
	gSpSn³t
::
±r
>::
PŒ
 
¢
 = 
Sn³t
<
SpSn³t
::±r>::
g‘
(
š¡ªû
->
¢³t
());

100 
	gSpSn³t
::
±r
 
¥_¢
 = 
¢
->
»p
();

101 
	g¥t
->
£t_¢
(
¥_¢
);

102 
Add»ss
 
	ge
 = 
±
->
block
()->
Ï¡
();

103 * 
	gš¢
 = (*)
e
;

106 
Add»ss
 
	g»t_addr
 = 
±
->
block
()->
’d
();

107 
	gIn¡ruùiÚ
::
PŒ
 
ÿÎš¢
 = 
±
->
block
()->
g‘In¢
(
e
);

110 ià(
	gÿÎš¢
->
g‘C©egÜy
(è=ğ
š
::
c_B¿nchIn¢
) {

112 #iâdeà
SP_RELEASE


113 
¥_debug
("TAIL CALL -…ošˆ%lx i ¨ c®l", 
±
->
block
()->
Ï¡
());

115 
	g¥t
->
£t_ÿÎ
(
Œue
);

116 
	g»t_addr
 = 0;

119 * 
	gblob
 = (*)
¥_¢
->
buf
();

120 
boŞ
 
	g»®loc
 = 
çl£
;

122 
	gREALLOC
:

123 
»l_addr
 = ()
blob
 - ()
e
;

128 
	g¥_¢
->
£t_Üig_ÿÎ_š¢
(
ÿÎš¢
);

131 ià((
	gš¢
[0] != ()0xe8)) {

133 
boŞ
 
jump_abs
 = 
çl£
;

134 ià(!
	g¥
::
is_di¥32
(
»l_addr
)è
jump_abs
 = 
Œue
;

137 ià(
š¡®l_šdœeù
(
¥t
, 
¥_¢
, 
jump_abs
, 
»t_addr
)) {

138 
	g¥t
->
£t_š¡rum’‹d
(
Œue
);

141 ià(!
	g»®loc
) {

142 
	g»®loc
 = 
Œue
;

143 
	gblob
 = (*)
¥_¢
->
»®loc
();

144 ià(
	gblob
è
	gREALLOC
;

148 ià(
	g»®loc
 && !
	g¥t
->
š¡rum’‹d
()) {

149 
¥_´št
("FAILEDo use JUMP - TRY TO USE TRAP");

152 
sigaùiÚ
 
	gaù
;

153 
	gaù
.
	g§_sigaùiÚ
 = 
SpIn¡rum’‹r
::
Œ­_hªdËr
;

154 
	gaù
.
	g§_æags
 = 
SA_SIGINFO
;

155 
sigaùiÚ
 
	gŞd_aù
;

156 
sigaùiÚ
(
SIGTRAP
, &
aù
, &
Şd_aù
);

158 
	gg_š¡_m­
[
e
] = 
¥_¢
;

159 
	gblob
 = 
¥_¢
->
blob
(
»t_addr
);

161 ià(
š¡®l_Œ­
(
¥t
, 
blob
, 
¥_¢
->
size
())) {

162 
	g¥t
->
£t_š¡®l_m‘hod
(
SP_TRAP
);

163 
	g¥t
->
£t_š¡rum’‹d
(
Œue
);

165 
¥_´št
("FAILEDo use TRAP,‚o instrumentation forhis…oint");

172 
	gblob
 = 
¥_¢
->
blob
(
»t_addr
);

174 ià(
š¡®l_dœeù
(
¥t
, 
blob
, 
¥_¢
->
size
())) {

175 
	g¥t
->
£t_š¡®l_m‘hod
(
SP_RELOC_INSN
);

176 
	g¥t
->
£t_š¡rum’‹d
(
Œue
);

178 
¥_´št
("FAILED - Failedo install instrumentation‡t %lx for calling %s",

179 
±
->
block
()->
Ï¡
(), 
g_cÚ‹xt
->
·r£r
()->
ÿÎ“
Õt)->
Çme
().
c_¡r
());

185 
	gu£r_commªds_
.
ş—r
();

187  
	gŒue
;

190 
boŞ


191 
	gSpIn¡rum’‹r
::
š¡®l_dœeù
(
SpPošt
* 
pošt
, * 
blob
, 
size_t
 
blob_size
) {

193 
	gjump
[5];

194 * 
	gp
 = 
jump
;

195 *
	gp
++ = 0xe9;

196 * 
	gÍ
 = (*)
p
;

199 
P©chObjeù
* 
	gobj
 = 
pošt
->
block
()->
objeù
();

200 * 
	gaddr
 = (*)
pošt
->
block
()->
Ï¡
();

201 
size_t
 
	gš¢_Ëngth
 = 
pošt
->
block
()->
’d
(è-…ošt->block()->
Ï¡
();

202 *
	gÍ
 = ()
blob
 - ()
addr
 - 
š¢_Ëngth
;

205 
SpAddrS·û
* 
	gas
 = 
¡©ic_ÿ¡
<SpAddrS·û*>(
as_
);

206 
	g³rm
 = 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
;

207 ià(
	gas
->
£t_¿nge_³rm
((
Add»ss
)
addr
, 
š¢_Ëngth
, 
³rm
)) {

208 
	gas
->
wr™e
(
obj
, (
Add»ss
)
addr
, (Add»ss)
jump
, 5);

210 
¥_´št
("MPROTECT - Failedo change memory‡ccess…ermission");

214 ià(!
	gas
->
£t_¿nge_³rm
((
Add»ss
)
blob
, 
blob_size
, 
³rm
)) {

215 
¥_´št
("MPROTECT - FaedØchªgmemÜy‡cûs ³rmissiÚ fÜ blob‡ˆ%lx", (
Dynš¡
::
Add»ss
)
blob
);

216 
	gas
->
dump_mem_m­s
();

217 
ex™
(0);

221 ià(!
	gas
->
»¡Üe_¿nge_³rm
((
Add»ss
)
addr
, 
š¢_Ëngth
)) {

222 
¥_´št
("MPROTECT - Failedo„estore memory‡ccess…ermission");

225  
	gŒue
;

228 
boŞ


229 
	gSpIn¡rum’‹r
::
š¡®l_šdœeù
(
SpPošt
* 
pošt
, 
SpSn³t
::
±r
 
¢
,

230 
boŞ
 
jump_abs
, 
Add»ss
 
»t_addr
) {

231 
P©chBlock
* 
	gblk
 = 
pošt
->
block
();

232 
size_t
 
	gblk_size
 = 
blk
->
size
();

233 
	g¡ršg
& 
	gÜig_blk
 = 
¢
->
Üig_blk
();

235 * 
	g¿w_blk
 = (*)
blk
->
¡¬t
();

236 
	gi
 = 0; i < 
	gblk_size
; i++) {

237 
	gÜig_blk
 +ğ
¿w_blk
[
i
];

240 
size_t
 
	glim™
 = 0;

245 
	gš¢
[64];

246 ià(!
	gjump_abs
) {

248 
	glim™
 = 5;

249 * 
	gp
 = 
š¢
;

250 *
	gp
++ = 0xe9;

251 * 
	gÍ
 = (*)
p
;

252 *
	gÍ
 = ()
¢
->
buf
(è- ()
blk
->
¡¬t
() - 5;

254 
	glim™
 = 
¢
->
jump_abs_size
();

256 
	g¡©ic_ÿ¡
<
	gSpPošt
*>(
	gpošt
)->
¢
()->
em™_jump_abs
(()¢->
buf
(), 
š¢
, 0, 
Œue
);

259 ià(
	gblk_size
 >ğ
lim™
) {

260 
pošt
->
£t_š¡®l_m‘hod
(
SP_RELOC_BLK
);

261  
š¡®l_jump
(
blk
, 
š¢
, 
lim™
, 
¢
, 
»t_addr
);

264 
	gpošt
->
£t_š¡®l_m‘hod
(
SP_SPRINGBOARD
);

265  
š¡®l_¥ršg
(
blk
, 
¢
, 
»t_addr
);

268 
boŞ


269 
	gSpIn¡rum’‹r
::
š¡®l_jump
(
P©chBlock
* 
blk
,

270 * 
š¢
, 
size_t
 
š¢_size
,

271 
SpSn³t
::
±r
 
¢
,

272 
Add»ss
 
»t_addr
) {

275 * 
	gblob
 = 
¢
->
blob
(
»t_addr
, 
Œue
);

277 
P©chObjeù
* 
	gobj
 = 
blk
->
obj
();

278 
SpAddrS·û
* 
	gas
 = 
¡©ic_ÿ¡
<SpAddrS·û*>(
as_
);

279 
	g³rm
 = 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
;

280 ià(!
	gas
->
£t_¿nge_³rm
((
Add»ss
)
blob
, 
¢
->
size
(), 
³rm
)) {

281 
¥_´št
("MPROTECT - FaedØchªgmemÜy‡cûs ³rmissiÚ fÜ blob‡ˆ%lx", (
Dynš¡
::
Add»ss
)
blob
);

282 
	gas
->
dump_mem_m­s
();

283 
ex™
(0);

286 * 
	gaddr
 = (*)
blk
->
¡¬t
();

289 ià(
	gas
->
£t_¿nge_³rm
((
Add»ss
)
addr
, 
š¢_size
, 
³rm
)) {

290 
	gas
->
wr™e
(
obj
, (
Add»ss
)
addr
, (Add»ss)
š¢
, 
š¢_size
);

292 
¥_´št
("MPROTECT - Failedo change memory‡ccess…ermission");

296 ià(!
	gas
->
»¡Üe_¿nge_³rm
((
Add»ss
)
addr
, 
š¢_size
)) {

297 
¥_´št
("MPROTECT - Failedo„estore memory‡ccess…ermission");

299 #iâdeà
SP_RELEASE


300 
¥_debug
("USE BLK-RELOC -…iÚˆ%lx i š¡rum’‹d usšg c®Èblock„–oÿtiÚ", 
blk
->
Ï¡
());

302  
	gŒue
;

306 
boŞ


307 
	gSpIn¡rum’‹r
::
š¡®l_¥ršg
(
P©chBlock
* 
ÿÎblk
,

308 
SpSn³t
::
±r
 
¢
,

309 
Add»ss
 
»t_addr
) {

317 
P©chBlock
* 
	g¥ršgblk
 = 
¢
->
¥ršg_blk
();

318 ià(!
	g¥ršgblk
è 
	gçl£
;

321 * 
	gblob
 = 
¢
->
blob
(
»t_addr
, 
Œue
,rue);

322 
P©chObjeù
* 
	gobj
 = 
ÿÎblk
->
obj
();

323 
SpAddrS·û
* 
	gas
 = 
¡©ic_ÿ¡
<SpAddrS·û*>(
as_
);

324 
	g³rm
 = 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
;

325 ià(!
	gas
->
£t_¿nge_³rm
((
Add»ss
)
blob
, 
¢
->
size
(), 
³rm
)) {

326 
¥_´št
("MPROTECT - FaedØchªgmemÜy‡cûs ³rmissiÚ fÜ blob‡ˆ%lx", (
Dynš¡
::
Add»ss
)
blob
);

327 
	gas
->
dump_mem_m­s
();

328 
ex™
(0);

332 * 
	g¥ršg
 = 
¢
->
¥ršg
(
¥ršgblk
->
Ï¡
());

333 
	gobj
 = 
¥ršgblk
->
obj
();

334 ià(!
	gas
->
£t_¿nge_³rm
((
Add»ss
)
¥ršg
, 
¢
->
¥ršg_size
(), 
³rm
)) {

335 
¥_´št
("MPROTECT - FaedØchªgmemÜy‡cûs ³rmissiÚ fÜ„–oÿ‹d s´šg blk‡ˆ%lx", (
Dynš¡
::
Add»ss
)
¥ršg
);

336 
	gas
->
dump_mem_m­s
();

337 
ex™
(0);

343 
	g¥ršgblk_š¢
[64];

346 
size_t
 
	goff
 = 0;

347 
size_t
 
	gisize
 = 
¢
->
em™_jump_abs
(()
¥ršg
, 
¥ršgblk_š¢
, 
off
, 
Œue
);

348 
	goff
 +ğ
isize
;

349 
size_t
 
	gÿÎ_blk_jmp_Œg
 = 
off
;

350 
	goff
 = 
¢
->
em™_jump_abs
(()
blob
, 
¥ršgblk_š¢
, 
off
, 
Œue
);

351 
	goff
 +ğ
isize
;

354 * 
	gaddr
 = (*)
¥ršgblk
->
¡¬t
();

355 ià(
	gas
->
£t_¿nge_³rm
((
Add»ss
)
addr
, 
¥ršgblk
->
size
(), 
³rm
)) {

356 
	gas
->
wr™e
(
obj
, (
Add»ss
)
addr
, (Add»ss)
¥ršgblk_š¢
, 
off
);

358 
¥_´št
("MPROTECT - Failedo change memory‡ccess…ermission");

362 ià(!
	gas
->
»¡Üe_¿nge_³rm
((
Add»ss
)
addr
, 
¥ršgblk
->
size
())) {

363 
¥_´št
("MPROTECT - Failedo„estore memory‡ccess…ermission");

368 
	gaddr
 = (*)
ÿÎblk
->
¡¬t
();

369 
	gÿÎblk_š¢
[2];

370 
	gÿÎblk_š¢
[0] = 0xeb;

371 
	gÿÎblk_š¢
[1] = ()(
¥ršgblk
->
¡¬t
(è+ 
ÿÎ_blk_jmp_Œg
 - (()
addr
 + 2));

373 ià(
	gas
->
£t_¿nge_³rm
((
Add»ss
)
addr
, 
ÿÎblk
->
size
(), 
³rm
)) {

374 
	gas
->
wr™e
(
obj
, (
Add»ss
)
addr
, (Add»ss)
ÿÎblk_š¢
, 2);

376 
¥_´št
("MPROTECT - Failedo change memory‡ccess…ermission");

380 ià(!
	gas
->
»¡Üe_¿nge_³rm
((
Add»ss
)
addr
, 
ÿÎblk
->
size
())) {

381 
¥_´št
("MPROTECT - Failedo„estore memory‡ccess…ermission");

383 #iâdeà
SP_RELEASE


384 
¥_debug
("USE SPRING -…iont %lx is instrumented using 1-hop spring",

385 
ÿÎblk
->
Ï¡
());

388  
	gŒue
;

392 
boŞ


393 
	gSpIn¡rum’‹r
::
š¡®l_Œ­
(
SpPošt
* 
pošt
, * 
blob
, 
size_t
 
blob_size
) {

395 
¡ršg
 
	gšt3
;

396 
	gšt3
 += ()0xcc;

398 
P©chObjeù
* 
	gobj
 = 
pošt
->
block
()->
objeù
();

399 * 
	gaddr
 = (*)
pošt
->
block
()->
Ï¡
();

400 
size_t
 
	gš¢_Ëngth
 = 
pošt
->
block
()->
’d
(è-…ošt->block()->
Ï¡
();

401 
	gi
 = 0; i < (
	gš¢_Ëngth
-1); i++) {

402 
	gšt3
 += ()0x90;

406 
SpAddrS·û
* 
	gas
 = 
dyÇmic_ÿ¡
<SpAddrS·û*>(
as_
);

407 
	g³rm
 = 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
;

408 ià(!
	gas
->
£t_¿nge_³rm
((
Add»ss
)
addr
, 
š¢_Ëngth
, 
³rm
)) {

409  
	gçl£
;

411 
	gas
->
wr™e
(
obj
, (
Add»ss
)
addr
, (Add»ss)
št3
.
c_¡r
(), iÁ3.
size
());

415 ià(!
	gas
->
»¡Üe_¿nge_³rm
((
Add»ss
)
addr
, 
š¢_Ëngth
)) {

416  
	gçl£
;

418 #iâdeà
SP_RELEASE


419 
¥_debug
("USE TRAP -…iÚˆ%lx i š¡rum’‹d usšg¿p", 
pošt
->
block
()->
Ï¡
());

421  
	gŒue
;

	@SpIpcMgr.C

1 
	~"SpPošt.h
"

2 
	~"SpUts.h
"

3 
	~"SpIpcMgr.h
"

4 
	~"SpCÚ‹xt.h
"

5 
	~"SpInjeùÜ.h
"

6 
	~<sys/wa™.h
>

8 
usšg
 
	gph
::
P©chFunùiÚ
;

10 
Çme¥aû
 
	g¥
 {

13 
SpCÚ‹xt
* 
g_cÚ‹xt
;

16 
	#TRACING_ID
 1987

	)

17 
	#TRACING_SIZE
 32768

	)

24 
	gSpIpcMgr
::
SpIpcMgr
() {

25 
pe_wÜk”_
 = 
Ãw
 
SpPeWÜk”
;

26 
	gwÜk”_£t_
.
š£¹
(
pe_wÜk”_
);

28 
	gtı_wÜk”_
 = 
Ãw
 
SpTıWÜk”
;

29 
	gwÜk”_£t_
.
š£¹
(
tı_wÜk”_
);

31 
	gudp_wÜk”_
 = 
Ãw
 
SpUdpWÜk”
;

32 
	gwÜk”_£t_
.
š£¹
(
udp_wÜk”_
);

37 
	gSpIpcMgr
::~
SpIpcMgr
() {

38 
d–‘e
 
pe_wÜk”_
;

39 
d–‘e
 
	gtı_wÜk”_
;

40 
d–‘e
 
	gudp_wÜk”_
;

52 
	gSpIpcMgr
::
g‘_wr™e_·¿m
(
SpPošt
* 
±
, * 
fd_out
, ** 
buf_out
,

53 * 
c_out
, 
size_t
* 
size_out
, 
sockaddr
** 
§_out
) {

54 
P©chFunùiÚ
* 
	gf
 = 
¥
::
ÿÎ“
(
±
);

55 ià(!
	gf
) ;

57 
Argum’tHªdË
 
	gh
;

58 ià(
	gf
->
Çme
().
com·»
("write") == 0 ||

59 
f
->
Çme
().
com·»
("send") == 0) {

61 * 
fd
 = (*)
¥
::
pİ_¬gum’t
(
±
, &
h
, ());

62 ià(
	gfd_out
è*fd_ouˆğ*
fd
;

63 ** 
	gbuf
 = (**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (*));

64 ià(
	gbuf_out
è*buf_ouˆğ*
buf
;

65 
size_t
* 
	gsize
 = (size_t*)
¥
::
pİ_¬gum’t
(
±
, &
h
, (size_t));

66 ià(
	gsize_out
è*size_ouˆğ*
size
;

83 ià(
	gf
->
Çme
().
com·»
("connect") == 0) {

84 * 
fd
 = (*)
¥
::
pİ_¬gum’t
(
±
, &
h
, ());

85 ià(
	gfd_out
è*fd_ouˆğ*
fd
;

86 
sockaddr
** 
	g§
 = (sockaddr**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (sockaddr*));

89 ià(
	g§_out
è*§_ouˆğ*
§
;

92 ià(
	gf
->
Çme
().
com·»
("fputs") == 0) {

93 ** 
¡r
 = (**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (*));

94 ià(
	gbuf_out
è*buf_ouˆğ(*)*
¡r
;

95 
FILE
** 
	gå
 = (FILE**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (FILE*));

96 if(
	gfd_out
è*fd_ouˆğ
f’o
(*
å
);

99 ià(
	gf
->
Çme
().
com·»
("fputc") == 0) {

100 * 
c
 = (*)
¥
::
pİ_¬gum’t
(
±
, &
h
, ());

101 ià(
	gc_out
è*c_ouˆğ*
c
;

102 
FILE
** 
	gå
 = (FILE**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (FILE*));

103 ià(
	gfd_out
è*fd_ouˆğ
f’o
(*
å
);

106 ià(
	gf
->
Çme
().
com·»
("fwrite_unlocked") == 0 ||

107 
f
->
Çme
().
com·»
("fwrite") == 0) {

108 ** 
±r
 = (**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (*));

109 ià(
	gbuf_out
è*buf_ouˆğ(*)*
±r
;

110 
size_t
* 
	gsize
 = (size_t*)
¥
::
pİ_¬gum’t
(
±
, &
h
, (size_t));

111 
size_t
* 
	gn
 = (size_t*)
¥
::
pİ_¬gum’t
(
±
, &
h
, (size_t));

112 ià(
	gsize_out
è*size_ouˆğ(*
size
è* (*
n
);

113 
FILE
** 
	gå
 = (FILE**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (FILE*));

114 if(
	gfd_out
è*fd_ouˆğ
f’o
(*
å
);

124 
	gSpIpcMgr
::
g‘_»ad_·¿m
(
SpPošt
* 
±
, * 
fd_out
, ** 
buf_out
,

125 
size_t
* 
size_out
) {

126 
P©chFunùiÚ
* 
	gf
 = 
¥
::
ÿÎ“
(
±
);

127 ià(!
	gf
) ;

129 
Argum’tHªdË
 
	gh
;

130 ià(
	gf
->
Çme
().
com·»
("read") == 0 ||

131 
f
->
Çme
().
com·»
("recv") == 0) {

132 * 
fd
 = (*)
¥
::
pİ_¬gum’t
(
±
, &
h
, ());

133 ià(
	gfd_out
è*fd_ouˆğ*
fd
;

134 ** 
	gbuf
 = (**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (*));

135 ià(
	gbuf_out
è*buf_ouˆğ*
buf
;

136 
size_t
* 
	gsize
 = (size_t*)
¥
::
pİ_¬gum’t
(
±
, &
h
, (size_t));

137 ià(
	gsize_out
è*size_ouˆğ*
size
;

140 ià(
	gf
->
Çme
().
com·»
("fgets") == 0) {

141 ** 
¡r
 = (**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (*));

142 ià(
	gbuf_out
è*buf_ouˆğ(*)*
¡r
;

143 * 
	gsize
 = (*)
¥
::
pİ_¬gum’t
(
±
, &
h
, ());

144 ià(
	gsize_out
è*size_ouˆğ*
size
;

145 
FILE
** 
	gå
 = (FILE**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (FILE*));

146 if(
	gfd_out
è*fd_ouˆğ
f’o
(*
å
);

149 ià(
	gf
->
Çme
().
com·»
("fgetc") == 0) {

150 
FILE
** 
å
 = (FILE**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (FILE*));

151 if(
	gfd_out
è*fd_ouˆğ
f’o
(*
å
);

154 ià(
	gf
->
Çme
().
com·»
("fread_unlocked") == 0 ||

155 
f
->
Çme
().
com·»
("fread") == 0) {

156 ** 
±r
 = (**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (*));

157 ià(
	gbuf_out
è*buf_ouˆğ(*)*
±r
;

158 
size_t
* 
	gsize
 = (size_t*)
¥
::
pİ_¬gum’t
(
±
, &
h
, (size_t));

159 
size_t
* 
	gn
 = (size_t*)
¥
::
pİ_¬gum’t
(
±
, &
h
, (size_t));

160 ià(
	gsize_out
è*size_ouˆğ(*
size
è* (*
n
);

161 
FILE
** 
	gå
 = (FILE**)
¥
::
pİ_¬gum’t
(
±
, &
h
, (FILE*));

162 if(
	gfd_out
è*fd_ouˆğ
f’o
(*
å
);

165 ià(
	gf
->
Çme
().
com·»
("accept") == 0) {

166 * 
fd
 = (*)
¥
::
pİ_¬gum’t
(
±
, &
h
, ());

167 ià(
	gfd_out
è*fd_ouˆğ*
fd
;

174 
boŞ


175 
	gSpIpcMgr
::
is_fÜk
(cÚ¡ * 
f
) {

176 ià(
¡rcmp
(
f
, "fÜk"è=ğ0è 
Œue
;

177  
	gçl£
;

181 
boŞ


182 
	gSpIpcMgr
::
is_pİ’
(cÚ¡ * 
f
) {

183 ià(
¡rcmp
(
f
, "pİ’"è=ğ0è 
Œue
;

184  
	gçl£
;

191 
	gSpIpcMgr
::
¡¬t_Œacšg
(
fd
) {

192 
WÜk”S‘
::
™”©Ü
 
wi
 = 
wÜk”_£t_
.
begš
();

193 
	gwi
 !ğ
wÜk”_£t_
.
’d
(); wi++) {

196 ià((*
	gwi
)->
¡¬t_Œacšg
(
fd
))  1;

204 
SpIpcWÜk”
* 
	gSpIpcMgr
::
g‘_wÜk”
(
fd
) {

206 ià(
is_pe
(
fd
)) {

207  
pe_wÜk”
();

210 ià(
is_tı
(
fd
)) {

211  
tı_wÜk”
();

214 ià(
is_udp
(
fd
)) {

215  
udp_wÜk”
();

219  
	gNULL
;

225 
boŞ


226 
	gSpIpcMgr
::
befÜe_’Œy
(
SpPošt
* 
±
) {

227 
P©chFunùiÚ
* 
f
 = 
¥
::
ÿÎ“
(
±
);

228 ià(!
	gf
è 
	gçl£
;

230 
	g¥
::
SpIpcMgr
* 
c_mgr
 = 
¥
::
g_cÚ‹xt
->ipc_mgr();

234 
	gfd
 = -1;

235 
sockaddr
* 
	g§
 = 
NULL
;

236 
	gc_mgr
->
g‘_wr™e_·¿m
(
±
, &
fd
, 
NULL
, NULL, NULL, &
§
);

237 ià(
	gfd
 != -1) {

238 
SpIpcWÜk”
* 
wÜk”
 = 
c_mgr
->
g‘_wÜk”
(
fd
);

239 ià(!
	gwÜk”
è 
	gçl£
;

241 
	gwÜk”
->
£t_¡¬t_Œacšg
(1);

243 
SpChªÃl
* 
	gc
 = 
wÜk”
->
g‘_chªÃl
(
fd
, 
SP_WRITE
, 
§
);

244 ià(
	gc
) {

250 
	gwÜk”
->
šjeù
(
c
);

253 ià(
ÿÎ“
(
±
)->
Çme
().
com·»
("connect") != 0)

254 
wÜk”
->
£t_¡¬t_Œacšg
(1, 
c
);

255 
	g±
->
£t_chªÃl
(
c
);

257  
	gŒue
;

261 
	gfd
 = -1;

262 
	gc_mgr
->
g‘_»ad_·¿m
(
±
, &
fd
, 
NULL
, NULL);

263 ià(
	gfd
 != -1) {

264 
SpIpcWÜk”
* 
wÜk”
 = 
c_mgr
->
g‘_wÜk”
(
fd
);

265 ià(!
	gwÜk”
è 
	gçl£
;

266 
SpChªÃl
* 
	gc
 = 
wÜk”
->
g‘_chªÃl
(
fd
, 
SP_READ
);

267 ià(
	gc
) {

268 
	g±
->
£t_chªÃl
(
c
);

271  
	gŒue
;

276 
boŞ


277 
	gSpIpcMgr
::
befÜe_ex™
(
SpPošt
* 
±
) {

278 
P©chFunùiÚ
* 
f
 = 
¥
::
ÿÎ“
(
±
);

279 ià(!
	gf
è 
	gçl£
;

282 
	g¥
::
SpIpcMgr
* 
c_mgr
 = 
¥
::
g_cÚ‹xt
->ipc_mgr();

283 ià(
	gc_mgr
->
is_fÜk
(
f
->
Çme
().
c_¡r
())) {

284 
	gpid
 = 
¥
::
»tv®
(
±
);

286 ià(
	gpid
 == 0) {

287 
c_mgr
->
pe_wÜk”
()->
£t_¡¬t_Œacšg
(0);

291 ià(
	gc_mgr
->
is_pİ’
(
f
->
Çme
().
c_¡r
())) {

292 
FILE
* 
	gå
 = (FILE*)
¥
::
»tv®
(
±
);

293 
	gfd
 = 
f’o
(
å
);

295 
¦“p
(2);

296 
SpChªÃl
* 
	gc
 = 
c_mgr
->
pe_wÜk”
()->
g‘_chªÃl
(
fd
, 
SP_WRITE
);

297 
	gc_mgr
->
pe_wÜk”
()->
£t_¡¬t_Œacšg
(0, 
c
);

302  
	gŒue
;

312 
SpChªÃl
* 
	gSpIpcWÜk”
::
g‘_chªÃl
(
fd
, 
ChªÃlRW
 
rw
, * 
¬g
) {

314 ià(
	grw
 =ğ
SP_WRITE
) {

315 ià(
chªÃl_m­_wr™e_
.
fšd
(
fd
è!ğchªÃl_m­_wr™e_.
’d
()) {

316 
SpChªÃl
* 
c
 = 
chªÃl_m­_wr™e_
[
fd
];

318 ià(
	gc
 && c->
	gty³
 =ğ
SP_TCP
) {

322  
c
;

325 ià(
	gchªÃl_m­_»ad_
.
fšd
(
fd
è!ğ
chªÃl_m­_»ad_
.
’d
())

326  
chªÃl_m­_»ad_
[
fd
];

330 
SpChªÃl
* 
	gc
 = 
ü—‹_chªÃl
(
fd
, 
rw
, 
¬g
);

331 
as£¹
(
c
);

334 ià(
	grw
 =ğ
SP_WRITE
) {

335 
c
->
rw
 = 
SP_WRITE
;

336 
	gchªÃl_m­_wr™e_
[
fd
] = 
c
;

337 #iâdeà
SP_RELEASE


338 
¥_debug
("WRITE CHANNEL @…id = %d - g‘‡ WRITE chªÃÈw™h inod%ld fÜ fd %d", 
g‘pid
(), 
g‘_šode_äom_fd
(
fd
), fd);

341 
	gc
->
	grw
 = 
SP_READ
;

342 
	gchªÃl_m­_»ad_
[
fd
] = 
c
;

343 #iâdeà
SP_RELEASE


344 
¥_debug
("READ CHANNEL @…id = %d - g‘‡ READ chªÃÈw™h inod%ld fÜ fd %d", 
g‘pid
(), 
g‘_šode_äom_fd
(
fd
), fd);

347 
	gc
->
	gfd
 = 
fd
;

348  
	gc
;

354 
	gSpPeWÜk”
::
SpPeWÜk”
() {

356 
Œacšg_š‹º®
(&
¡¬t_Œacšg_
);

357 
	g¡¬t_Œacšg_
[
g‘pid
()] = 0;

361 
	gSpPeWÜk”
::~
SpPeWÜk”
() {

362 
ChªÃlM­
::
™”©Ü
 
i
 = 
chªÃl_m­_wr™e_
.
begš
();

363 
	gi
 !ğ
chªÃl_m­_wr™e_
.
’d
(); i++) {

364 
d–‘e
 
	gi
->
	g£cÚd
;

366 
	gChªÃlM­
::
™”©Ü
 
i
 = 
chªÃl_m­_»ad_
.
begš
();

367 
	gi
 !ğ
chªÃl_m­_»ad_
.
’d
(); i++) {

368 
d–‘e
 
	gi
->
	g£cÚd
;

374 
	gSpPeWÜk”
::
Œacšg_š‹º®
(** 
¡¬t_Œacšg
) {

375 
shmid
;

376 ià((
	gshmid
 = 
shmg‘
(
TRACING_ID
, 
TRACING_SIZE
, 
IPC_CREAT
 | 0666)) < 0) {

377 
¥_³¼Ü
("ERROR: cªnÙ c»©sh¬ed memÜy w™h id %d", 
TRACING_ID
);

380 * 
	gshm
 = 
NULL
;

381 ià(()(
	gshm
 = (*)
shm©
(
shmid
, 
NULL
, 0)) == ()-1) {

382 
¥_³¼Ü
("ERROR: cannot get shared memory");

384 *
	g¡¬t_Œacšg
 = 
shm
;

387 
	gSpPeWÜk”
::
£t_¡¬t_Œacšg
(
yes_Ü_no
, 
SpChªÃl
* 
c
) {

388 
	g¡¬t_Œacšg_
[
c
->
»mÙe_pid
] = 
yes_Ü_no
;

392 
	gSpPeWÜk”
::
£t_¡¬t_Œacšg
(
yes_Ü_no
) {

393 
¡¬t_Œacšg_
[
g‘pid
()] = 
yes_Ü_no
;

397 
	gSpPeWÜk”
::
¡¬t_Œacšg
(
fd
) {

399  
¡¬t_Œacšg_
[
g‘pid
()];

403 
boŞ
 
	gSpPeWÜk”
::
šjeù
(
SpChªÃl
* 
c
, * 
ag’t_·th
,

410 ià(
	gc
->
	gšjeùed
è 
	gŒue
;

411 
¥_debug
("NO INJECTED -- start injection");

412 
	gSpInjeùÜ
::
±r
 
šjeùÜ
 = 
SpInjeùÜ
::
ü—‹
(
c
->
»mÙe_pid
);

413 
¡ršg
 
	gag’t_Çme
 = 
g_cÚ‹xt
->
·r£r
()->
g‘_ag’t_Çme
();

414 
	gšjeùÜ
->
šjeù
(
ag’t_Çme
.
c_¡r
());

415 
	gc
->
	gšjeùed
 = 
Œue
;

416  
	gŒue
;

419 
SpChªÃl
* 
	gSpPeWÜk”
::
ü—‹_chªÃl
(
fd
, 
ChªÃlRW
 
rw
, *) {

420 
SpChªÃl
* 
	gc
 = 
Ãw
 
PeChªÃl
;

421 
	gc
->
	gloÿl_pid
 = 
g‘pid
();

422 
PidS‘
 
	gpid_£t
;

423 
g‘_pids_äom_fd
(
fd
, 
pid_£t
);

424 #iâdeà
SP_RELEASE


425 
¥_debug
("FD TO PID - g‘‡ %lu…id äom fd %d", 
pid_£t
.
size
(), 
fd
);

427 
	gPidS‘
::
™”©Ü
 
i
 = 
pid_£t
.
begš
(); 
	gi
 !ğpid_£t.
’d
(); i++) {

428 ià(*
	gi
 !ğ
c
->
loÿl_pid
) {

429 
c
->
»mÙe_pid
 = *
i
;

433 
	gc
->
	gty³
 = 
SP_PIPE
;

434  
	gc
;

437 
	gSpTıWÜk”
::
SpTıWÜk”
(è: 
¡¬t_Œacšg_
(0) {

441 
SpTıWÜk”
::
£t_¡¬t_Œacšg
(
yes_Ü_no
, 
SpChªÃl
* 
c
) {

442 
¥_debug
("SET TRACING - yes_Ü_nØ(%d), fd (%d)", 
yes_Ü_no
, 
c
->
fd
);

443 
as£¹
(
c
);

445 ià(
	gc
 && 
is_tı
(
c
->
fd
)) {

446 
ušt8_t
 
	gm¬k_by‹
 = (
g‘pid
() & 0xFF) | 1;

447 
¥_debug
("OOB MARK - s’dšg %x vŸ fd=%d", 
m¬k_by‹
, 
c
->
fd
);

448 ià(
£nd
(
c
->
fd
, &
m¬k_by‹
, (m¬k_by‹), 
MSG_OOB
) < 0) {

449 
³¼Ü
("send");

450 
¥_³¼Ü
("OUT-OF-BAND - failedo send oob byte");

458 
	gSpTıWÜk”
::
£t_¡¬t_Œacšg
(
yes_Ü_no
) {

459 
¡¬t_Œacšg_
 = 
yes_Ü_no
;

482 
	gSpTıWÜk”
::
¡¬t_Œacšg
(
fd
) {

484 ià(
is_tı
(
fd
è&& !
¡¬t_Œacšg_
) {

495 
fd_£t
 
r£t
, 
	gx£t
;

496 
FD_ZERO
(&
r£t
);

497 
FD_ZERO
(&
x£t
);

499 
FD_SET
(
fd
, &
r£t
);

500 
FD_SET
(
fd
, &
x£t
);

501 
£Ëù
(
fd
+1, &
r£t
, 
NULL
, &
x£t
, NULL);

502 ià(
FD_ISSET
(
fd
, &
x£t
)) {

503 
ušt8_t
 
	gm¬k
 = 0;

504 
»cv
(
fd
, &
m¬k
, (m¬k), 
MSG_OOB
);

505 ià(
	gm¬k
 !ğ0è
¡¬t_Œacšg_
 = 1;

515  
	g¡¬t_Œacšg_
;

521 
boŞ
 
	gSpTıWÜk”
::
šjeù
(
SpChªÃl
* 
c
, * 
ag’t_·th
,

522 * 
šjeùÜ_·th
,

523 * 
ijag’t_·th
) {

527 ià(
	gc
->
	gšjeùed
è 
	gŒue
;

528 
¥_debug
("NO INJECTED -- start injection");

530 
TıChªÃl
 *
	gtı_chªÃl
 = 
¡©ic_ÿ¡
<TıChªÃl*>(
c
);

531 
as£¹
(
tı_chªÃl
);

533 
	gloÿl_
[256];

534 
	gloÿl_pÜt
[64];

535 
	g»mÙe_
[256];

536 
	g»mÙe_pÜt
[64];

538 ià(!
g‘_add»ss
(&
tı_chªÃl
->
loÿl
, 
loÿl_
, 256, 
loÿl_pÜt
, 64)) {

539 
¥_³¼Ü
("failedo get†ocal‡ddress incp_worker::inject()");

541 ià(!
g‘_add»ss
(&
tı_chªÃl
->
»mÙe
, 
»mÙe_
, 256, 
»mÙe_pÜt
, 64)) {

542 
¥_³¼Ü
("failedo get„emote‡ddress incp_worker::inject()");

549 
boŞ
 
	gloÿl_machše
 = 
çl£
;

550 ià(
¡r¡r
(
»mÙe_
, "127.0.0.1")) {

551 
¥_debug
("LOCAL MACHINE TCP");

552 
	gloÿl_machše
 = 
Œue
;

554 
¥_debug
("REMOTE IP: %s, REMOTE PORT: %s", 
»mÙe_
, 
»mÙe_pÜt
);

557 
¡ršg
 
	gdeçuÉ_ag’t_·th
;

558 
¡ršg
 
	gdeçuÉ_šjeùÜ_·th
;

559 
¡ršg
 
	gdeçuÉ_ijag’t_·th
;

561 ià(
	gag’t_·th
 =ğ
NULL
) {

562 
as£¹
(
g_cÚ‹xt
);

563 
as£¹
(
g_cÚ‹xt
->
·r£r
());

564 
as£¹
(
g_cÚ‹xt
->
·r£r
()->
g‘_ag’t_Çme
().
size
() > 0);

565 
	gdeçuÉ_ag’t_·th
 +ğ
g‘’v
("SP_DIR");

566 
	gdeçuÉ_ag’t_·th
 += "/";

567 
	gdeçuÉ_ag’t_·th
 +ğ
g‘’v
("PLATFORM");

568 
	gdeçuÉ_ag’t_·th
 += "/";

569 
	gdeçuÉ_ag’t_·th
 +ğ
¥_f’ame
((*)
g_cÚ‹xt
->
·r£r
()->
g‘_ag’t_Çme
().
c_¡r
());

570 
	gag’t_·th
 = (*)
deçuÉ_ag’t_·th
.
c_¡r
();

572 ià(
	gšjeùÜ_·th
 =ğ
NULL
) {

573 
deçuÉ_šjeùÜ_·th
 +ğ
g‘’v
("SP_DIR");

574 
	gdeçuÉ_šjeùÜ_·th
 += "/";

575 
	gdeçuÉ_šjeùÜ_·th
 +ğ
g‘’v
("PLATFORM");

576 
	gdeçuÉ_šjeùÜ_·th
 += "/Injector";

577 
	gšjeùÜ_·th
 = (*)
deçuÉ_šjeùÜ_·th
.
c_¡r
();

579 ià(
	gijag’t_·th
 =ğ
NULL
) {

580 
deçuÉ_ijag’t_·th
 +ğ
g‘’v
("SP_DIR");

581 
	gdeçuÉ_ijag’t_·th
 += "/";

582 
	gdeçuÉ_ijag’t_·th
 +ğ
g‘’v
("PLATFORM");

583 
	gdeçuÉ_ijag’t_·th
 += "/libijagent.so";

584 
	gijag’t_·th
 = (*)
deçuÉ_ijag’t_·th
.
c_¡r
();

587 
¥_debug
("AGENT PATH - %s", 
ag’t_·th
);

588 
¥_debug
("INJECTOR PATH - %s", 
šjeùÜ_·th
);

589 
¥_debug
("IJAGENT PATH - %s", 
ijag’t_·th
);

592 
¡ršg
 
	gexe_cmd
;

593 ià(
	gloÿl_machše
) {

594 
	gexe_cmd
 = 
šjeùÜ_·th
;

595 
	gexe_cmd
 += " ";

598 
	gexe_cmd
 = "ssh ";

599 
	gexe_cmd
 +ğ
»mÙe_
;

600 
	gexe_cmd
 += " ";

601 
	gexe_cmd
 +ğ
šjeùÜ_·th
;

602 
	gexe_cmd
 += " ";

604 
	gexe_cmd
 +ğ
loÿl_
;

605 
	gexe_cmd
 += " ";

606 
	gexe_cmd
 +ğ
loÿl_pÜt
;

607 
	gexe_cmd
 += " ";

608 
	gexe_cmd
 +ğ
»mÙe_
;

609 
	gexe_cmd
 += " ";

610 
	gexe_cmd
 +ğ
»mÙe_pÜt
;

611 
	gexe_cmd
 += " ";

612 
	gexe_cmd
 +ğ
ag’t_·th
;

614 
¥_debug
("INJECT CMD - %s", 
exe_cmd
.
c_¡r
());

621 
FILE
* 
	gå
 = 
pİ’
(
exe_cmd
.
c_¡r
(), "r");

622 
	glše
[1024];

623 
fg‘s
(
lše
, 1024, 
å
);

624 
fg‘s
(
lše
, 1024, 
å
);

625 ià(
¡r¡r
(
lše
, "INJECTED"è!ğ
NULL
) {

626 
c
->
šjeùed
 = 
Œue
;

628 
pşo£
(
å
);

630  
	gŒue
;

635 
SpChªÃl
* 
	gSpTıWÜk”
::
ü—‹_chªÃl
(
fd
, 
ChªÃlRW
 
rw
, * 
¬g
) {

636 
TıChªÃl
* 
	gc
 = 
Ãw
 TcpChannel;

637 
	gc
->
	gloÿl_pid
 = 
g‘pid
();

638 
	gc
->
	gty³
 = 
SP_TCP
;

639 
	gc
->
	gšode
 = 
g‘_šode_äom_fd
(
fd
);

642 ià(
	g¬g
 !ğ
NULL
) {

645 
ho¡
[256];

646 
	g£rviû
[64];

647 
	gc
->
	g»mÙe
 = *((
sockaddr_¡Üage
*)
¬g
);

648 ià(
g‘_add»ss
(&
c
->
»mÙe
, 
ho¡
, 256, 
£rviû
, 64)) {

649 
¥_debug
("cÚÃù„emÙho¡: %s, s”viû: %s\n", 
ho¡
, 
£rviû
);

651 
¥_³¼Ü
("failedo get connect„emote‡ddress");

655 ià(
g‘_loÿl_add»ss
(
fd
, &
c
->
loÿl
)) {

656 ià(
g‘_add»ss
(&
c
->
loÿl
, 
ho¡
, 256, 
£rviû
, 64)) {

657 
¥_debug
("cÚÃù†oÿÈho¡: %s, s”viû: %s\n", 
ho¡
, 
£rviû
);

659 
¥_³¼Ü
("failedo get†ocal‡ddress for write/send");

666 ià(
	grw
 =ğ
SP_WRITE
) {

668 ià(
g‘_»mÙe_add»ss
(
fd
, &
c
->
»mÙe
)) {

669 
ho¡
[256];

670 
	g£rviû
[64];

671 ià(
g‘_add»ss
(&
c
->
»mÙe
, 
ho¡
, 256, 
£rviû
, 64)) {

672 
¥_debug
("wr™e/£nd„emÙho¡: %s, s”viû: %s\n", 
ho¡
, 
£rviû
);

674 
¥_³¼Ü
("failedo get„emote‡ddress for write/send");

679 ià(
g‘_loÿl_add»ss
(
fd
, &
c
->
loÿl
)) {

680 
	gho¡
[256];

681 
	g£rviû
[64];

682 ià(
g‘_add»ss
(&
c
->
loÿl
, 
ho¡
, 256, 
£rviû
, 64)) {

683 
¥_debug
("wr™e/£nd†oÿÈho¡: %s, s”viû: %s\n", 
ho¡
, 
£rviû
);

685 
¥_³¼Ü
("failedo get†ocal‡ddress for write/send");

689  
	gc
;

694 
	gSpUdpWÜk”
::
£t_¡¬t_Œacšg
(
yes_Ü_no
, 
SpChªÃl
* 
c
) {

697 
	gSpUdpWÜk”
::
£t_¡¬t_Œacšg
(
yes_Ü_no
) {

700 
SpUdpWÜk”
::
¡¬t_Œacšg
(
fd
) {

704 
boŞ
 
	gSpUdpWÜk”
::
šjeù
(
SpChªÃl
* 
c
, * 
ag’t_·th
,

705 * 
šjeùÜ_·th
,

706 * 
ijag’t_·th
) {

710 
SpChªÃl
* 
	gSpUdpWÜk”
::
ü—‹_chªÃl
(
fd
, 
ChªÃlRW
 
rw
, *) {

711  
	gNULL
;

	@SpParser.C

1 
	~"SpIn¡rum’‹r.h
"

2 
	~"SpP¬£r.h
"

3 
	~"SpCÚ‹xt.h
"

4 
	~"SpAddrS·û.h
"

5 
	~"SpUts.h
"

6 
	~"SpPošt.h
"

7 
	~"SpPoštMak”.h
"

8 
	~"SpObjeù.h
"

9 
	~"SpInjeùÜ.h
"

11 
usšg
 
	gsb
::
Symb
;

12 
usšg
 
	gsb
::
SymbŞ
;

13 
usšg
 
	gsb
::
RegiÚ
;

15 
usšg
 
	g¥
::
SpP¬£r
;

16 
usšg
 
	g¥
::
SpAddrS·û
;

17 
usšg
 
	gsb
::
Add»ssLookup
;

19 
usšg
 
	g³
::
CodeObjeù
;

20 
usšg
 
	g³
::
CodeRegiÚ
;

21 
usšg
 
	g³
::
SymbCodeSourû
;

23 
usšg
 
	gš
::
ResuÉ
;

24 
usšg
 
	gš
::
Vis™Ü
;

25 
usšg
 
	gš
::
ImmedŸ‹
;

26 
usšg
 
	gš
::
Ex´essiÚ
;

27 
usšg
 
	gš
::
In¡ruùiÚ
;

28 
usšg
 
	gš
::
D”eã»nû
;

29 
usšg
 
	gš
::
Regi¡”AST
;

30 
usšg
 
	gš
::
Bš¬yFunùiÚ
;

31 
usšg
 
	gš
::
In¡ruùiÚDecod”
;

33 
usšg
 
	gph
::
Pošt
;

34 
usšg
 
	gph
::
P©chMgr
;

35 
usšg
 
	gph
::
AddrS·û
;

36 
usšg
 
	gph
::
P©chBlock
;

37 
usšg
 
	gph
::
PoštMak”
;

38 
usšg
 
	gph
::
P©chObjeù
;

39 
usšg
 
	gph
::
P©chMgrPŒ
;

40 
usšg
 
	gph
::
P©chFunùiÚ
;

42 
usšg
 
	gdt
::
Add»ss
;

44 
Çme¥aû
 
	g¥
 {

46 
SpCÚ‹xt
* 
g_cÚ‹xt
;

48 
	gSpP¬£r
::
SpP¬£r
()

49 : 
exe_obj_
(
NULL
), 
šjeùed_
(
çl£
),
¥_off£t_
(0) {

50 
š™_dynš¡_libs
();

53 
	gSpP¬£r
::~
SpP¬£r
() {

54 
CodeSourûs
::
™”©Ü
 
i
 = 
code_¤cs_
.
begš
();

55 
	gi
 !ğ
code_¤cs_
.
’d
(); i++) {

56 
SymbCodeSourû
* 
	gscs
 = 
¡©ic_ÿ¡
<SymbCodeSourû*>(*
i
);

57 
d–‘e
 
	gscs
;

59 
	gCodeObjeùs
::
™”©Ü
 
i
 = 
code_objs_
.
begš
();

60 
	gi
 !ğ
code_objs_
.
’d
(); i++)

61 
d–‘e
 *
	gi
;

64 
	gSpP¬£r
::
±r


65 
SpP¬£r
::
ü—‹
() {

66  
±r
(
Ãw
 
SpP¬£r
);

71 
Add»ss
 
	goff£ts
[100];

72 } 
	tIjLib
;

75 
boŞ


76 
	gSpP¬£r
::
is_dynš¡_lib
(
¡ršg
 
lib
) {

77 
i
 = 0; 
	gi
 < 
	gdynš¡_libs_
.
size
(); i++) {

78 ià(
	glib
.
fšd
(
dynš¡_libs_
[
i
]è!ğ
¡ršg
::
Åos
è 
Œue
;

80  
	gçl£
;

84 
	gSpP¬£r
::
š™_dynš¡_libs
() {

85 
dynš¡_libs_
.
push_back
("libpatchAPI.so");

86 
	gdynš¡_libs_
.
push_back
("libparseAPI.so");

87 
	gdynš¡_libs_
.
push_back
("libstackwalk.so");

88 
	gdynš¡_libs_
.
push_back
("libsymtabAPI.so");

89 
	gdynš¡_libs_
.
push_back
("libinstructionAPI.so");

90 
	gdynš¡_libs_
.
push_back
("libelf.so");

91 
	gdynš¡_libs_
.
push_back
("libdwarf.so");

92 
	gdynš¡_libs_
.
push_back
("libcommon.so");

96 
P©chMgrPŒ


97 
	gSpP¬£r
::
·r£
() {

98 ià(
mgr_
)  mgr_;

101 
Add»ssLookup
* 
	g®
 = Add»ssLookup::
ü—‹Add»ssLookup
(
g‘pid
());

102 
	g®
->
»äesh
();

103 
	g¡d
::
veùÜ
<
Symb
*> 
bs
;

104 
	g®
->
g‘AÎSymbs
(
bs
);

110 
	g¡d
::
veùÜ
<
Symb
*>::
™”©Ü
 
i
 = 
bs
.
begš
(); 
	gi
 !ğbs.
’d
(); i++) {

111 
Symb
* 
	gsym
 = *
i
;

112 ià(
	gsym
->
Çme
().
fšd
("libijag’t.so"è!ğ
¡ršg
::
Åos
) {

113 
šjeùed_
 = 
Œue
;

118 
IjLib
* 
	gshm
 = 
NULL
;

119 ià(
	gšjeùed_
) {

120 
	gshm
 = (
IjLib
*)
SpInjeùÜ
::
g‘_shm
(1985, (IjLib));

127 
	gcur
 = 0;

128 
	g¡d
::
	tm­
<
	tAdd»ss
, 
	tboŞ
> 
	tLibLookup
;

129 
LibLookup
 
	glib_lookup
;

130 
	glib_lookup
[0] = 
Œue
;

131 ià(
	gšjeùed_
) {

132 ()
	gshm
->
	goff£ts
[
cur
] != -1) {

133 
lib_lookup
[
shm
->
off£ts
[
cur
]] = 
Œue
;

134 ++
	gcur
;

138 
P©chObjeùs
 
	g·tch_objs
;

139 
	g¡d
::
veùÜ
<
Symb
*>::
™”©Ü
 
i
 = 
bs
.
begš
(); 
	gi
 !ğbs.
’d
(); i++) {

140 
Symb
* 
	gsym
 = *
i
;

141 
Add»ss
 
	glßd_addr
 = 0;

142 
	g®
->
g‘LßdAdd»ss
(
sym
, 
lßd_addr
);

147 ià(
	gšjeùed_
) {

148 ià((
	glib_lookup
.
fšd
(
lßd_addr
è=ğ
lib_lookup
.
’d
()) &&

149 (
sym
->
Çme
().
fšd
(
¥_f’ame
(¥_f’ame(
g‘_ag’t_Çme
().
c_¡r
()))è=ğ
¡ršg
::
Åos
) &&

150 (
sym
->
Çme
().
fšd
("libag’t.so"è=ğ
¡ršg
::
Åos
)) {

151 #iâdeà
SP_RELEASE


152 
¥_debug
("SKIPED - sk…¬sšg %s", 
¥_f’ame
(
sym
->
Çme
().
c_¡r
()));

157 ià(
is_dynš¡_lib
(
sym
->
Çme
())) {

158 #iâdeà
SP_RELEASE


159 
¥_debug
("SKIPED - sk…¬sšg %s", 
¥_f’ame
(
sym
->
Çme
().
c_¡r
()));

166 
SymbCodeSourû
* 
	gscs
 = 
Ãw
 SymbCodeSourû(
sym
);

167 
	gcode_¤cs_
.
push_back
(
scs
);

168 
CodeObjeù
* 
	gco
 = 
Ãw
 CodeObjeù(
scs
);

169 
	gcode_objs_
.
push_back
(
co
);

170 
	gco
->
·r£
();

173 
P©chObjeù
* 
	g·tch_obj
 = 
Ãw
 
¥
::
SpObjeù
(
co
, 
lßd_addr
, 
NULL
, NULL,†ßd_addr?lßd_addr:
scs
->
lßdAdd»ss
());

175 
	g·tch_objs
.
push_back
(
·tch_obj
);

176 #iâdeà
SP_RELEASE


177 
¥_debug
("PARSED -…¬£d %s", 
¥_f’ame
(
sym
->
Çme
().
c_¡r
()));

179 ià(
	gsym
->
isExec
()) {

180 
	gexe_obj_
 = 
·tch_obj
;

181 
	gexe_Çme_
 = 
sym
->
Çme
().
c_¡r
();

182 #iâdeà
SP_RELEASE


183 
¥_debug
("EXE - % i ªƒxecubË", 
¥_f’ame
(
sym
->
Çme
().
c_¡r
()));

189 ià(!
	gexe_obj_
) {

190 
	gexe_obj_
 = 
·tch_objs
[0];

194 
SpAddrS·û
* 
	gas
 = SpAddrS·û::
ü—‹
(
exe_obj_
);

195 
	gph
::
In¡rum’‹r
* 
š¡
 = 
NULL
;

196 
	gš¡
 = 
¥
::
SpIn¡rum’‹r
::
ü—‹
(
as
);

198 
	g¥
::
SpPoštMak”
* 
pm
 = 
Ãw
 SpPointMaker;

199 
	gmgr_
 = 
P©chMgr
::
ü—‹
(
as
, 
š¡
, 
pm
);

200 
	gSpP¬£r
::
P©chObjeùs
::
™”©Ü
 
i
 = 
·tch_objs
.
begš
(); 
	gi
 !ğ·tch_objs.
’d
(); i++) {

201 ià(*
	gi
 !ğ
exe_obj_
) {

202 
as
->
lßdLib¿ry
(*
i
);

207 ià(
	gšjeùed_
) {

208 
shmùl
(
IJLIB_ID
, 
IPC_RMID
, 
NULL
);

209 
shmùl
(
IJMSG_ID
, 
IPC_RMID
, 
NULL
);

211  
	gmgr_
;

215 
P©chFunùiÚ
*

216 
	gSpP¬£r
::
fšdFunùiÚ
(
Add»ss
 
addr
) {

218 
AddrS·û
* 
as
 = 
mgr_
->as();

219 
	gAddrS·û
::
ObjM­
::
™”©Ü
 
ci
 = 
as
->
objM­
().
begš
(); 
	gci
 !ğas->objM­().
’d
(); ci++) {

220 
P©chObjeù
* 
	gobj
 = 
ci
->
£cÚd
;

221 
SymbCodeSourû
* 
	gcs
 = (SymbCodeSourû*)
obj
->
co
()->
cs
();

222 
Symb
* 
	gsym
 = 
cs
->
g‘SymbObjeù
();

223 
Add»ss
 
	glow”_bound
 = 
obj
->
codeBa£
();

224 ià(!
	glow”_bound
èlow”_bound = 
sym
->
g‘LßdOff£t
();

225 
Add»ss
 
	guµ”_bound
 = 
low”_bound
 + 
cs
->
Ëngth
();

227 ià(
	gaddr
 >ğ
low”_bound
 && 
addr
 <ğ
uµ”_bound
) {

228 
Add»ss
 
add»ss
 = 
addr
;

229 
	gsb
::
FunùiÚ
* 
f
;

230 ià(!
	gsym
->
g‘CÚššgFunùiÚ
(
add»ss
, 
f
)) {

231 
	gadd»ss
 -ğ
low”_bound
;

234 
	g¡d
::
veùÜ
<
CodeRegiÚ
*>::
cÚ¡_™”©Ü
 
ri
 = 
cs
->
»giÚs
().
begš
();

235 
	gri
 !ğ
cs
->
»giÚs
().
’d
();„i++) {

236 
	g¡d
::
£t
<
³
::
FunùiÚ
*> 
funcs
;

237 
	gobj
->
co
()->
fšdFuncs
(*
ri
, 
add»ss
, 
funcs
);

239 ià(
	gfuncs
.
size
() > 0) {

240 
P©chFunùiÚ
* 
	gpfunc
 = 
obj
->
g‘Func
(*
funcs
.
begš
());

241  
	gpfunc
;

247  
	gNULL
;

251 
	glibÇme
[512];

252 
	g”r
[512];

253 
	glßded
;

254 
	gpc
;

255 
	g¥
;

256 
	gbp
;

257 } 
	tIjMsg
;

260 
¡ršg


261 
	gSpP¬£r
::
g‘_ag’t_Çme
() {

262 ià(
ag’t_Çme_
.
size
() > 0) ‡gent_name_;

265 ià(
	gšjeùed_
) {

266 
IjMsg
* 
	gmsg_shm
 = (IjMsg*)
SpInjeùÜ
::
g‘_shm
(1986, (IjMsg));

267 
	gag’t_Çme_
 = 
msg_shm
->
libÇme
;

268  
	gag’t_Çme_
;

274 
¡ršg
 
	gš™_befÜe
 = 
g_cÚ‹xt
->
š™_befÜe_Çme
();

275 
P©chFunùiÚ
* 
	gf
 = 
fšdFunùiÚ
(
š™_befÜe
);

276 
Symb
* 
	gsym
 = ((
SymbCodeSourû
*)(
f
->
obj
()->
co
()->
cs
()))->
g‘SymbObjeù
();

277 
	gag’t_Çme_
 = 
sym
->
Çme
().
c_¡r
();

278  
	gag’t_Çme_
;

282 
Add»ss


283 
	gSpP¬£r
::
g‘_func_addr
(
¡ršg
 
Çme
) {

284 
AddrS·û
* 
as
 = 
mgr_
->as();

285 
	gAddrS·û
::
ObjM­
::
™”©Ü
 
ci
 = 
as
->
objM­
().
begš
(); 
	gci
 !ğas->objM­().
’d
(); ci++) {

286 
P©chObjeù
* 
	gobj
 = 
ci
->
£cÚd
;

287 
CodeObjeù
* 
	gco
 = 
obj
->
co
();

288 
	gCodeObjeù
::
funşi¡
& 
®l
 = 
co
->
funcs
();

289 
	gCodeObjeù
::
funşi¡
::
™”©Ü
 
f™
 = 
®l
.
begš
(); 
	gf™
 !ğ®l.
’d
(); fit++) {

290 ià((*
	gf™
)->
Çme
().
com·»
(name) == 0) {

291 
Add»ss
 
addr
 = (*
f™
)->addr(è+ 
obj
->
codeBa£
();

292  
	gaddr
;

303 
P©chFunùiÚ
*

304 
	gSpP¬£r
::
fšdFunùiÚ
(
¡ršg
 
Çme
, 
boŞ
 
sk
) {

305 
¥_debug
("FIND FUNC -†ookšg fÜ %s", 
Çme
.
c_¡r
());

306 ià(
	g»®_func_m­_
.
fšd
(
Çme
è!ğ
»®_func_m­_
.
’d
()) {

307  
»®_func_m­_
[
Çme
];

310 
AddrS·û
* 
	gas
 = 
mgr_
->
as
();

311 
	gAddrS·û
::
ObjM­
::
™”©Ü
 
ci
 = 
as
->
objM­
().
begš
(); 
	gci
 !ğas->objM­().
’d
(); ci++) {

313 
P©chObjeù
* 
	gobj
 = 
ci
->
£cÚd
;

314 
CodeObjeù
* 
	gco
 = 
obj
->
co
();

315 
	gCodeObjeù
::
funşi¡
& 
®l
 = 
co
->
funcs
();

316 
SymbCodeSourû
* 
	gcs
 = (SymbCodeSourû*)
obj
->
co
()->
cs
();

317 
Symb
* 
	gsym
 = 
cs
->
g‘SymbObjeù
();

318 
¥_debug
("IN OBJECT - %s", 
sym
->
Çme
().
c_¡r
());

319 ià(
	gsk
 && 
	gg_cÚ‹xt
->
is_w–l_known_lib
(
¥_f’ame
(
sym
->
Çme
().
c_¡r
()))) {

320 
¥_debug
("SKIP - %s", 
Çme
.
c_¡r
());

324 
	gCodeObjeù
::
funşi¡
::
™”©Ü
 
f™
 = 
®l
.
begš
(); 
	gf™
 !ğ®l.
’d
(); fit++) {

325 ià((*
	gf™
)->
Çme
().
com·»
(name) == 0) {

326 
RegiÚ
* 
»giÚ
 = 
sym
->
fšdEnşosšgRegiÚ
((*
f™
)->
addr
());

327 ià(
	g»giÚ
 &&„egiÚ->
g‘RegiÚName
().
com·»
(".plt") == 0) {

328 
¥_debug
("A PLT, SKIP - %s", 
Çme
.
c_¡r
());

331 
P©chFunùiÚ
* 
	gfound
 = 
obj
->
g‘Func
(*
f™
);

332 
	g»®_func_m­_
[
Çme
] = 
found
;

333 
¥_debug
("FOUND - %s", 
Çme
.
c_¡r
());

334  
	gfound
;

338 
¥_debug
("NO FOUND - %s", 
Çme
.
c_¡r
());

339  
	gNULL
;

343 
¡ršg


344 
	gSpP¬£r
::
dump_š¢
(* 
addr
, 
size_t
 
size
) {

346 
Add»ss
 
	gba£
 = (Add»ss)
addr
;

347 
SymbCodeSourû
* 
	gcs
 = (SymbCodeSourû*)
mgr_
->
as
()->
execubË
()->
co
()->
cs
();

348 
¡ršg
 
	gs
;

349 
	gbuf
[256];

350 
In¡ruùiÚDecod”
 
deco
(
addr
,

351 
size
,

352 
cs
->
g‘Arch
());

353 
	gIn¡ruùiÚ
::
PŒ
 
š¢
 = 
deco
.
decode
();

354 
	gš¢
) {

355 
¥rštf
(
buf
, " %lx(%2lu by‹s): %-25 | ", 
ba£
, 
š¢
->
size
(), in¢->
fÜm©
(ba£).
c_¡r
());

356 * 
	g¿w
 = (*)
š¢
->
±r
();

357 
	gi
 = 0; i < 
	gš¢
->
size
(); i++)

358 
¥rštf
(
buf
, "%s%2x ", buf, 0xff&
¿w
[
i
]);

359 
¥rštf
(
buf
, "%s\n", buf);

360 
	gs
 +ğ
buf
;

361 
	gba£
 +ğ
š¢
->
size
();

362 
	gš¢
 = 
deco
.
decode
();

364  
	gs
;

367 şas 
	cSpVis™Ü
 : 
public
 
Vis™Ü
 {

368 
public
:

369 
SpVis™Ü
(
¥
::
SpPošt
* 
±
)

370 : 
Vis™Ü
(), 
ÿÎ_addr_
(0), 
±_
(
±
), 
u£_pc_
(
çl£
) { }

371 
vœtu®
 
vis™
(
Regi¡”AST
* 
r
) {

372 ià(
	gSpP¬£r
::
is_pc
(
r
->
g‘ID
())) {

373 
u£_pc_
 = 
Œue
;

374 
	gÿÎ_addr_
 = 
±_
->
block
()->
’d
();

377 
Add»ss
 
	grv®
 = 
±_
->
¢
()->
g‘_§ved_»g
(
r
->
g‘ID
());

378 
	gÿÎ_addr_
 = 
rv®
;

380 
	g¡ack_
.
push
(
ÿÎ_addr_
);

382 
vœtu®
 
vis™
(
Bš¬yFunùiÚ
* 
b
) {

383 
Add»ss
 
	gi1
 = 
¡ack_
.
tİ
();

384 
	g¡ack_
.
pİ
();

385 
Add»ss
 
	gi2
 = 
¡ack_
.
tİ
();

386 
	g¡ack_
.
pİ
();

388 ià(
	gb
->
isAdd
()) {

389 
	gÿÎ_addr_
 = 
i1
 + 
i2
;

390 } ià(
	gb
->
isMuÉly
()) {

391 
	gÿÎ_addr_
 = 
i1
 * 
i2
;

393 
as£¹
(0);

396 
	g¡ack_
.
push
(
ÿÎ_addr_
);

398 
vœtu®
 
vis™
(
ImmedŸ‹
* 
i
) {

399 
ResuÉ
 
	g»s
 = 
i
->
ev®
();

400 
	g»s
.
size
()) {

402 
ÿÎ_addr_
 =
»s
.
v®
.
u8v®
;

406 
ÿÎ_addr_
 =
»s
.
v®
.
u16v®
;

410 
ÿÎ_addr_
 =
»s
.
v®
.
u32v®
;

414 
ÿÎ_addr_
 =
»s
.
v®
.
u64v®
;

418 
	g¡ack_
.
push
(
ÿÎ_addr_
);

420 
vœtu®
 
vis™
(
D”eã»nû
* 
d
) {

421 
Add»ss
* 
	gaddr
 = (Add»ss*)
¡ack_
.
tİ
();

422 
	g¡ack_
.
pİ
();

423 
	gÿÎ_addr_
 = *
addr
;

424 
	g¡ack_
.
push
(
ÿÎ_addr_
);

427 
Add»ss
 
ÿÎ_addr
() const {

428  
	gÿÎ_addr_
;

430 
boŞ
 
u£_pc
() const {

431  
	gu£_pc_
;

433 
	g´iv©e
:

434 
¡d
::
¡ack
<
Add»ss
> 
¡ack_
;

435 
Add»ss
 
	gÿÎ_addr_
;

436 
	g¥
::
SpPošt
* 
±_
;

437 
boŞ
 
	gu£_pc_
;

441 
P©chFunùiÚ
*

442 
	gSpP¬£r
::
	$ÿÎ“
(
Pošt
* 
±
, 
boŞ
 
·r£_šdœeù
) {

446 
¥
::
SpPošt
* 
¥t
 = 
¡©ic_ÿ¡
<¥::SpPošt*>(
±
);

447 ià(
¥t
->
	`ÿÎ“
())  spt->callee();

450 
P©chFunùiÚ
* 
f
 = 
±
->
	`g‘C®Ëe
();

451 ià(
f
) {

452 
¥t
->
	`£t_ÿÎ“
(
f
);

453  
f
;

455 ià(
¥t
->
	`ÿÎ“
()) {

456  
¥t
->
	`ÿÎ“
();

460 ià(
·r£_šdœeù
) {

463 
In¡ruùiÚ
::
PŒ
 
š¢
 = 
¥t
->
	`¢
()->
	`g‘_Üig_ÿÎ_š¢
();

464 
Ex´essiÚ
::
PŒ
 
Œg
 = 
š¢
->
	`g‘CÚŒŞFlowT¬g‘
();

465 
Add»ss
 
ÿÎ_addr
 = 0;

466 ià(
Œg
) {

467 
SpVis™Ü
 
	`vis™Ü
(
¥t
);

468 
Œg
->
	`­¶y
(&
vis™Ü
);

469 
ÿÎ_addr
 = 
vis™Ü
.
	`ÿÎ_addr
();

470 
f
 = 
	`fšdFunùiÚ
(
ÿÎ_addr
);

471 ià(
f
) {

472 
¥t
->
	`£t_ÿÎ“
(
f
);

473  
f
;

477 
	`¥_´št
("CANNOT RESOLVE ADDR %lx, SKIP fÜ blob %lx", 
ÿÎ_addr
, 
¥t
->
	`¢
()->
	`buf
());

479 *
d
 = (*)(
¥t
->
	`¢
()->
	`g‘_§ved_»g
(
¼
->
	`g‘ID
()è+ 
di¥
);

480 
	`¥_´št
("RR: %s, [%lx+%lx]=>%lx", 
¼
->
	`g‘ID
().
	`Çme
().
	`c_¡r
(), 
¥t
->
	`¢
()->
	`g‘_§ved_»g
Ôr->g‘ID()), 
di¥
, *
d
);

481 
	`¥_´št
("ORIG CALL DUMP INSN (%d by‹s)- {", 
¥t
->
	`¢
()->
	`g‘_Üig_ÿÎ_š¢
()->
	`size
());

482 
	`¥_´št
("%s", 
	`dump_š¢
((*)
¥t
->
	`¢
()->
	`g‘_Üig_ÿÎ_š¢
()->
	`±r
(), s±->¢()->g‘_Üig_ÿÎ_š¢()->
	`size
()).
	`c_¡r
());

483 
	`¥_´št
("DUMP INSN - }");

485 
	`¥_´št
("DUMP INSN (%d by‹s)- {", 
¥t
->
	`¢
()->
	`size
());

486 
	`¥_´št
("%s", 
	`dump_š¢
((*)
¥t
->
	`¢
()->
	`buf
(), s±->¢()->
	`size
()).
	`c_¡r
());

487 
	`¥_´št
("DUMP INSN - }");

489  
NULL
;

492  
NULL
;

493 
	}
}

495 
	gSpP¬£r
::
	$g‘_äame
(* 
pc
, * 
¥
, * 
bp
) {

496 
IjMsg
* 
shm
 = (IjMsg*)
SpInjeùÜ
::
	`g‘_shm
(1986, (IjMsg));

497 *
pc
 = 
shm
->pc;

498 *
¥
 = 
shm
->sp;

499 *
bp
 = 
shm
->bp;

500 
	}
}

	@SpPayload.C

1 
	~"SpPaylßd.h
"

2 
	~"SpCÚ‹xt.h
"

3 
	~"SpPošt.h
"

4 
	~"SpUts.h
"

6 
usšg
 
	gph
::
Pošt
;

7 
usšg
 
	gph
::
Scİe
;

8 
usšg
 
	gph
::
P©chMgr
;

9 
usšg
 
	gph
::
P©chEdge
;

10 
usšg
 
	gph
::
P©chBlock
;

11 
usšg
 
	gph
::
P©chMgrPŒ
;

12 
usšg
 
	gph
::
P©chObjeù
;

13 
usšg
 
	gph
::
P©chFunùiÚ
;

15 
usšg
 
	g¥
::
SpPošt
;

16 
usšg
 
	g¥
::
SpChªÃl
;

17 
usšg
 
	g¥
::
Argum’tHªdË
;

18 
usšg
 
	g¥
::
SpIpcMgr
;

20 
Çme¥aû
 
	g¥
 {

21 
SpCÚ‹xt
* 
g_cÚ‹xt
;

26 
w¿µ”_befÜe
(
SpPošt
* 
±
, 
¥
::
PaylßdFunc_t
 
befÜe
) {

27 ià(!
SpIpcMgr
::
befÜe_’Œy
(
±
)) ;

28 
befÜe
(
±
);

33 
w¿µ”_aá”
(
SpPošt
* 
±
, 
¥
::
PaylßdFunc_t
 
aá”
) {

34 ià(!
SpIpcMgr
::
befÜe_ex™
(
±
)) ;

35 
aá”
(
±
);

40 
	$deçuÉ_befÜe
(
Pošt
* 
±
) {

41 
P©chFunùiÚ
* 
f
 = 
¥
::
	`ÿÎ“
(
±
);

42 ià(!
f
) ;

44 
¡ršg
 
ÿÎ“_Çme
 = 
f
->
	`Çme
();

45 
	`¥_´št
("EÁ” %s", 
ÿÎ“_Çme
.
	`c_¡r
());

47 
¥
::
	`´İ–
(
±
);

48 
	}
}

51 
	$deçuÉ_aá”
(
Pošt
* 
±
) {

52 
P©chFunùiÚ
* 
f
 = 
¥
::
	`ÿÎ“
(
±
);

53 ià(!
f
) ;

55 
¡ršg
 
ÿÎ“_Çme
 = 
f
->
	`Çme
();

56 
	`¥_´št
("L—v%s", 
ÿÎ“_Çme
.
	`c_¡r
());

57 
	}
}

60 
Çme¥aû
 
	g¥
 {

63 
P©chFunùiÚ
*

64 
ÿÎ“
(
ph
::
Pošt
* 
±
) {

65  
g_cÚ‹xt
->
ÿÎ“
(
±
);

70 
pİ_¬gum’t
(
ph
::
Pošt
* 
±
, 
Argum’tHªdË
* 
h
, 
size_t
 
size
) {

71  
	g¡©ic_ÿ¡
<
	gSpPošt
*>(
	g±
)->
¢
()->
pİ_¬gum’t
(
h
, 
size
);

76 
´İ–
(
ph
::
Pošt
* 
±
) {

79 
SpPošt
* 
¥t
 = 
¡©ic_ÿ¡
<
¥
::SpPošt*>(
±
);

80 ià(
	g¥t
->
´İag©ed
()) {

84 
P©chFunùiÚ
* 
	gf
 = 
ÿÎ“
(
±
);

85 ià(!
	gf
) ;

87 
	g¥
::
SpPrİ–Ër
::
±r
 
p
 = 
g_cÚ‹xt
->
š™_´İ–Ër
();

88 
	gp
->
go
(
f
, 
g_cÚ‹xt
, g_cÚ‹xt->
š™_befÜe
(), g_cÚ‹xt->
š™_aá”
(), 
±
);

89 
	g¥t
->
£t_´İag©ed
(
Œue
);

92 
	gArgum’tHªdË
::
Argum’tHªdË
(è: 
off£t
(0), 
num
(0) {}

95 
	gArgum’tHªdË
::
š£¹_buf
(
size_t
 
s
) {

96 * 
b
 = 
Ãw
 [
s
];

97 
	gbufs
.
push_back
(
b
);

98  
	gb
;

101 
	gArgum’tHªdË
::~
Argum’tHªdË
() {

102 
i
 = 0; 
	gi
 < 
	gbufs
.
size
(); i++è
d–‘e
 bufs[i];

106 
»tv®
(
¥
::
SpPošt
* 
±
) {

107  
±
->
¢
()->
g‘_»t_v®
();

111 
boŞ


112 
is_c_wr™e
(
SpPošt
* 
±
) {

113 
SpChªÃl
* 
	gc
 = 
±
->
chªÃl
();

116  (
	gc
 && c->
	grw
 =ğ
SP_WRITE
);

120 
boŞ


121 
is_c_»ad
(
SpPošt
* 
±
) {

122 
SpChªÃl
* 
	gc
 = 
±
->
chªÃl
();

124 ià(
ÿÎ“
(
±
)->
Çme
().
com·»
("accept") != 0)

125  (
c
 && c->
rw
 =ğ
SP_READ
 && 
¡¬t_Œacšg
(c->
fd
));

127  (
	gc
 && c->
	grw
 =ğ
SP_READ
);

131 
¡¬t_Œacšg
(
fd
) {

132 
	g¥
::
SpIpcMgr
* 
c_mgr
 = 
g_cÚ‹xt
->ipc_mgr();

133  
	gc_mgr
->
¡¬t_Œacšg
(
fd
);

	@SpPointMaker.h

1 #iâdeà
_SPPOINTMAKER_H_


2 
	#_SPPOINTMAKER_H_


	)

4 
	~"SpAg’tCommÚ.h
"

7 
Çme¥aû
 
	g¥
 {

8 şas 
	cSpPoštMak”
 : 
public
 
ph
::
PoštMak”
 {

9 
´Ùeùed
:

11 
vœtu®
 
ph
::
Pošt
*

12 
mkFuncPošt
(
ph
::
Pošt
::
Ty³
 
t
,

13 
ph
::
P©chMgrPŒ
 
m
,

14 
ph
::
P©chFunùiÚ
* 
f
) {

15  
Ãw
 
SpPošt
(
t
, 
m
, 
f
);

18 
vœtu®
 
	gph
::
Pošt
*

19 
mkFuncS™ePošt
(
ph
::
Pošt
::
Ty³
 
t
,

20 
ph
::
P©chMgrPŒ
 
m
,

21 
ph
::
P©chFunùiÚ
* 
f
,

22 
ph
::
P©chBlock
* 
b
) {

23  
Ãw
 
SpPošt
(
t
, 
m
, 
f
, 
b
);

26 
vœtu®
 
	gph
::
Pošt
*

27 
mkBlockPošt
(
ph
::
Pošt
::
Ty³
 
t
,

28 
ph
::
P©chMgrPŒ
 
m
,

29 
ph
::
P©chBlock
* 
b
,

30 
ph
::
P©chFunùiÚ
* 
f
) {

31  
Ãw
 
SpPošt
(
t
, 
m
, 
b
, 
f
);

33 
vœtu®
 
	gph
::
Pošt
*

34 
mkIn¢Pošt
(
ph
::
Pošt
::
Ty³
 
t
,

35 
ph
::
P©chMgrPŒ
 
m
,

36 
ph
::
P©chBlock
* 
b
,

37 
Dynš¡
::
Add»ss
 
a
,

38 
š
::
In¡ruùiÚ
::
PŒ
 
i
,

39 
ph
::
P©chFunùiÚ
 *
f
) {

40  
Ãw
 
SpPošt
(
t
, 
m
, 
b
, 
a
, 
i
, 
f
);

42 
vœtu®
 
	gph
::
Pošt
*

43 
mkEdgePošt
(
ph
::
Pošt
::
Ty³
 
t
,

44 
ph
::
P©chMgrPŒ
 
m
,

45 
ph
::
P©chEdge
* 
e
,

46 
ph
::
P©chFunùiÚ
* 
f
) {

47  
Ãw
 
SpPošt
(
t
, 
m
, 
e
, 
f
);

	@SpPropeller.C

1 
	~"SpPrİ–Ër.h
"

2 
	~"SpCÚ‹xt.h
"

3 
	~"SpSn³t.h
"

4 
	~"SpUts.h
"

6 
usšg
 
	g¥
::
SpCÚ‹xt
;

7 
usšg
 
	g¥
::
SpPrİ–Ër
;

9 
usšg
 
	gph
::
Pošt
;

10 
usšg
 
	gph
::
Scİe
;

11 
usšg
 
	gph
::
P©ch”
;

12 
usšg
 
	gph
::
Sn³t
;

13 
usšg
 
	gph
::
P©chMgr
;

14 
usšg
 
	gph
::
P©chBlock
;

15 
usšg
 
	gph
::
P©chMgrPŒ
;

16 
usšg
 
	gph
::
P©chFunùiÚ
;

17 
usšg
 
	gph
::
PushBackCommªd
;

19 
Çme¥aû
 
	g¥
 {

21 
	gSpPrİ–Ër
::
SpPrİ–Ër
() {

24 
SpPrİ–Ër
::
±r


25 
SpPrİ–Ër
::
ü—‹
() {

26  
±r
(
Ãw
 
SpPrİ–Ër
);

33 
boŞ


34 
	gSpPrİ–Ër
::
go
(
P©chFunùiÚ
* 
func
, 
SpCÚ‹xt
* 
cÚ‹xt
, 
PaylßdFunc
 
befÜe
,

35 
PaylßdFunc
 
aá”
, 
Pošt
* 
±
) {

36 #iâdeà
SP_RELEASE


37 
¥_debug
("START PROPELLING -…rİ–ØÿÎ“ oàfunùiÚ %s", 
func
->
Çme
().
c_¡r
());

40 
Pošts
 
	g±s
;

41 
P©chMgrPŒ
 
	gmgr
 = 
cÚ‹xt
->
mgr
();

42 
P©chFunùiÚ
* 
	gcur_func
 = 
NULL
;

43 ià(
	g±
) {

44 
¥_debug
("POINT VALID - %s", 
func
->
Çme
().
c_¡r
());

45 
	gcur_func
 = 
cÚ‹xt
->
·r£r
()->
fšdFunùiÚ
(
func
->
Çme
());

47 
	gcur_func
 = 
cÚ‹xt
->
·r£r
()->
fšdFunùiÚ
(
func
->
Çme
());

50 
Ãxt_pošts
(
cur_func
, 
mgr
, 
±s
);

54 
	gph
::
P©ch”
 
·tch”
(
mgr
);

55 
	gi
 = 0; i < 
	g±s
.
size
(); i++) {

56 
Pošt
* 
	g±
 = 
±s
[
i
];

60 
P©chFunùiÚ
* 
	gÿÎ“
 = 
cÚ‹xt
->
·r£r
()->
ÿÎ“
(
±
);

61 #iâdeà
SP_RELEASE


62 ià(
	gÿÎ“
) {

63 
¥_debug
("POINT - instrumenting direct call‡t %lxo function %s",

64 
±
->
block
()->
Ï¡
(), 
ÿÎ“
->
Çme
().
c_¡r
());

66 
¥_debug
("POINT - in¡rum’tšg indœeù c®È© %lx", 
±
->
block
()->
Ï¡
());

69 
	gSpSn³t
::
±r
 
¥_¢
 = 
SpSn³t
::
ü—‹
(
ÿÎ“
, 
±
, 
cÚ‹xt
, 
befÜe
, 
aá”
);

70 
	gSn³t
<
	gSpSn³t
::
±r
>::
PŒ
 
¢
 = 
Sn³t
<
SpSn³t
::±r>::
ü—‹
(
¥_¢
);

71 
	g·tch”
.
add
(
PushBackCommªd
::
ü—‹
(
±
, 
¢
));

73 
	g·tch”
.
comm™
();

74 #iâdeà
SP_RELEASE


75 
¥_debug
("FINISH PROPELLING - %lu c®Ëe oàfunùiÚ % ¬š¡rum’‹d", 
±s
.
size
(), 
func
->
Çme
().
c_¡r
());

77  
	gŒue
;

82 
	gSpPrİ–Ër
::
Ãxt_pošts
(
P©chFunùiÚ
* 
cur_func
, 
P©chMgrPŒ
 
mgr
, 
Pošts
& 
±s
) {

83 
Scİe
 
scİe
(
cur_func
);

84 
	gmgr
->
fšdPošts
(
scİe
, 
Pošt
::
P»C®l
, 
back_š£¹”
(
±s
));

	@SpSnippet.C

1 
	~"SpEv’t.h
"

2 
	~"SpP¬£r.h
"

3 
	~"SpCÚ‹xt.h
"

4 
	~"SpSn³t.h
"

5 
	~"SpPošt.h
"

6 
	~"SpUts.h
"

7 
	~"SpObjeù.h
"

9 
usšg
 
	gph
::
Pošt
;

10 
usšg
 
	gdt
::
Add»ss
;

11 
usšg
 
	gph
::
P©chBlock
;

12 
usšg
 
	gph
::
P©chFunùiÚ
;

14 
Çme¥aû
 
	g¥
 {

18 
	gSpSn³t
::
SpSn³t
(
P©chFunùiÚ
* 
f
,

19 
Pošt
* 
±
,

20 
SpCÚ‹xt
* 
c
,

21 
PaylßdFunc
 
befÜe
,

22 
PaylßdFunc
 
aá”
)

23 : 
func_
(
f
), 
pošt_
(
±
), 
cÚ‹xt_
(
c
), 
befÜe_
(
befÜe
), 
aá”_
(
aá”
),

24 
blob_size_
(0), 
¥ršg_size_
(0), 
¥ršg_blk_
(
NULL
), 
»®loc_
(
çl£
) {

26 
	gph
::
P©chMgrPŒ
 
mgr
 = 
c
->mgr();

27 
	gph
::
AddrS·û
* 
as
 = 
mgr
->as();

31 
	gblob_
 = (*)
as
->
m®loc
(
±
->
obj
(), 1024,

32 
¡©ic_ÿ¡
<
¥
::
SpObjeù
*>(
±
->
obj
())->
lßd_addr
());

36 
	gSpSn³t
::~
SpSn³t
() {

37 ià(!
»®loc_
è
ä“
(
blob_
);

40 * 
	gSpSn³t
::
»®loc
() {

41 * 
buf
 = 
NULL
;

42 
	g»®loc_
 = 
Œue
;

44  
	gbuf
;

58 
	gSpSn³t
::
blob
(
Add»ss
 
»t_addr
, 
boŞ
 
»loc
, boŞ 
¥ršg
) {

59 
as£¹
(
cÚ‹xt_
);

60 
	g»t_addr_
 = 
»t_addr
;

63 ià(
	gblob_size_
 > 0) {

64  
	gblob_
;

68 ià(
	g»loc
) {

69 
P©chBlock
* 
	gblk
 = 
NULL
;

70 
	gblk
 = 
pošt_
->
block
();

71 
	gblob_size_
 +ğ
»loc_block
(
blk
, 
blob_
, 
blob_size_
);

76 
	gblob_size_
 +ğ
em™_§ve
(
blob_
, 
blob_size_
, 
»loc
);

79 
	g·¿m_func
 = 0;

80 
	gÿÎed_func
 = ()
befÜe_
;

81 ià(
	gcÚ‹xt_
->
®low_c
()) {

82 
	g·¿m_func
 = ()
befÜe_
;

83 
	gÿÎed_func
 = ()
cÚ‹xt_
->
w¿µ”_befÜe
();

85 
	gblob_size_
 +ğ
em™_·ss_·¿m
(()
pošt_
, 
·¿m_func
, 
blob_
, 
blob_size_
);

86 
	gblob_size_
 +ğ
em™_ÿÎ_abs
(
ÿÎed_func
, 
blob_
, 
blob_size_
, 
Œue
);

89 
	gblob_size_
 +ğ
em™_»¡Üe
(
blob_
, 
blob_size_
, 
»loc
);

96 ià(!
	g»t_addr
 && 
	gfunc_
) {

98 
	gblob_size_
 +ğ
em™_jump_abs
(()
func_
->
addr
(), 
blob_
, 
blob_size_
);

99 
	gEXIT
;

100 } ià(
	g»t_addr
 && 
	gfunc_
) {

102 
	gblob_size_
 +ğ
em™_ÿÎ_abs
(()
func_
->
addr
(), 
blob_
, 
blob_size_
, 
çl£
);

105 
	gblob_size_
 +ğ
em™_ÿÎ_Üig
(()
pošt_
->
block
()->
Ï¡
(),

106 
Üig_ÿÎ_š¢_
->
size
(), 
blob_
, 
blob_size_
);

109 ià(
	gcÚ‹xt_
->
®low_c
(è|| 
	gaá”_
) {

111 
	gblob_size_
 +ğ
em™_§ve
(
blob_
, 
blob_size_
, 
»loc
);

114 
	g·¿m_func
 = 0;

115 
	gÿÎed_func
 = ()
aá”_
;

116 ià(
	gcÚ‹xt_
->
®low_c
()) {

117 
	g·¿m_func
 = ()
aá”_
;

118 
	gÿÎed_func
 = ()
cÚ‹xt_
->
w¿µ”_aá”
();

120 
	gblob_size_
 +ğ
em™_·ss_·¿m
(()
pošt_
, 
·¿m_func
, 
blob_
, 
blob_size_
);

121 
	gblob_size_
 +ğ
em™_ÿÎ_abs
(
ÿÎed_func
, 
blob_
, 
blob_size_
, 
Œue
);

124 
	gblob_size_
 +ğ
em™_»¡Üe
(
blob_
, 
blob_size_
, 
»loc
);

128 
	gblob_size_
 +ğ
em™_jump_abs
(
»t_addr
, 
blob_
, 
blob_size_
);

130 
	gEXIT
:

132 #iâdeà
SP_RELEASE


133 
¥_debug
("DUMP PATCH AREA (%lu by‹sèfÜ…ošˆ%lx - {", 
blob_size_
, 
pošt_
->
block
()->
Ï¡
());

134 
¥_debug
("%s", 
cÚ‹xt_
->
·r£r
()->
dump_š¢
((*)
blob_
, 
blob_size_
).
c_¡r
());

135 
¥_debug
("}");

138  
	gblob_
;

142 
size_t


143 
	gSpSn³t
::
»loc_block
(
P©chBlock
* 
blk
, * 
buf
, 
size_t
 
off£t
) {

144 * 
	gp
 = 
buf
 + 
off£t
;

145 
Add»ss
 
	gÿÎ_addr
 = 
blk
->
Ï¡
();

147 
	gP©chBlock
::
In¢s
 
š¢s
;

148 
	gblk
->
g‘In¢s
(
š¢s
);

149 
	gP©chBlock
::
In¢s
::
™”©Ü
 
i
 = 
š¢s
.
begš
(); 
	gi
 !ğš¢s.
’d
(); i++) {

150 
usšg
 
Çme¥aû
 
	gDynš¡
::
In¡ruùiÚAPI
;

152 
Add»ss
 
	ga
 = 
i
->
fœ¡
;

153 
	gIn¡ruùiÚ
::
PŒ
 
š¢
 = 
i
->
£cÚd
;

154 
	gp
 +ğ
»loc_š¢
(
a
, 
š¢
, 
ÿÎ_addr
, 
p
);

157  (
	gp
 - (
	gbuf
 + 
	goff£t
));

169 
P©chBlock
*

170 
	gSpSn³t
::
¥ršg_blk
() {

171 ià(
¥ršg_blk_
)  spring_blk_;

173 
size_t
 
	gmš_¥ršgblk_size
 = 
jump_abs_size
() * 2;

174 
P©chBlock
* 
	gÿÎblk
 = 
pošt_
->
block
();

177 
	gaá”_jmp
 = 
ÿÎblk
->
¡¬t
() + 2;

178 
boŞ
 
	gdÚe
 = 
çl£
;

181 
P©chBlock
* 
	g¥ršgblk
 = 
NULL
;

182 
	gph
::
P©chObjeù
* 
obj
 = 
ÿÎblk
->obj();

184 
usšg
 
Çme¥aû
 
	gDynš¡
::
P¬£API
;

185 
CodeObjeù
* 
	gco
 = 
obj
->
co
();

186 
CodeSourû
* 
	gcs
 = 
co
->
cs
();

187 
	g¡d
::
veùÜ
<
CodeRegiÚ
*> 
»giÚs
 = 
cs
->regions();

190 
	guµ”
 = 127 + 
aá”_jmp
 - 
jump_abs_size
();

191 
	glow”
 = -128 + 
aá”_jmp
 - 
jump_abs_size
();

193 
	gi
 = 0; i < 
	g»giÚs
.
size
(); i++) {

194 
CodeRegiÚ
* 
	gü
 = 
»giÚs
[
i
];

195 ià((
	glow”
 <ğ()
ü
->
low
(è&& ()ü->low(è< 
uµ”
) ||

196 (()
ü
->
low
(è<ğ
low”
 && 
uµ”
 < ()ü->
high
()) ||

197 (
low”
 <ğ()
ü
->
high
(è&& ()ü->high(è< 
uµ”
)

200 
Add»ss
 
¥ª_addr
 = 
low”
;

202 
	g£t
<
	gBlock
*> 
	gblks
;

203 
	gco
->
fšdBlocks
(
ü
, 
¥ª_addr
, 
blks
);

204 ià(
	gblks
.
size
() == 0) {

205 ++
¥ª_addr
;

208 
Block
* 
	gb
;

209 
	g£t
<
	gBlock
*>::
™”©Ü
 
bi
 = 
blks
.
begš
(); 
	gbi
 !ğblks.
’d
(); bi++) {

210 
	gb
 = *
bi
;

212 
size_t
 
	g»l
 = 
b
->
¡¬t
(è+ 
jump_abs_size
(è- 
aá”_jmp
;

213 ià(!
	g¥
::
is_di¥8
(
»l
)) {

214 
¥ª_addr
 = 
b
->
’d
();

217 
size_t
 
	gs
 = 
b
->
Ï¡In¢Addr
(è- b->
¡¬t
();

218 ià(
	gs
 < 
	gmš_¥ršgblk_size
) {

219 
	g¥ª_addr
 = 
b
->
’d
();

222 
P©chBlock
* 
	gpb
 = 
obj
->
g‘Block
(
b
);

225 ià(
	gpb
->
cÚšsC®l
()) {

226 
	g¥ª_addr
 = 
b
->
’d
();

231 ià(
	gcÚ‹xt_
->
š_¥ršg_£t
(
pb
)) {

232 
	g¥ª_addr
 = 
b
->
’d
();

235 
	g¥ršgblk
 = 
pb
;

236 
	gcÚ‹xt_
->
add_¥ršg
(
pb
);

237 
	gdÚe
 = 
Œue
;

239 } ()
	g¥ª_addr
 < 
	guµ”
);

240 ià(
	gdÚe
) ;

244 
	g¥ršg_blk_
 = 
¥ršgblk
;

245  
	g¥ršgblk
;

250 
	gSpSn³t
::
¥ršg
(
Add»ss
 
»t_addr
) {

251 
ph
::
P©chMgrPŒ
 
mgr
 = 
cÚ‹xt_
->mgr();

252 
	gph
::
AddrS·û
* 
as
 = 
mgr
->as();

253 
	g¥ršg_
 = (*)
as
->
m®loc
(
pošt_
->
obj
(), 1024, 
¡©ic_ÿ¡
<
¥
::
SpObjeù
*>Õošt_->obj())->
lßd_addr
());

254 
	g¥ršg_size_
 = 0;

257 
	g¥ršg_size_
 +ğ
»loc_block
(
¥ršg_blk_
, 
¥ršg_
, 0);

260 
	g¥ršg_size_
 +ğ
em™_jump_abs
(
»t_addr
, 
¥ršg_
, 
¥ršg_size_
);

262 #iâdeà
SP_RELEASE


263 
¥_debug
("DUMP RELOC SPRING INSNS (%lu by‹sèfÜ…ošˆ%lx- {", 
¥ršg_size_
, 
pošt_
->
block
()->
Ï¡
());

264 
¥_debug
("%s", 
cÚ‹xt_
->
·r£r
()->
dump_š¢
((*)
¥ršg_
, 
¥ršg_size_
).
c_¡r
());

265 
¥_debug
("}");

267  
	g¥ršg_
;

	@/usr/include/sys/wait.h

24 #iâdef 
_SYS_WAIT_H


25 
	#_SYS_WAIT_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	~<sigÇl.h
>

32 
	~<sys/»sourû.h
>

35 #ià!
defšed
 
_STDLIB_H
 || !defšed 
__USE_XOPEN


38 
	~<b™s/wa™æags.h
>

40 #ifdef 
__USE_BSD


45 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


46 
	#__WAIT_INT
(
¡©us
) \

47 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

48 { .
__š
 = (
¡©us
è}).
__i
))

	)

50 
	#__WAIT_INT
(
¡©us
è(*(
__cÚ¡
 *è&(¡©us))

	)

58 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


59 
	#__WAIT_STATUS
 *

	)

60 
	#__WAIT_STATUS_DEFN
 *

	)

65 
wa™
 *
	m__u±r
;

66 *
	m__Œ
;

67 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

68 
	#__WAIT_STATUS_DEFN
 *

	)

73 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

74 
	#__WAIT_STATUS
 *

	)

75 
	#__WAIT_STATUS_DEFN
 *

	)

80 
	~<b™s/wa™¡©us.h
>

82 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
(
	`__WAIT_INT
(¡©us))

	)

83 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
(
	`__WAIT_INT
(¡©us))

	)

84 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
(
	`__WAIT_INT
(¡©us))

	)

85 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
(
	`__WAIT_INT
(¡©us))

	)

86 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
(
	`__WAIT_INT
(¡©us))

	)

87 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
(
	`__WAIT_INT
(¡©us))

	)

88 #ifdeà
__WIFCONTINUED


89 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
(
	`__WAIT_INT
(¡©us))

	)

93 #ifdef 
__USE_BSD


94 
	#WCOREFLAG
 
__WCOREFLAG


	)

95 
	#WCOREDUMP
(
¡©us
è
	`__WCOREDUMP
(
	`__WAIT_INT
(¡©us))

	)

96 
	#W_EXITCODE
(
»t
, 
sig
è
	`__W_EXITCODE
Ô‘, sig)

	)

97 
	#W_STOPCODE
(
sig
è
	`__W_STOPCODE
(sig)

	)

101 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


104 
	mP_ALL
,

105 
	mP_PID
,

106 
	mP_PGID


107 } 
	tidty³_t
;

116 
__pid_t
 
wa™
 (
__WAIT_STATUS
 
__¡©_loc
);

118 #ifdef 
__USE_BSD


120 
	#WAIT_ANY
 (-1è

	)

121 
	#WAIT_MYPGRP
 0

	)

139 
__pid_t
 
wa™pid
 (__pid_ˆ
__pid
, *
__¡©_loc
, 
__İtiÚs
);

141 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


142 
	#__Ãed_sigšfo_t


	)

143 
	~<b™s/sigšfo.h
>

155 
wa™id
 (
idty³_t
 
__idty³
, 
__id_t
 
__id
, 
sigšfo_t
 *
__šfİ
,

156 
__İtiÚs
);

159 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


162 
	gru§ge
;

169 
__pid_t
 
	$wa™3
 (
__WAIT_STATUS
 
__¡©_loc
, 
__İtiÚs
,

170 
ru§ge
 * 
__u§ge
è
__THROW
;

173 #ifdeà
__USE_BSD


176 
ru§ge
;

179 
__pid_t
 
	$wa™4
 (
__pid_t
 
__pid
, 
__WAIT_STATUS
 
__¡©_loc
, 
__İtiÚs
,

180 
ru§ge
 *
__u§ge
è
__THROW
;

184 
__END_DECLS


	@/usr/include/bits/siginfo.h

20 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
__Ãed_sigšfo_t
 \

21 && !
defšed
 
	g__Ãed_sigev’t_t


25 
	~<b™s/wÜdsize.h
>

27 #ià(!
defšed
 
__have_sigv®_t
 \

28 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
 \

29 || 
defšed
 
	g__Ãed_sigev’t_t
))

30 
	#__have_sigv®_t
 1

	)

33 
	usigv®


35 
	msiv®_št
;

36 *
	msiv®_±r
;

37 } 
	tsigv®_t
;

40 #ià(!
defšed
 
__have_sigšfo_t
 \

41 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
))

42 
	#__have_sigšfo_t
 1

	)

44 
	#__SI_MAX_SIZE
 128

	)

45 #ià
__WORDSIZE
 == 64

46 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 4)

	)

48 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 3)

	)

51 
	ssigšfo


53 
	msi_signo
;

54 
	msi_”ºo
;

56 
	msi_code
;

60 
	m_·d
[
__SI_PAD_SIZE
];

65 
__pid_t
 
	msi_pid
;

66 
__uid_t
 
	msi_uid
;

67 } 
	m_kl
;

72 
	msi_tid
;

73 
	msi_ov”run
;

74 
sigv®_t
 
	msi_sigv®
;

75 } 
	m_tim”
;

80 
__pid_t
 
	msi_pid
;

81 
__uid_t
 
	msi_uid
;

82 
sigv®_t
 
	msi_sigv®
;

83 } 
	m_¹
;

88 
__pid_t
 
	msi_pid
;

89 
__uid_t
 
	msi_uid
;

90 
	msi_¡©us
;

91 
__şock_t
 
	msi_utime
;

92 
__şock_t
 
	msi_¡ime
;

93 } 
	m_sigchld
;

98 *
	msi_addr
;

99 } 
	m_sigçuÉ
;

104 
	msi_bªd
;

105 
	msi_fd
;

106 } 
	m_sigpŞl
;

107 } 
	m_sif›lds
;

108 } 
	tsigšfo_t
;

112 
	#si_pid
 
_sif›lds
.
_kl
.
si_pid


	)

113 
	#si_uid
 
_sif›lds
.
_kl
.
si_uid


	)

114 
	#si_tim”id
 
_sif›lds
.
_tim”
.
si_tid


	)

115 
	#si_ov”run
 
_sif›lds
.
_tim”
.
si_ov”run


	)

116 
	#si_¡©us
 
_sif›lds
.
_sigchld
.
si_¡©us


	)

117 
	#si_utime
 
_sif›lds
.
_sigchld
.
si_utime


	)

118 
	#si_¡ime
 
_sif›lds
.
_sigchld
.
si_¡ime


	)

119 
	#si_v®ue
 
_sif›lds
.
_¹
.
si_sigv®


	)

120 
	#si_št
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_št


	)

121 
	#si_±r
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_±r


	)

122 
	#si_addr
 
_sif›lds
.
_sigçuÉ
.
si_addr


	)

123 
	#si_bªd
 
_sif›lds
.
_sigpŞl
.
si_bªd


	)

124 
	#si_fd
 
_sif›lds
.
_sigpŞl
.
si_fd


	)

131 
	mSI_ASYNCNL
 = -60,

132 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

133 
	mSI_TKILL
 = -6,

134 
	#SI_TKILL
 
SI_TKILL


	)

135 
	mSI_SIGIO
,

136 
	#SI_SIGIO
 
SI_SIGIO


	)

137 
	mSI_ASYNCIO
,

138 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

139 
	mSI_MESGQ
,

140 
	#SI_MESGQ
 
SI_MESGQ


	)

141 
	mSI_TIMER
,

142 
	#SI_TIMER
 
SI_TIMER


	)

143 
	mSI_QUEUE
,

144 
	#SI_QUEUE
 
SI_QUEUE


	)

145 
	mSI_USER
,

146 
	#SI_USER
 
SI_USER


	)

147 
	mSI_KERNEL
 = 0x80

148 
	#SI_KERNEL
 
SI_KERNEL


	)

155 
	mILL_ILLOPC
 = 1,

156 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

157 
	mILL_ILLOPN
,

158 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

159 
	mILL_ILLADR
,

160 
	#ILL_ILLADR
 
ILL_ILLADR


	)

161 
	mILL_ILLTRP
,

162 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

163 
	mILL_PRVOPC
,

164 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

165 
	mILL_PRVREG
,

166 
	#ILL_PRVREG
 
ILL_PRVREG


	)

167 
	mILL_COPROC
,

168 
	#ILL_COPROC
 
ILL_COPROC


	)

169 
	mILL_BADSTK


170 
	#ILL_BADSTK
 
ILL_BADSTK


	)

176 
	mFPE_INTDIV
 = 1,

177 
	#FPE_INTDIV
 
FPE_INTDIV


	)

178 
	mFPE_INTOVF
,

179 
	#FPE_INTOVF
 
FPE_INTOVF


	)

180 
	mFPE_FLTDIV
,

181 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

182 
	mFPE_FLTOVF
,

183 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

184 
	mFPE_FLTUND
,

185 
	#FPE_FLTUND
 
FPE_FLTUND


	)

186 
	mFPE_FLTRES
,

187 
	#FPE_FLTRES
 
FPE_FLTRES


	)

188 
	mFPE_FLTINV
,

189 
	#FPE_FLTINV
 
FPE_FLTINV


	)

190 
	mFPE_FLTSUB


191 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

197 
	mSEGV_MAPERR
 = 1,

198 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

199 
	mSEGV_ACCERR


200 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

206 
	mBUS_ADRALN
 = 1,

207 
	#BUS_ADRALN
 
BUS_ADRALN


	)

208 
	mBUS_ADRERR
,

209 
	#BUS_ADRERR
 
BUS_ADRERR


	)

210 
	mBUS_OBJERR


211 
	#BUS_OBJERR
 
BUS_OBJERR


	)

217 
	mTRAP_BRKPT
 = 1,

218 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

219 
	mTRAP_TRACE


220 
	#TRAP_TRACE
 
TRAP_TRACE


	)

226 
	mCLD_EXITED
 = 1,

227 
	#CLD_EXITED
 
CLD_EXITED


	)

228 
	mCLD_KILLED
,

229 
	#CLD_KILLED
 
CLD_KILLED


	)

230 
	mCLD_DUMPED
,

231 
	#CLD_DUMPED
 
CLD_DUMPED


	)

232 
	mCLD_TRAPPED
,

233 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

234 
	mCLD_STOPPED
,

235 
	#CLD_STOPPED
 
CLD_STOPPED


	)

236 
	mCLD_CONTINUED


237 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

243 
	mPOLL_IN
 = 1,

244 
	#POLL_IN
 
POLL_IN


	)

245 
	mPOLL_OUT
,

246 
	#POLL_OUT
 
POLL_OUT


	)

247 
	mPOLL_MSG
,

248 
	#POLL_MSG
 
POLL_MSG


	)

249 
	mPOLL_ERR
,

250 
	#POLL_ERR
 
POLL_ERR


	)

251 
	mPOLL_PRI
,

252 
	#POLL_PRI
 
POLL_PRI


	)

253 
	mPOLL_HUP


254 
	#POLL_HUP
 
POLL_HUP


	)

257 #undeà
__Ãed_sigšfo_t


261 #ià(
defšed
 
_SIGNAL_H
 || defšed 
__Ãed_sigev’t_t
) \

262 && !
defšed
 
	g__have_sigev’t_t


263 
	#__have_sigev’t_t
 1

	)

266 
	#__SIGEV_MAX_SIZE
 64

	)

267 #ià
__WORDSIZE
 == 64

268 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 4)

	)

270 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 3)

	)

273 
	ssigev’t


275 
sigv®_t
 
	msigev_v®ue
;

276 
	msigev_signo
;

277 
	msigev_nÙify
;

281 
	m_·d
[
__SIGEV_PAD_SIZE
];

285 
__pid_t
 
	m_tid
;

289 (*
	m_funùiÚ
è(
	msigv®_t
);

290 *
	m_©Œibu‹
;

291 } 
	m_sigev_th»ad
;

292 } 
	m_sigev_un
;

293 } 
	tsigev’t_t
;

296 
	#sigev_nÙify_funùiÚ
 
_sigev_un
.
_sigev_th»ad
.
_funùiÚ


	)

297 
	#sigev_nÙify_©Œibu‹s
 
_sigev_un
.
_sigev_th»ad
.
_©Œibu‹


	)

302 
	mSIGEV_SIGNAL
 = 0,

303 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

304 
	mSIGEV_NONE
,

305 
	#SIGEV_NONE
 
SIGEV_NONE


	)

306 
	mSIGEV_THREAD
,

307 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

309 
	mSIGEV_THREAD_ID
 = 4

310 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/waitflags.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


26 
	#WNOHANG
 1

	)

27 
	#WUNTRACED
 2

	)

30 
	#WSTOPPED
 2

	)

31 
	#WEXITED
 4

	)

32 
	#WCONTINUED
 8

	)

33 
	#WNOWAIT
 0x01000000

	)

35 
	#__WNOTHREAD
 0x20000000

	)

37 
	#__WALL
 0x40000000

	)

38 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


29 
	#__WEXITSTATUS
(
¡©us
è(((¡©usè& 0xff00è>> 8)

	)

32 
	#__WTERMSIG
(
¡©us
è((¡©usè& 0x7f)

	)

35 
	#__WSTOPSIG
(
¡©us
è
	`__WEXITSTATUS
(¡©us)

	)

38 
	#__WIFEXITED
(
¡©us
è(
	`__WTERMSIG
(¡©usè=ğ0)

	)

41 
	#__WIFSIGNALED
(
¡©us
) \

42 (((sigÃd è(((
¡©us
è& 0x7fè+ 1è>> 1è> 0)

	)

45 
	#__WIFSTOPPED
(
¡©us
è(((¡©usè& 0xffè=ğ0x7f)

	)

49 #ifdeà
WCONTINUED


50 
	#__WIFCONTINUED
(
¡©us
è((¡©usè=ğ
__W_CONTINUED
)

	)

54 
	#__WCOREDUMP
(
¡©us
è((¡©usè& 
__WCOREFLAG
)

	)

57 
	#__W_EXITCODE
(
»t
, 
sig
è(Ô‘è<< 8 | (sig))

	)

58 
	#__W_STOPCODE
(
sig
è((sigè<< 8 | 0x7f)

	)

59 
	#__W_CONTINUED
 0xffff

	)

60 
	#__WCOREFLAG
 0x80

	)

63 #ifdef 
__USE_BSD


65 
	~<’dŸn.h
>

67 
	uwa™


69 
	mw_¡©us
;

72 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


73 
	m__w_‹rmsig
:7;

74 
	m__w_cÜedump
:1;

75 
	m__w_»tcode
:8;

78 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


80 
	m__w_»tcode
:8;

81 
	m__w_cÜedump
:1;

82 
	m__w_‹rmsig
:7;

84 } 
	m__wa™_‹rmš©ed
;

87 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


88 
	m__w_¡İv®
:8;

89 
	m__w_¡İsig
:8;

92 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


94 
	m__w_¡İsig
:8;

95 
	m__w_¡İv®
:8;

97 } 
	m__wa™_¡İ³d
;

100 
	#w_‹rmsig
 
__wa™_‹rmš©ed
.
__w_‹rmsig


	)

101 
	#w_cÜedump
 
__wa™_‹rmš©ed
.
__w_cÜedump


	)

102 
	#w_»tcode
 
__wa™_‹rmš©ed
.
__w_»tcode


	)

103 
	#w_¡İsig
 
__wa™_¡İ³d
.
__w_¡İsig


	)

104 
	#w_¡İv®
 
__wa™_¡İ³d
.
__w_¡İv®


	)

	@/usr/include/features.h

20 #iâdef 
_FEATURES_H


21 
	#_FEATURES_H
 1

	)

93 #undeà
__USE_ISOC99


94 #undeà
__USE_POSIX


95 #undeà
__USE_POSIX2


96 #undeà
__USE_POSIX199309


97 #undeà
__USE_POSIX199506


98 #undeà
__USE_XOPEN


99 #undeà
__USE_XOPEN_EXTENDED


100 #undeà
__USE_UNIX98


101 #undeà
__USE_XOPEN2K


102 #undeà
__USE_LARGEFILE


103 #undeà
__USE_LARGEFILE64


104 #undeà
__USE_FILE_OFFSET64


105 #undeà
__USE_BSD


106 #undeà
__USE_SVID


107 #undeà
__USE_MISC


108 #undeà
__USE_ATFILE


109 #undeà
__USE_GNU


110 #undeà
__USE_REENTRANT


111 #undeà
__USE_FORTIFY_LEVEL


112 #undeà
__FAVOR_BSD


113 #undeà
__KERNEL_STRICT_NAMES


117 #iâdeà
_LOOSE_KERNEL_NAMES


118 
	#__KERNEL_STRICT_NAMES


	)

122 
	#__USE_ANSI
 1

	)

131 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


132 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

133 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

135 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

140 #ià
defšed
 
_BSD_SOURCE
 && \

141 !(
defšed
 
	g_POSIX_SOURCE
 || defšed 
	g_POSIX_C_SOURCE
 || \

142 
defšed
 
	g_XOPEN_SOURCE
 || defšed 
	g_XOPEN_SOURCE_EXTENDED
 || \

143 
defšed
 
	g_GNU_SOURCE
 || defšed 
	g_SVID_SOURCE
)

144 
	#__FAVOR_BSD
 1

	)

148 #ifdeà
_GNU_SOURCE


149 #undeà
_ISOC99_SOURCE


150 
	#_ISOC99_SOURCE
 1

	)

151 #undeà
_POSIX_SOURCE


152 
	#_POSIX_SOURCE
 1

	)

153 #undeà
_POSIX_C_SOURCE


154 
	#_POSIX_C_SOURCE
 200112L

	)

155 #undeà
_XOPEN_SOURCE


156 
	#_XOPEN_SOURCE
 600

	)

157 #undeà
_XOPEN_SOURCE_EXTENDED


158 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

159 #undeà
_LARGEFILE64_SOURCE


160 
	#_LARGEFILE64_SOURCE
 1

	)

161 #undeà
_BSD_SOURCE


162 
	#_BSD_SOURCE
 1

	)

163 #undeà
_SVID_SOURCE


164 
	#_SVID_SOURCE
 1

	)

165 #undeà
_ATFILE_SOURCE


166 
	#_ATFILE_SOURCE
 1

	)

171 #ià(!
defšed
 
__STRICT_ANSI__
 && !defšed 
_ISOC99_SOURCE
 && \

172 !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 && \

173 !
defšed
 
	g_XOPEN_SOURCE
 && !defšed 
	g_XOPEN_SOURCE_EXTENDED
 && \

174 !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
)

175 
	#_BSD_SOURCE
 1

	)

176 
	#_SVID_SOURCE
 1

	)

183 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

184 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

185 
	#__USE_ISOC99
 1

	)

190 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

191 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

192 
	#_POSIX_SOURCE
 1

	)

193 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

194 
	#_POSIX_C_SOURCE
 2

	)

195 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

196 
	#_POSIX_C_SOURCE
 199506L

	)

198 
	#_POSIX_C_SOURCE
 200112L

	)

202 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


203 
	#__USE_POSIX
 1

	)

206 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


207 
	#__USE_POSIX2
 1

	)

210 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

211 
	#__USE_POSIX199309
 1

	)

214 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

215 
	#__USE_POSIX199506
 1

	)

218 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

219 
	#__USE_XOPEN2K
 1

	)

222 #ifdef 
_XOPEN_SOURCE


223 
	#__USE_XOPEN
 1

	)

224 #ià(
_XOPEN_SOURCE
 - 0) >= 500

225 
	#__USE_XOPEN_EXTENDED
 1

	)

226 
	#__USE_UNIX98
 1

	)

227 #undeà
_LARGEFILE_SOURCE


228 
	#_LARGEFILE_SOURCE
 1

	)

229 #ià(
_XOPEN_SOURCE
 - 0) >= 600

230 
	#__USE_XOPEN2K
 1

	)

231 #undeà
__USE_ISOC99


232 
	#__USE_ISOC99
 1

	)

235 #ifdeà
_XOPEN_SOURCE_EXTENDED


236 
	#__USE_XOPEN_EXTENDED
 1

	)

241 #ifdeà
_LARGEFILE_SOURCE


242 
	#__USE_LARGEFILE
 1

	)

245 #ifdeà
_LARGEFILE64_SOURCE


246 
	#__USE_LARGEFILE64
 1

	)

249 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

250 
	#__USE_FILE_OFFSET64
 1

	)

253 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


254 
	#__USE_MISC
 1

	)

257 #ifdef 
_BSD_SOURCE


258 
	#__USE_BSD
 1

	)

261 #ifdef 
_SVID_SOURCE


262 
	#__USE_SVID
 1

	)

265 #ifdef 
_ATFILE_SOURCE


266 
	#__USE_ATFILE
 1

	)

269 #ifdef 
_GNU_SOURCE


270 
	#__USE_GNU
 1

	)

273 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


274 
	#__USE_REENTRANT
 1

	)

277 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

278 && 
defšed
 
__OPTIMIZE__
 && __OPTIMIZE__ > 0 \

279 && (
__GNUC_PREREQ
 (4, 1) \

280 || (
defšed
 
	g__GNUC_RH_RELEASE__
 && 
__GNUC_PREREQ
 (4, 0)) \

281 || (
defšed
 
	g__GNUC_RH_RELEASE__
 && 
__GNUC_PREREQ
 (3, 4) \

282 && 
	g__GNUC_MINOR__
 == 4 \

283 && (
__GNUC_PATCHLEVEL__
 > 2 \

284 || (
__GNUC_PATCHLEVEL__
 =ğ2 && 
__GNUC_RH_RELEASE__
 >= 8))))

285 #ià
_FORTIFY_SOURCE
 > 1

286 
	#__USE_FORTIFY_LEVEL
 2

	)

288 
	#__USE_FORTIFY_LEVEL
 1

	)

291 
	#__USE_FORTIFY_LEVEL
 0

	)

295 
	#__STDC_IEC_559__
 1

	)

296 
	#__STDC_IEC_559_COMPLEX__
 1

	)

299 
	#__STDC_ISO_10646__
 200009L

	)

307 #undeà
__GNU_LIBRARY__


308 
	#__GNU_LIBRARY__
 6

	)

312 
	#__GLIBC__
 2

	)

313 
	#__GLIBC_MINOR__
 5

	)

315 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

316 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

319 #ià
defšed
 
__GNUC__
 \

320 || (
defšed
 
	g__PGI
 && defšed 
	g__i386__
 ) \

321 || (
defšed
 
	g__INTEL_COMPILER
 && (defšed 
	g__i386__
 || defšed 
	g__Ÿ64__
)) \

322 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

323 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

327 #iâdeà
__ASSEMBLER__


328 #iâdeà
_SYS_CDEFS_H


329 
	~<sys/cdefs.h
>

334 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


335 
	#__USE_LARGEFILE
 1

	)

336 
	#__USE_LARGEFILE64
 1

	)

342 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

343 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__


344 
	#__USE_EXTERN_INLINES
 1

	)

352 
	~<gnu/¡ubs.h
>

	@/usr/include/signal.h

23 #iâdef 
_SIGNAL_H


25 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


26 
	#_SIGNAL_H


	)

29 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


33 
	~<b™s/sig£t.h
>

37 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


38 #iâdeà
__sig_©omic_t_defšed


39 
	#__sig_©omic_t_defšed


	)

40 
__BEGIN_NAMESPACE_STD


41 
__sig_©omic_t
 
	tsig_©omic_t
;

42 
	g__END_NAMESPACE_STD


44 #undeà
__Ãed_sig_©omic_t


47 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

48 #iâdeà
__sig£t_t_defšed


49 
	#__sig£t_t_defšed


	)

50 
__sig£t_t
 
	tsig£t_t
;

52 #undeà
__Ãed_sig£t_t


55 #ifdeà
_SIGNAL_H


57 
	~<b™s/ty³s.h
>

58 
	~<b™s/signum.h
>

60 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


61 #iâdeà
__pid_t_defšed


62 
__pid_t
 
	tpid_t
;

63 
	#__pid_t_defšed


	)

65 #ifdeà
__USE_XOPEN


67 #iâdeà
__uid_t_defšed


68 
__uid_t
 
	tuid_t
;

69 
	#__uid_t_defšed


	)

75 (*
	t__sighªdËr_t
) ();

80 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

81 
__THROW
;

82 #ifdeà
__USE_GNU


83 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

84 
__THROW
;

90 
__BEGIN_NAMESPACE_STD


91 #ifdeà
__USE_BSD


92 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

93 
__THROW
;

96 #ifdeà
__REDIRECT_NTH


97 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

98 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

99 
__sysv_sigÇl
);

101 
	#sigÇl
 
__sysv_sigÇl


	)

104 
__END_NAMESPACE_STD


106 #ifdeà
__USE_XOPEN


109 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

110 
__THROW
;

116 #ifdeà
__USE_POSIX


117 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

120 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


124 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

127 
__BEGIN_NAMESPACE_STD


129 
	$¿i£
 (
__sig
è
__THROW
;

130 
__END_NAMESPACE_STD


132 #ifdeà
__USE_SVID


134 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

135 
__THROW
;

136 
	$gsigÇl
 (
__sig
è
__THROW
;

139 #ifdeà
__USE_MISC


141 
	`psigÇl
 (
__sig
, 
__cÚ¡
 *
__s
);

153 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

155 #ifdeà
__FAVOR_BSD


158 
	$sig·u£
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

160 #ifdeà
__USE_XOPEN


161 #ifdeà
__GNUC__


162 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

165 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

171 #ifdeà
__USE_BSD


178 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

181 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

184 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

187 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

191 #ifdeà
__USE_MISC


192 
	#NSIG
 
_NSIG


	)

195 #ifdeà
__USE_GNU


196 
__sighªdËr_t
 
	tsighªdËr_t
;

200 #ifdeà
__USE_BSD


201 
__sighªdËr_t
 
	tsig_t
;

204 #ifdeà
__USE_POSIX


206 #ifdeà
__USE_POSIX199309


208 
	#__Ãed_time¥ec


	)

209 
	~<time.h
>

212 
	~<b™s/sigšfo.h
>

216 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

219 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

222 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

228 
	$sigismemb”
 (
__cÚ¡
 
sig£t_t
 *
__£t
, 
__signo
)

229 
__THROW
 
	`__nÚnuÎ
 ((1));

231 #ifdeà
__USE_GNU


233 
	$sigi£m±y£t
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

236 
	$sigªd£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

237 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

240 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

241 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

246 
	~<b™s/sigaùiÚ.h
>

249 
	$sig´ocmask
 (
__how
, 
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

250 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

257 
	$sigsu¥’d
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

260 
	$sigaùiÚ
 (
__sig
, 
__cÚ¡
 
sigaùiÚ
 *
__»¡riù
 
__aù
,

261 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

264 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

271 
	$sigwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

272 
	`__nÚnuÎ
 ((1, 2));

274 #ifdeà
__USE_POSIX199309


279 
	$sigwa™šfo
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

280 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

287 
	$sigtimedwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

288 
sigšfo_t
 *
__»¡riù
 
__šfo
,

289 
__cÚ¡
 
time¥ec
 *
__»¡riù
 
__timeout
)

290 
	`__nÚnuÎ
 ((1));

294 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, 
__cÚ¡
 
sigv®
 
__v®
)

295 
__THROW
;

300 #ifdeà
__USE_BSD


304 
__cÚ¡
 *__cÚ¡ 
_sys_sigli¡
[
_NSIG
];

305 
__cÚ¡
 *__cÚ¡ 
sys_sigli¡
[
_NSIG
];

308 
	ssigvec


310 
__sighªdËr_t
 
sv_hªdËr
;

311 
sv_mask
;

313 
sv_æags
;

314 
	#sv_Ú¡ack
 
sv_æags


	)

318 
	#SV_ONSTACK
 (1 << 0)

	)

319 
	#SV_INTERRUPT
 (1 << 1)

	)

320 
	#SV_RESETHAND
 (1 << 2)

	)

328 
	$sigvec
 (
__sig
, 
__cÚ¡
 
sigvec
 *
__vec
,

329 
sigvec
 *
__ovec
è
__THROW
;

333 
	~<b™s/sigcÚ‹xt.h
>

336 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

341 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


346 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

348 
	~<b™s/sig¡ack.h
>

349 #ifdeà
__USE_XOPEN


351 
	~<sys/ucÚ‹xt.h
>

357 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

358 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

362 
	$sig®t¡ack
 (
__cÚ¡
 
sig®t¡ack
 *
__»¡riù
 
__ss
,

363 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

367 #ifdeà
__USE_XOPEN_EXTENDED


371 
	$sighŞd
 (
__sig
è
__THROW
;

374 
	$sig»l£
 (
__sig
è
__THROW
;

377 
	$sigignÜe
 (
__sig
è
__THROW
;

380 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

383 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


386 
	~<b™s/±h»adty³s.h
>

387 
	~<b™s/sigth»ad.h
>

394 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

396 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

400 
__END_DECLS


	@/usr/include/sys/resource.h

19 #iâdef 
_SYS_RESOURCE_H


20 
	#_SYS_RESOURCE_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/»sourû.h
>

27 #iâdeà
__id_t_defšed


28 
__id_t
 
	tid_t
;

29 
	#__id_t_defšed


	)

32 
	g__BEGIN_DECLS


38 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


39 
__¾im™_»sourû
 
	t__¾im™_»sourû_t
;

40 
__ru§ge_who
 
	t__ru§ge_who_t
;

41 
__´iÜ™y_which
 
	t__´iÜ™y_which_t
;

43 
	t__¾im™_»sourû_t
;

44 
	t__ru§ge_who_t
;

45 
	t__´iÜ™y_which_t
;

50 #iâdeà
__USE_FILE_OFFSET64


51 
	$g‘¾im™
 (
__¾im™_»sourû_t
 
__»sourû
,

52 
¾im™
 *
__¾im™s
è
__THROW
;

54 #ifdeà
__REDIRECT_NTH


55 
	`__REDIRECT_NTH
 (
g‘¾im™
, (
__¾im™_»sourû_t
 
__»sourû
,

56 
¾im™
 *
__¾im™s
), 
g‘¾im™64
);

58 
	#g‘¾im™
 
g‘¾im™64


	)

61 #ifdeà
__USE_LARGEFILE64


62 
	$g‘¾im™64
 (
__¾im™_»sourû_t
 
__»sourû
,

63 
¾im™64
 *
__¾im™s
è
__THROW
;

69 #iâdeà
__USE_FILE_OFFSET64


70 
	$£Œlim™
 (
__¾im™_»sourû_t
 
__»sourû
,

71 
__cÚ¡
 
¾im™
 *
__¾im™s
è
__THROW
;

73 #ifdeà
__REDIRECT_NTH


74 
	`__REDIRECT_NTH
 (
£Œlim™
, (
__¾im™_»sourû_t
 
__»sourû
,

75 
__cÚ¡
 
¾im™
 *
__¾im™s
),

76 
£Œlim™64
);

78 
	#£Œlim™
 
£Œlim™64


	)

81 #ifdeà
__USE_LARGEFILE64


82 
	$£Œlim™64
 (
__¾im™_»sourû_t
 
__»sourû
,

83 
__cÚ¡
 
¾im™64
 *
__¾im™s
è
__THROW
;

88 
	$g‘ru§ge
 (
__ru§ge_who_t
 
__who
, 
ru§ge
 *
__u§ge
è
__THROW
;

94 
	$g‘´iÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
è
__THROW
;

98 
	$£riÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
, 
__´io
)

99 
__THROW
;

101 
__END_DECLS


	@/usr/include/bits/pthreadtypes.h

20 #iâdeà
_BITS_PTHREADTYPES_H


21 
	#_BITS_PTHREADTYPES_H
 1

	)

23 
	~<b™s/wÜdsize.h
>

25 #ià
__WORDSIZE
 == 64

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

29 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

30 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

31 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

32 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

34 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

36 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

37 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

38 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

39 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

40 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

43 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

50 
	t±h»ad_t
;

55 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

56 
	m__®ign
;

57 } 
	t±h»ad_©Œ_t
;

60 #ià
__WORDSIZE
 == 64

61 
	s__±h»ad_š‹º®_li¡


63 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

64 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

65 } 
	t__±h»ad_li¡_t
;

67 
	s__±h»ad_š‹º®_¦i¡


69 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

70 } 
	t__±h»ad_¦i¡_t
;

78 
	s__±h»ad_mu‹x_s


80 
	m__lock
;

81 
	m__couÁ
;

82 
	m__owÃr
;

83 #ià
__WORDSIZE
 == 64

84 
	m__nu£rs
;

88 
	m__kšd
;

89 #ià
__WORDSIZE
 == 64

90 
	m__¥šs
;

91 
__±h»ad_li¡_t
 
	m__li¡
;

92 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

94 
	m__nu£rs
;

95 
__ex‹nsiÚ__
 union

97 
	m__¥šs
;

98 
__±h»ad_¦i¡_t
 
	m__li¡
;

101 } 
	m__d©a
;

102 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

103 
	m__®ign
;

104 } 
	t±h»ad_mu‹x_t
;

108 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

109 
	m__®ign
;

110 } 
	t±h»ad_mu‹x©Œ_t
;

119 
	m__lock
;

120 
	m__fu‹x
;

121 
__ex‹nsiÚ__
 
	m__tÙ®_£q
;

122 
__ex‹nsiÚ__
 
	m__wakeup_£q
;

123 
__ex‹nsiÚ__
 
	m__wok’_£q
;

124 *
	m__mu‹x
;

125 
	m__nwa™”s
;

126 
	m__brßdÿ¡_£q
;

127 } 
	m__d©a
;

128 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

129 
__ex‹nsiÚ__
 
	m__®ign
;

130 } 
	t±h»ad_cÚd_t
;

134 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

135 
	m__®ign
;

136 } 
	t±h»ad_cÚd©Œ_t
;

140 
	t±h»ad_key_t
;

144 
	t±h»ad_Úû_t
;

147 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


152 #ià
__WORDSIZE
 == 64

155 
	m__lock
;

156 
	m__Ä_»ad”s
;

157 
	m__»ad”s_wakeup
;

158 
	m__wr™”_wakeup
;

159 
	m__Ä_»ad”s_queued
;

160 
	m__Ä_wr™”s_queued
;

161 
	m__wr™”
;

162 
	m__sh¬ed
;

163 
	m__·d1
;

164 
	m__·d2
;

167 
	m__æags
;

168 } 
	m__d©a
;

172 
	m__lock
;

173 
	m__Ä_»ad”s
;

174 
	m__»ad”s_wakeup
;

175 
	m__wr™”_wakeup
;

176 
	m__Ä_»ad”s_queued
;

177 
	m__Ä_wr™”s_queued
;

180 
	m__æags
;

181 
	m__sh¬ed
;

182 
	m__·d1
;

183 
	m__·d2
;

184 
	m__wr™”
;

185 } 
	m__d©a
;

187 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

188 
	m__®ign
;

189 } 
	t±h»ad_rwlock_t
;

193 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

194 
	m__®ign
;

195 } 
	t±h»ad_rwlock©Œ_t
;

199 #ifdeà
__USE_XOPEN2K


201 vŞ©
	t±h»ad_¥šlock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

209 
	m__®ign
;

210 } 
	t±h»ad_b¬r›r_t
;

214 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

215 
	m__®ign
;

216 } 
	t±h»ad_b¬r›¿‰r_t
;

220 #ià
__WORDSIZE
 == 32

222 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/resource.h

21 #iâdeà
_SYS_RESOURCE_H


25 
	~<b™s/ty³s.h
>

33 
	e__¾im™_»sourû


36 
	mRLIMIT_CPU
 = 0,

37 
	#RLIMIT_CPU
 
RLIMIT_CPU


	)

40 
	mRLIMIT_FSIZE
 = 1,

41 
	#RLIMIT_FSIZE
 
RLIMIT_FSIZE


	)

44 
	mRLIMIT_DATA
 = 2,

45 
	#RLIMIT_DATA
 
RLIMIT_DATA


	)

48 
	mRLIMIT_STACK
 = 3,

49 
	#RLIMIT_STACK
 
RLIMIT_STACK


	)

52 
	mRLIMIT_CORE
 = 4,

53 
	#RLIMIT_CORE
 
RLIMIT_CORE


	)

59 
	m__RLIMIT_RSS
 = 5,

60 
	#RLIMIT_RSS
 
__RLIMIT_RSS


	)

63 
	mRLIMIT_NOFILE
 = 7,

64 
	m__RLIMIT_OFILE
 = 
RLIMIT_NOFILE
,

65 
	#RLIMIT_NOFILE
 
RLIMIT_NOFILE


	)

66 
	#RLIMIT_OFILE
 
__RLIMIT_OFILE


	)

69 
	mRLIMIT_AS
 = 9,

70 
	#RLIMIT_AS
 
RLIMIT_AS


	)

73 
	m__RLIMIT_NPROC
 = 6,

74 
	#RLIMIT_NPROC
 
__RLIMIT_NPROC


	)

77 
	m__RLIMIT_MEMLOCK
 = 8,

78 
	#RLIMIT_MEMLOCK
 
__RLIMIT_MEMLOCK


	)

81 
	m__RLIMIT_LOCKS
 = 10,

82 
	#RLIMIT_LOCKS
 
__RLIMIT_LOCKS


	)

85 
	m__RLIMIT_SIGPENDING
 = 11,

86 
	#RLIMIT_SIGPENDING
 
__RLIMIT_SIGPENDING


	)

89 
	m__RLIMIT_MSGQUEUE
 = 12,

90 
	#RLIMIT_MSGQUEUE
 
__RLIMIT_MSGQUEUE


	)

95 
	m__RLIMIT_NICE
 = 13,

96 
	#RLIMIT_NICE
 
__RLIMIT_NICE


	)

100 
	m__RLIMIT_RTPRIO
 = 14,

101 
	#RLIMIT_RTPRIO
 
__RLIMIT_RTPRIO


	)

103 
	m__RLIMIT_NLIMITS
 = 15,

104 
	m__RLIM_NLIMITS
 = 
__RLIMIT_NLIMITS


105 
	#RLIMIT_NLIMITS
 
__RLIMIT_NLIMITS


	)

106 
	#RLIM_NLIMITS
 
__RLIM_NLIMITS


	)

110 #iâdeà
__USE_FILE_OFFSET64


111 
	#RLIM_INFINITY
 (()(~0UL))

	)

113 
	#RLIM_INFINITY
 0xffffffffffffffffuLL

	)

116 #ifdeà
__USE_LARGEFILE64


117 
	#RLIM64_INFINITY
 0xffffffffffffffffuLL

	)

121 
	#RLIM_SAVED_MAX
 
RLIM_INFINITY


	)

122 
	#RLIM_SAVED_CUR
 
RLIM_INFINITY


	)

126 #iâdeà
__USE_FILE_OFFSET64


127 
__¾im_t
 
	t¾im_t
;

129 
__¾im64_t
 
	t¾im_t
;

131 #ifdeà
__USE_LARGEFILE64


132 
__¾im64_t
 
	t¾im64_t
;

135 
	s¾im™


138 
¾im_t
 
	m¾im_cur
;

140 
¾im_t
 
	m¾im_max
;

143 #ifdeà
__USE_LARGEFILE64


144 
	s¾im™64


147 
¾im64_t
 
	m¾im_cur
;

149 
¾im64_t
 
	m¾im_max
;

154 
	e__ru§ge_who


157 
	mRUSAGE_SELF
 = 0,

158 
	#RUSAGE_SELF
 
RUSAGE_SELF


	)

161 
	mRUSAGE_CHILDREN
 = -1,

162 
	#RUSAGE_CHILDREN
 
RUSAGE_CHILDREN


	)

164 #ifdeà
__USE_GNU


166 
	mRUSAGE_THREAD
 = 1

167 
	#RUSAGE_THREAD
 
RUSAGE_THREAD


	)

169 
	#RUSAGE_LWP
 
RUSAGE_THREAD


	)

173 
	#__Ãed_timev®


	)

174 
	~<b™s/time.h
>

177 
	sru§ge


180 
timev®
 
	mru_utime
;

182 
timev®
 
	mru_¡ime
;

184 
	mru_maxrss
;

187 
	mru_ixrss
;

189 
	mru_idrss
;

191 
	mru_i¤ss
;

194 
	mru_mšæt
;

196 
	mru_majæt
;

198 
	mru_nsw­
;

201 
	mru_šblock
;

203 
	mru_oublock
;

205 
	mru_msg¢d
;

207 
	mru_msgrcv
;

209 
	mru_nsigÇls
;

213 
	mru_nvcsw
;

216 
	mru_nivcsw
;

220 
	#PRIO_MIN
 -20

	)

221 
	#PRIO_MAX
 20

	)

225 
	e__´iÜ™y_which


227 
	mPRIO_PROCESS
 = 0,

228 
	#PRIO_PROCESS
 
PRIO_PROCESS


	)

229 
	mPRIO_PGRP
 = 1,

230 
	#PRIO_PGRP
 
PRIO_PGRP


	)

231 
	mPRIO_USER
 = 2

232 
	#PRIO_USER
 
PRIO_USER


	)

	@/usr/include/bits/sigaction.h

20 #iâdeà
_SIGNAL_H


25 
	ssigaùiÚ


28 #ifdeà
__USE_POSIX199309


32 
__sighªdËr_t
 
	m§_hªdËr
;

34 (*
	m§_sigaùiÚ
è(, 
	msigšfo_t
 *, *);

36 
	m__sigaùiÚ_hªdËr
;

37 
	#§_hªdËr
 
__sigaùiÚ_hªdËr
.
§_hªdËr


	)

38 
	#§_sigaùiÚ
 
__sigaùiÚ_hªdËr
.
§_sigaùiÚ


	)

40 
__sighªdËr_t
 
	m§_hªdËr
;

44 
__sig£t_t
 
	m§_mask
;

47 
	m§_æags
;

50 (*
	m§_»¡Ü”
) ();

54 
	#SA_NOCLDSTOP
 1

	)

55 
	#SA_NOCLDWAIT
 2

	)

56 
	#SA_SIGINFO
 4

	)

58 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_MISC


59 
	#SA_ONSTACK
 0x08000000

	)

60 
	#SA_RESTART
 0x10000000

	)

61 
	#SA_NODEFER
 0x40000000

	)

63 
	#SA_RESETHAND
 0x80000000

	)

65 #ifdeà
__USE_MISC


66 
	#SA_INTERRUPT
 0x20000000

	)

69 
	#SA_NOMASK
 
SA_NODEFER


	)

70 
	#SA_ONESHOT
 
SA_RESETHAND


	)

71 
	#SA_STACK
 
SA_ONSTACK


	)

75 
	#SIG_BLOCK
 0

	)

76 
	#SIG_UNBLOCK
 1

	)

77 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

19 #iâdeà
_BITS_SIGCONTEXT_H


20 
	#_BITS_SIGCONTEXT_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_SYS_UCONTEXT_H


26 
	~<b™s/wÜdsize.h
>

28 
	s_å»g


30 
	msignifiÿnd
[4];

31 
	mexpÚ’t
;

34 
	s_åx»g


36 
	msignifiÿnd
[4];

37 
	mexpÚ’t
;

38 
	m·ddšg
[3];

41 
	s_xmm»g


43 
__ušt32_t
 
	m–em’t
[4];

48 #ià
__WORDSIZE
 == 32

50 
	s_å¡©e


53 
__ušt32_t
 
	mcw
;

54 
__ušt32_t
 
	msw
;

55 
__ušt32_t
 
	mg
;

56 
__ušt32_t
 
	moff
;

57 
__ušt32_t
 
	mcs£l
;

58 
__ušt32_t
 
	md©aoff
;

59 
__ušt32_t
 
	md©a£l
;

60 
_å»g
 
	m_¡
[8];

61 
	m¡©us
;

62 
	mmagic
;

65 
__ušt32_t
 
	m_fx¤_’v
[6];

66 
__ušt32_t
 
	mmxc¤
;

67 
__ušt32_t
 
	m»£rved
;

68 
_åx»g
 
	m_fx¤_¡
[8];

69 
_xmm»g
 
	m_xmm
[8];

70 
__ušt32_t
 
	m·ddšg
[56];

73 #iâdeà
sigcÚ‹xt_¡ruù


78 
	#sigcÚ‹xt_¡ruù
 
sigcÚ‹xt


	)

81 
	ssigcÚ‹xt


83 
	mgs
, 
	m__gsh
;

84 
	mfs
, 
	m__fsh
;

85 
	mes
, 
	m__esh
;

86 
	mds
, 
	m__dsh
;

87 
	medi
;

88 
	mesi
;

89 
	mebp
;

90 
	me¥
;

91 
	mebx
;

92 
	medx
;

93 
	mecx
;

94 
	m—x
;

95 
	mŒ­no
;

96 
	m”r
;

97 
	me
;

98 
	mcs
, 
	m__csh
;

99 
	meæags
;

100 
	me¥_©_sigÇl
;

101 
	mss
, 
	m__ssh
;

102 
_å¡©e
 * 
	må¡©e
;

103 
	mŞdmask
;

104 
	mü2
;

109 
	s_å¡©e


112 
__ušt16_t
 
	mcwd
;

113 
__ušt16_t
 
	mswd
;

114 
__ušt16_t
 
	máw
;

115 
__ušt16_t
 
	mfİ
;

116 
__ušt64_t
 
	mr
;

117 
__ušt64_t
 
	mrdp
;

118 
__ušt32_t
 
	mmxc¤
;

119 
__ušt32_t
 
	mmxü_mask
;

120 
_åx»g
 
	m_¡
[8];

121 
_xmm»g
 
	m_xmm
[16];

122 
__ušt32_t
 
	m·ddšg
[24];

125 
	ssigcÚ‹xt


127 
	mr8
;

128 
	mr9
;

129 
	mr10
;

130 
	mr11
;

131 
	mr12
;

132 
	mr13
;

133 
	mr14
;

134 
	mr15
;

135 
	mrdi
;

136 
	mrsi
;

137 
	mrbp
;

138 
	mrbx
;

139 
	mrdx
;

140 
	m¿x
;

141 
	mrcx
;

142 
	mr¥
;

143 
	mr
;

144 
	meæags
;

145 
	mcs
;

146 
	mgs
;

147 
	mfs
;

148 
	m__·d0
;

149 
	m”r
;

150 
	mŒ­no
;

151 
	mŞdmask
;

152 
	mü2
;

153 
_å¡©e
 * 
	må¡©e
;

154 
	m__»£rved1
 [8];

	@/usr/include/bits/signum.h

20 #ifdef 
_SIGNAL_H


23 
	#SIG_ERR
 ((
__sighªdËr_t
è-1è

	)

24 
	#SIG_DFL
 ((
__sighªdËr_t
è0è

	)

25 
	#SIG_IGN
 ((
__sighªdËr_t
è1è

	)

27 #ifdeà
__USE_UNIX98


28 
	#SIG_HOLD
 ((
__sighªdËr_t
è2è

	)

33 
	#SIGHUP
 1

	)

34 
	#SIGINT
 2

	)

35 
	#SIGQUIT
 3

	)

36 
	#SIGILL
 4

	)

37 
	#SIGTRAP
 5

	)

38 
	#SIGABRT
 6

	)

39 
	#SIGIOT
 6

	)

40 
	#SIGBUS
 7

	)

41 
	#SIGFPE
 8

	)

42 
	#SIGKILL
 9

	)

43 
	#SIGUSR1
 10

	)

44 
	#SIGSEGV
 11

	)

45 
	#SIGUSR2
 12

	)

46 
	#SIGPIPE
 13

	)

47 
	#SIGALRM
 14

	)

48 
	#SIGTERM
 15

	)

49 
	#SIGSTKFLT
 16

	)

50 
	#SIGCLD
 
SIGCHLD


	)

51 
	#SIGCHLD
 17

	)

52 
	#SIGCONT
 18

	)

53 
	#SIGSTOP
 19

	)

54 
	#SIGTSTP
 20

	)

55 
	#SIGTTIN
 21

	)

56 
	#SIGTTOU
 22

	)

57 
	#SIGURG
 23

	)

58 
	#SIGXCPU
 24

	)

59 
	#SIGXFSZ
 25

	)

60 
	#SIGVTALRM
 26

	)

61 
	#SIGPROF
 27

	)

62 
	#SIGWINCH
 28

	)

63 
	#SIGPOLL
 
SIGIO


	)

64 
	#SIGIO
 29

	)

65 
	#SIGPWR
 30

	)

66 
	#SIGSYS
 31

	)

67 
	#SIGUNUSED
 31

	)

69 
	#_NSIG
 65

	)

72 
	#SIGRTMIN
 (
	`__libc_cu¼’t_sig¹mš
 ())

	)

73 
	#SIGRTMAX
 (
	`__libc_cu¼’t_sig¹max
 ())

	)

77 
	#__SIGRTMIN
 32

	)

78 
	#__SIGRTMAX
 (
_NSIG
 - 1)

	)

	@/usr/include/bits/sigset.h

20 #iâdef 
_SIGSET_H_ty³s


21 
	#_SIGSET_H_ty³s
 1

	)

23 
	t__sig_©omic_t
;

27 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

30 
	m__v®
[
_SIGSET_NWORDS
];

31 } 
	t__sig£t_t
;

42 #ià!
defšed
 
_SIGSET_H_âs
 && defšed 
_SIGNAL_H


43 
	#_SIGSET_H_âs
 1

	)

45 #iâdeà
_EXTERN_INLINE


46 
	#_EXTERN_INLINE
 
__šlše


	)

50 
	#__sigmask
(
sig
) \

51 (((è1è<< (((
sig
è- 1è% (8 *  ())))

	)

54 
	#__sigwÜd
(
sig
è(((sigè- 1è/ (8 *  ()))

	)

56 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

57 
	#__sigem±y£t
(
£t
) \

58 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

59 
sig£t_t
 *
__£t
 = (
£t
); \

60 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = 0; \

61 0; }))

	)

62 
	#__sigfl£t
(
£t
) \

63 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

64 
sig£t_t
 *
__£t
 = (
£t
); \

65 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = ~0UL; \

66 0; }))

	)

68 #ifdeà
__USE_GNU


72 
	#__sigi£m±y£t
(
£t
) \

73 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

74 cÚ¡ 
sig£t_t
 *
__£t
 = (
£t
); \

75 
__»t
 = 
__£t
->
__v®
[--
__út
]; \

76 !
__»t
 && --
__út
 >= 0) \

77 
__»t
 = 
__£t
->
__v®
[
__út
]; \

78 
__»t
 =ğ0; }))

	)

79 
	#__sigªd£t
(
de¡
, 
Ëá
, 
right
) \

80 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

81 
sig£t_t
 *
__de¡
 = (
de¡
); \

82 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

83 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

84 --
__út
 >= 0) \

85 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

86 & 
__right
->
__v®
[
__út
]); \

87 0; }))

	)

88 
	#__sigÜ£t
(
de¡
, 
Ëá
, 
right
) \

89 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

90 
sig£t_t
 *
__de¡
 = (
de¡
); \

91 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

92 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

93 --
__út
 >= 0) \

94 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

95 | 
__right
->
__v®
[
__út
]); \

96 0; }))

	)

103 
__sigismemb”
 (
__cÚ¡
 
__sig£t_t
 *, );

104 
__sigadd£t
 (
__sig£t_t
 *, );

105 
__sigd–£t
 (
__sig£t_t
 *, );

107 #ifdeà
__USE_EXTERN_INLINES


108 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

109 
_EXTERN_INLINE
 \

110 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

112 
__mask
 = 
	`__sigmask
 (
__sig
); \

113 
__wÜd
 = 
	`__sigwÜd
 (
__sig
); \

114  
BODY
; \

115 }

	)

117 
__SIGSETFN
 (
__sigismemb”
, (
__£t
->
__v®
[
__wÜd
] & 
__mask
è? 1 : 0, 
__cÚ¡
)

118 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__v®
[
__wÜd
] |ğ
__mask
), 0), )

119 
__SIGSETFN
 (
__sigd–£t
, ((
__£t
->
__v®
[
__wÜd
] &ğ~
__mask
), 0), )

121 #undeà
__SIGSETFN


	@/usr/include/bits/sigstack.h

20 #iâdeà
_SIGNAL_H


26 
	ssig¡ack


28 *
	mss_¥
;

29 
	mss_Ú¡ack
;

36 
	mSS_ONSTACK
 = 1,

37 
	#SS_ONSTACK
 
SS_ONSTACK


	)

38 
	mSS_DISABLE


39 
	#SS_DISABLE
 
SS_DISABLE


	)

43 
	#MINSIGSTKSZ
 2048

	)

46 
	#SIGSTKSZ
 8192

	)

50 
	ssig®t¡ack


52 *
	mss_¥
;

53 
	mss_æags
;

54 
size_t
 
	mss_size
;

55 } 
	t¡ack_t
;

	@/usr/include/bits/sigthread.h

20 #iâdeà
_BITS_SIGTHREAD_H


21 
	#_BITS_SIGTHREAD_H
 1

	)

23 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_PTHREAD_H


31 
	$±h»ad_sigmask
 (
__how
,

32 
__cÚ¡
 
__sig£t_t
 *
__»¡riù
 
__Ãwmask
,

33 
__sig£t_t
 *
__»¡riù
 
__Şdmask
)
__THROW
;

36 
	$±h»ad_kl
 (
±h»ad_t
 
__th»adid
, 
__signo
è
__THROW
;

	@/usr/include/bits/types.h

24 #iâdef 
_BITS_TYPES_H


25 
	#_BITS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/wÜdsize.h
>

30 
	#__Ãed_size_t


	)

31 
	~<¡ddef.h
>

34 
	t__u_ch¬
;

35 
	t__u_shÜt
;

36 
	t__u_št
;

37 
	t__u_lÚg
;

40 sigÃd 
	t__št8_t
;

41 
	t__ušt8_t
;

42 sigÃd 
	t__št16_t
;

43 
	t__ušt16_t
;

44 sigÃd 
	t__št32_t
;

45 
	t__ušt32_t
;

46 #ià
__WORDSIZE
 == 64

47 sigÃd 
	t__št64_t
;

48 
	t__ušt64_t
;

49 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


50 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

51 
__ex‹nsiÚ__
 
	t__ušt64_t
;

55 #ià
__WORDSIZE
 == 64

56 
	t__quad_t
;

57 
	t__u_quad_t
;

58 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


59 
__ex‹nsiÚ__
 
	t__quad_t
;

60 
__ex‹nsiÚ__
 
	t__u_quad_t
;

64 
	m__v®
[2];

65 } 
	t__quad_t
;

68 
__u_lÚg
 
	m__v®
[2];

69 } 
	t__u_quad_t
;

102 
	#__S16_TYPE
 

	)

103 
	#__U16_TYPE
 

	)

104 
	#__S32_TYPE
 

	)

105 
	#__U32_TYPE
 

	)

106 
	#__SLONGWORD_TYPE
 

	)

107 
	#__ULONGWORD_TYPE
 

	)

108 #ià
__WORDSIZE
 == 32

109 
	#__SQUAD_TYPE
 
__quad_t


	)

110 
	#__UQUAD_TYPE
 
__u_quad_t


	)

111 
	#__SWORD_TYPE
 

	)

112 
	#__UWORD_TYPE
 

	)

113 
	#__SLONG32_TYPE
 

	)

114 
	#__ULONG32_TYPE
 

	)

115 
	#__S64_TYPE
 
__quad_t


	)

116 
	#__U64_TYPE
 
__u_quad_t


	)

119 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

120 #–ià
__WORDSIZE
 == 64

121 
	t__SQUAD_TYPE
 

	)

122 
	t__UQUAD_TYPE
 

	)

123 
	t__SWORD_TYPE
 

	)

124 
	t__UWORD_TYPE
 

	)

125 
	t__SLONG32_TYPE
 

	)

126 
	t__ULONG32_TYPE
 

	)

127 
	t__S64_TYPE
 

	)

128 
	t__U64_TYPE
 

	)

130 
	t__STD_TYPE
 

	)

134 
	~<b™s/ty³sizes.h
>

137 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

138 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

139 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

140 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

141 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

142 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

143 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

144 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

145 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

146 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

147 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

148 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

149 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

150 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

151 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

152 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

153 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

154 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

156 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

157 
__STD_TYPE
 
__SWBLK_T_TYPE
 
	g__swblk_t
;

158 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

161 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

164 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

167 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

172 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

173 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

176 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

177 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

180 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

181 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

183 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

187 
__off64_t
 
	t__loff_t
;

188 
__quad_t
 *
	t__qaddr_t
;

189 *
	t__ÿddr_t
;

192 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

195 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

198 #undeà
__STD_TYPE


	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__


4 
	#__WORDSIZE
 64

	)

5 
	#__WORDSIZE_COMPAT32
 1

	)

7 
	#__WORDSIZE
 32

	)

	@/usr/include/endian.h

19 #iâdef 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<ã©u»s.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<b™s/’dŸn.h
>

41 #iâdeà
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

54 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

	@/usr/include/gnu/stubs.h

4 
	~<b™s/wÜdsize.h
>

6 #ià
__WORDSIZE
 == 32

7 
	~<gnu/¡ubs-32.h
>

8 #–ià
__WORDSIZE
 == 64

9 
	~<gnu/¡ubs-64.h
>

	@/usr/include/sys/cdefs.h

20 #iâdef 
_SYS_CDEFS_H


21 
	#_SYS_CDEFS_H
 1

	)

24 #iâdeà
_FEATURES_H


25 
	~<ã©u»s.h
>

31 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


36 #undeà
__P


37 #undeà
__PMT


39 #ifdeà
__GNUC__


46 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

47 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

48 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

50 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

51 
	#__THROW
 
	`throw
 ()

	)

52 
	#__NTH
(
fù
èfù 
	`throw
 ()

	)

54 
	#__THROW


	)

55 
	#__NTH
(
fù
è
	)
fct

61 
	#__šlše


	)

63 
	#__THROW


	)

64 
	#__NTH
(
fù
è
	)
fct

66 
	#__cÚ¡
 cÚ¡

	)

67 
	#__sigÃd
 sigÃd

	)

68 
	#__vŞ©e
 vŞ©e

	)

74 
	#__P
(
¬gs
è
	)
args

75 
	#__PMT
(
¬gs
è
	)
args

80 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

81 
	#__STRING
(
x
è#x

	)

84 
	#__±r_t
 *

	)

85 
	#__lÚg_doubË_t
 

	)

89 #ifdef 
__ılu¥lus


90 
	#__BEGIN_DECLS
 "C" {

	)

91 
	#__END_DECLS
 }

	)

93 
	#__BEGIN_DECLS


	)

94 
	#__END_DECLS


	)

103 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES


104 
	#__BEGIN_NAMESPACE_STD
 
Çme¥aû
 
¡d
 {

	)

105 
	#__END_NAMESPACE_STD
 }

	)

106 
	#__USING_NAMESPACE_STD
(
Çme
è
usšg
 
¡d
::Çme;

	)

107 
	#__BEGIN_NAMESPACE_C99
 
Çme¥aû
 
__c99
 {

	)

108 
	#__END_NAMESPACE_C99
 }

	)

109 
	#__USING_NAMESPACE_C99
(
Çme
è
usšg
 
__c99
::Çme;

	)

114 
	#__BEGIN_NAMESPACE_STD


	)

115 
	#__END_NAMESPACE_STD


	)

116 
	#__USING_NAMESPACE_STD
(
Çme
)

	)

117 
	#__BEGIN_NAMESPACE_C99


	)

118 
	#__END_NAMESPACE_C99


	)

119 
	#__USING_NAMESPACE_C99
(
Çme
)

	)

124 #iâdeà
__BOUNDED_POINTERS__


125 
	#__bounded


	)

126 
	#__unbounded


	)

127 
	#__±rv®ue


	)

132 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

133 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

134 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

138 #ià
__GNUC_PREREQ
 (2,97)

140 
	#__æex¬r
 []

	)

142 #ifdeà
__GNUC__


143 
	#__æex¬r
 [0]

	)

145 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

146 
	#__æex¬r
 []

	)

149 
	#__æex¬r
 [1]

	)

165 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

167 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

168 #ifdeà
__ılu¥lus


169 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

170 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

172 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

173 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

175 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

176 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

189 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

190 
	#__©Œibu‹__
(
xyz
è

	)

196 #ià
__GNUC_PREREQ
 (2,96)

197 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

199 
	#__©Œibu‹_m®loc__


	)

205 #ià
__GNUC_PREREQ
 (2,96)

206 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

208 
	#__©Œibu‹_pu»__


	)

214 #ià
__GNUC_PREREQ
 (3,1)

215 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

216 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

218 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

219 
	#__©Œibu‹_nošlše__


	)

223 #ià
__GNUC_PREREQ
 (3,2)

224 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

226 
	#__©Œibu‹_d•»ÿ‹d__


	)

235 #ià
__GNUC_PREREQ
 (2,8)

236 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

238 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

245 #ià
__GNUC_PREREQ
 (2,97)

246 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

247 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

249 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

254 #ià
__GNUC_PREREQ
 (3,3)

255 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

257 
	#__nÚnuÎ
(
·¿ms
)

	)

262 #ià
__GNUC_PREREQ
 (3,4)

263 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

264 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

265 #ià
__USE_FORTIFY_LEVEL
 > 0

266 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

269 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

271 #iâdeà
__wur


272 
	#__wur


	)

276 #ià
__GNUC_PREREQ
 (3,2)

277 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

279 
	#__®ways_šlše
 
__šlše


	)

286 #ià!
__GNUC_PREREQ
 (2,8)

287 
	#__ex‹nsiÚ__


	)

291 #ià!
__GNUC_PREREQ
 (2,92)

292 
	#__»¡riù


	)

298 #ià
__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


299 
	#__»¡riù_¬r
 
__»¡riù


	)

301 #ifdeà
__GNUC__


302 
	#__»¡riù_¬r


	)

304 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

305 
	#__»¡riù_¬r
 
»¡riù


	)

308 
	#__»¡riù_¬r


	)

313 
	~<b™s/wÜdsize.h
>

315 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


316 
	#__LDBL_COMPAT
 1

	)

317 #ifdeà
__REDIRECT


318 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

319 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

320 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

321 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

322 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

323 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

324 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

325 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

326 
	#__LDBL_REDIR_DECL
(
Çme
) \

327 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

330 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


331 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

332 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

333 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

334 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

335 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

	@/usr/include/sys/ucontext.h

19 #iâdeà
_SYS_UCONTEXT_H


20 
	#_SYS_UCONTEXT_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<sigÇl.h
>

24 
	~<b™s/wÜdsize.h
>

28 
	~<b™s/sigcÚ‹xt.h
>

30 #ià
__WORDSIZE
 == 64

33 
	tg»g_t
;

36 
	#NGREG
 23

	)

39 
g»g_t
 
	tg»g£t_t
[
NGREG
];

41 #ifdeà
__USE_GNU


45 
	mREG_R8
 = 0,

46 
	#REG_R8
 
REG_R8


	)

47 
	mREG_R9
,

48 
	#REG_R9
 
REG_R9


	)

49 
	mREG_R10
,

50 
	#REG_R10
 
REG_R10


	)

51 
	mREG_R11
,

52 
	#REG_R11
 
REG_R11


	)

53 
	mREG_R12
,

54 
	#REG_R12
 
REG_R12


	)

55 
	mREG_R13
,

56 
	#REG_R13
 
REG_R13


	)

57 
	mREG_R14
,

58 
	#REG_R14
 
REG_R14


	)

59 
	mREG_R15
,

60 
	#REG_R15
 
REG_R15


	)

61 
	mREG_RDI
,

62 
	#REG_RDI
 
REG_RDI


	)

63 
	mREG_RSI
,

64 
	#REG_RSI
 
REG_RSI


	)

65 
	mREG_RBP
,

66 
	#REG_RBP
 
REG_RBP


	)

67 
	mREG_RBX
,

68 
	#REG_RBX
 
REG_RBX


	)

69 
	mREG_RDX
,

70 
	#REG_RDX
 
REG_RDX


	)

71 
	mREG_RAX
,

72 
	#REG_RAX
 
REG_RAX


	)

73 
	mREG_RCX
,

74 
	#REG_RCX
 
REG_RCX


	)

75 
	mREG_RSP
,

76 
	#REG_RSP
 
REG_RSP


	)

77 
	mREG_RIP
,

78 
	#REG_RIP
 
REG_RIP


	)

79 
	mREG_EFL
,

80 
	#REG_EFL
 
REG_EFL


	)

81 
	mREG_CSGSFS
,

82 
	#REG_CSGSFS
 
REG_CSGSFS


	)

83 
	mREG_ERR
,

84 
	#REG_ERR
 
REG_ERR


	)

85 
	mREG_TRAPNO
,

86 
	#REG_TRAPNO
 
REG_TRAPNO


	)

87 
	mREG_OLDMASK
,

88 
	#REG_OLDMASK
 
REG_OLDMASK


	)

89 
	mREG_CR2


90 
	#REG_CR2
 
REG_CR2


	)

94 
	s_libc_åx»g


96 
	msignifiÿnd
[4];

97 
	mexpÚ’t
;

98 
	m·ddšg
[3];

101 
	s_libc_xmm»g


103 
__ušt32_t
 
	m–em’t
[4];

106 
	s_libc_å¡©e


109 
__ušt16_t
 
	mcwd
;

110 
__ušt16_t
 
	mswd
;

111 
__ušt16_t
 
	máw
;

112 
__ušt16_t
 
	mfİ
;

113 
__ušt64_t
 
	mr
;

114 
__ušt64_t
 
	mrdp
;

115 
__ušt32_t
 
	mmxc¤
;

116 
__ušt32_t
 
	mmxü_mask
;

117 
_libc_åx»g
 
	m_¡
[8];

118 
_libc_xmm»g
 
	m_xmm
[16];

119 
__ušt32_t
 
	m·ddšg
[24];

123 
_libc_å¡©e
 *
	tå»g£t_t
;

128 
g»g£t_t
 
	mg»gs
;

130 
å»g£t_t
 
	må»gs
;

131 
	m__»£rved1
 [8];

132 } 
	tmcÚ‹xt_t
;

135 
	sucÚ‹xt


137 
	muc_æags
;

138 
ucÚ‹xt
 *
	muc_lšk
;

139 
¡ack_t
 
	muc_¡ack
;

140 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

141 
__sig£t_t
 
	muc_sigmask
;

142 
_libc_å¡©e
 
	m__å»gs_mem
;

143 } 
	tucÚ‹xt_t
;

148 
	tg»g_t
;

151 
	#NGREG
 19

	)

154 
g»g_t
 
	tg»g£t_t
[
NGREG
];

156 #ifdeà
__USE_GNU


160 
	mREG_GS
 = 0,

161 
	#REG_GS
 
REG_GS


	)

162 
	mREG_FS
,

163 
	#REG_FS
 
REG_FS


	)

164 
	mREG_ES
,

165 
	#REG_ES
 
REG_ES


	)

166 
	mREG_DS
,

167 
	#REG_DS
 
REG_DS


	)

168 
	mREG_EDI
,

169 
	#REG_EDI
 
REG_EDI


	)

170 
	mREG_ESI
,

171 
	#REG_ESI
 
REG_ESI


	)

172 
	mREG_EBP
,

173 
	#REG_EBP
 
REG_EBP


	)

174 
	mREG_ESP
,

175 
	#REG_ESP
 
REG_ESP


	)

176 
	mREG_EBX
,

177 
	#REG_EBX
 
REG_EBX


	)

178 
	mREG_EDX
,

179 
	#REG_EDX
 
REG_EDX


	)

180 
	mREG_ECX
,

181 
	#REG_ECX
 
REG_ECX


	)

182 
	mREG_EAX
,

183 
	#REG_EAX
 
REG_EAX


	)

184 
	mREG_TRAPNO
,

185 
	#REG_TRAPNO
 
REG_TRAPNO


	)

186 
	mREG_ERR
,

187 
	#REG_ERR
 
REG_ERR


	)

188 
	mREG_EIP
,

189 
	#REG_EIP
 
REG_EIP


	)

190 
	mREG_CS
,

191 
	#REG_CS
 
REG_CS


	)

192 
	mREG_EFL
,

193 
	#REG_EFL
 
REG_EFL


	)

194 
	mREG_UESP
,

195 
	#REG_UESP
 
REG_UESP


	)

196 
	mREG_SS


197 
	#REG_SS
 
REG_SS


	)

202 
	s_libc_å»g


204 
	msignifiÿnd
[4];

205 
	mexpÚ’t
;

208 
	s_libc_å¡©e


210 
	mcw
;

211 
	msw
;

212 
	mg
;

213 
	moff
;

214 
	mcs£l
;

215 
	md©aoff
;

216 
	md©a£l
;

217 
_libc_å»g
 
	m_¡
[8];

218 
	m¡©us
;

222 
_libc_å¡©e
 *
	tå»g£t_t
;

227 
g»g£t_t
 
	mg»gs
;

230 
å»g£t_t
 
	må»gs
;

231 
	mŞdmask
;

232 
	mü2
;

233 } 
	tmcÚ‹xt_t
;

236 
	sucÚ‹xt


238 
	muc_æags
;

239 
ucÚ‹xt
 *
	muc_lšk
;

240 
¡ack_t
 
	muc_¡ack
;

241 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

242 
__sig£t_t
 
	muc_sigmask
;

243 
_libc_å¡©e
 
	m__å»gs_mem
;

244 } 
	tucÚ‹xt_t
;

	@/usr/include/time.h

24 #iâdef 
_TIME_H


26 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

27 ! 
defšed
 
	g__Ãed_time¥ec
)

28 
	#_TIME_H
 1

	)

29 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 #ifdef 
_TIME_H


37 
	#__Ãed_size_t


	)

38 
	#__Ãed_NULL


	)

39 
	~<¡ddef.h
>

43 
	~<b™s/time.h
>

46 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


47 #iâdeà
CLK_TCK


48 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

54 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

55 
	#__şock_t_defšed
 1

	)

57 
	~<b™s/ty³s.h
>

59 
__BEGIN_NAMESPACE_STD


61 
__şock_t
 
	tşock_t
;

62 
	g__END_NAMESPACE_STD


63 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


64 
	$__USING_NAMESPACE_STD
(
şock_t
)

68 #undeà
__Ãed_şock_t


70 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

71 
	#__time_t_defšed
 1

	)

73 
	~<b™s/ty³s.h
>

75 
__BEGIN_NAMESPACE_STD


77 
__time_t
 
	ttime_t
;

78 
__END_NAMESPACE_STD


79 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


80 
	$__USING_NAMESPACE_STD
(
time_t
)

84 #undeà
__Ãed_time_t


86 #ià!
defšed
 
__şockid_t_defšed
 && \

87 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

88 
	#__şockid_t_defšed
 1

	)

90 
	~<b™s/ty³s.h
>

93 
__şockid_t
 
	tşockid_t
;

96 #undeà
__şockid_time_t


98 #ià!
defšed
 
__tim”_t_defšed
 && \

99 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

100 
	#__tim”_t_defšed
 1

	)

102 
	~<b™s/ty³s.h
>

105 
__tim”_t
 
	ttim”_t
;

108 #undeà
__Ãed_tim”_t


111 #ià!
defšed
 
__time¥ec_defšed
 && \

112 ((
defšed
 
_TIME_H
 && \

113 (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
)) || \

114 
defšed
 
__Ãed_time¥ec
)

115 
	#__time¥ec_defšed
 1

	)

117 
	~<b™s/ty³s.h
>

121 
	stime¥ec


123 
__time_t
 
tv_£c
;

124 
tv_n£c
;

128 #undeà
__Ãed_time¥ec


131 #ifdef 
_TIME_H


132 
__BEGIN_NAMESPACE_STD


134 
	stm


136 
tm_£c
;

137 
tm_mš
;

138 
tm_hour
;

139 
tm_mday
;

140 
tm_mÚ
;

141 
tm_y—r
;

142 
tm_wday
;

143 
tm_yday
;

144 
tm_isd¡
;

146 #ifdef 
__USE_BSD


147 
tm_gmtoff
;

148 
__cÚ¡
 *
tm_zÚe
;

150 
__tm_gmtoff
;

151 
__cÚ¡
 *
__tm_zÚe
;

154 
__END_NAMESPACE_STD


155 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


156 
	$__USING_NAMESPACE_STD
(
tm
)

160 #ifdeà
__USE_POSIX199309


162 
	s™im”¥ec


164 
time¥ec
 
™_š‹rv®
;

165 
time¥ec
 
™_v®ue
;

169 
sigev’t
;

173 #ifdeà
__USE_XOPEN2K


174 #iâdeà
__pid_t_defšed


175 
__pid_t
 
	tpid_t
;

176 
	#__pid_t_defšed


	)

181 
__BEGIN_NAMESPACE_STD


184 
şock_t
 
	$şock
 (è
__THROW
;

187 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

190 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

191 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

194 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

200 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

201 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

202 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

203 
__END_NAMESPACE_STD


205 #ifdeà
__USE_XOPEN


208 *
	$¡½time
 (
__cÚ¡
 *
__»¡riù
 
__s
,

209 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
)

210 
__THROW
;

213 #ifdeà
__USE_GNU


216 
	~<xloÿË.h
>

218 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

219 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

220 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

221 
__loÿË_t
 
__loc
è
__THROW
;

223 *
	$¡½time_l
 (
__cÚ¡
 *
__»¡riù
 
__s
,

224 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
,

225 
__loÿË_t
 
__loc
è
__THROW
;

229 
__BEGIN_NAMESPACE_STD


232 
tm
 *
	$gmtime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

236 
tm
 *
	$loÿÉime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

237 
__END_NAMESPACE_STD


239 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


242 
tm
 *
	$gmtime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

243 
tm
 *
__»¡riù
 
__
è
__THROW
;

247 
tm
 *
	$loÿÉime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

248 
tm
 *
__»¡riù
 
__
è
__THROW
;

251 
__BEGIN_NAMESPACE_STD


254 *
	$asùime
 (
__cÚ¡
 
tm
 *
__
è
__THROW
;

257 *
	$ùime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

258 
__END_NAMESPACE_STD


260 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


265 *
	$asùime_r
 (
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

266 *
__»¡riù
 
__buf
è
__THROW
;

269 *
	$ùime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

270 *
__»¡riù
 
__buf
è
__THROW
;

275 *
__tzÇme
[2];

276 
__daylight
;

277 
__timezÚe
;

280 #ifdef 
__USE_POSIX


282 *
tzÇme
[2];

286 
	$tz£t
 (è
__THROW
;

289 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


290 
daylight
;

291 
timezÚe
;

294 #ifdeà
__USE_SVID


297 
	$¡ime
 (
__cÚ¡
 
time_t
 *
__wh’
è
__THROW
;

303 
	#__i¦—p
(
y—r
) \

304 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

307 #ifdeà
__USE_MISC


312 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

315 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

318 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

322 #ifdeà
__USE_POSIX199309


327 
	`Çno¦“p
 (
__cÚ¡
 
time¥ec
 *
__»que¡ed_time
,

328 
time¥ec
 *
__»maššg
);

332 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

335 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

338 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, 
__cÚ¡
 
time¥ec
 *
__
)

339 
__THROW
;

341 #ifdeà
__USE_XOPEN2K


346 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

347 
__cÚ¡
 
time¥ec
 *
__»q
,

348 
time¥ec
 *
__»m
);

351 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

356 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

357 
sigev’t
 *
__»¡riù
 
__evp
,

358 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

361 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

364 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

365 
__cÚ¡
 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

366 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

369 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

370 
__THROW
;

373 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

377 #ifdeà
__USE_XOPEN_EXTENDED


389 
g‘d©e_”r
;

398 
tm
 *
	`g‘d©e
 (
__cÚ¡
 *
__¡ršg
);

401 #ifdeà
__USE_GNU


412 
	`g‘d©e_r
 (
__cÚ¡
 *
__»¡riù
 
__¡ršg
,

413 
tm
 *
__»¡riù
 
__»sbuå
);

416 
__END_DECLS


	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/time.h

24 #iâdeà
__Ãed_timev®


25 #iâdeà
_BITS_TIME_H


26 
	#_BITS_TIME_H
 1

	)

34 
	#CLOCKS_PER_SEC
 1000000l

	)

36 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


39 
	~<b™s/ty³s.h
>

40 
__syscÚf
 ();

41 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

44 #ifdeà
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

55 
	#TIMER_ABSTIME
 1

	)

61 #ifdeà
__Ãed_timev®


62 #undeà
__Ãed_timev®


63 #iâdeà
_STRUCT_TIMEVAL


64 
	#_STRUCT_TIMEVAL
 1

	)

65 
	~<b™s/ty³s.h
>

69 
	stimev®


71 
__time_t
 
	mtv_£c
;

72 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/bits/typesizes.h

20 #iâdeà
_BITS_TYPES_H


24 #iâdef 
_BITS_TYPESIZES_H


25 
	#_BITS_TYPESIZES_H
 1

	)

30 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

31 
	#__UID_T_TYPE
 
__U32_TYPE


	)

32 
	#__GID_T_TYPE
 
__U32_TYPE


	)

33 
	#__INO_T_TYPE
 
__ULONGWORD_TYPE


	)

34 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

35 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

36 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

37 
	#__OFF_T_TYPE
 
__SLONGWORD_TYPE


	)

38 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

39 
	#__PID_T_TYPE
 
__S32_TYPE


	)

40 
	#__RLIM_T_TYPE
 
__ULONGWORD_TYPE


	)

41 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

42 
	#__BLKCNT_T_TYPE
 
__SLONGWORD_TYPE


	)

43 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

44 
	#__FSBLKCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

45 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

46 
	#__FSFILCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

47 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

48 
	#__ID_T_TYPE
 
__U32_TYPE


	)

49 
	#__CLOCK_T_TYPE
 
__SLONGWORD_TYPE


	)

50 
	#__TIME_T_TYPE
 
__SLONGWORD_TYPE


	)

51 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

52 
	#__SUSECONDS_T_TYPE
 
__SLONGWORD_TYPE


	)

53 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

54 
	#__SWBLK_T_TYPE
 
__SLONGWORD_TYPE


	)

55 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

56 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

57 
	#__TIMER_T_TYPE
 *

	)

58 
	#__BLKSIZE_T_TYPE
 
__SLONGWORD_TYPE


	)

59 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

60 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

63 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___k”Ãl_co¦


	)

11 
	#__¡ub___k”Ãl_sšl


	)

12 
	#__¡ub___k”Ãl_Æ


	)

13 
	#__¡ub_chæags


	)

14 
	#__¡ub_ç‰ach


	)

15 
	#__¡ub_fchæags


	)

16 
	#__¡ub_fd‘ach


	)

17 
	#__¡ub_g‰y


	)

18 
	#__¡ub_lchmod


	)

19 
	#__¡ub_lutimes


	)

20 
	#__¡ub_»voke


	)

21 
	#__¡ub_£ogš


	)

22 
	#__¡ub_sig»tuº


	)

23 
	#__¡ub_s¡k


	)

24 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___k”Ãl_co¦


	)

11 
	#__¡ub___k”Ãl_»m_pio2l


	)

12 
	#__¡ub___k”Ãl_sšl


	)

13 
	#__¡ub___k”Ãl_Æ


	)

14 
	#__¡ub_bdæush


	)

15 
	#__¡ub_chæags


	)

16 
	#__¡ub_ç‰ach


	)

17 
	#__¡ub_fchæags


	)

18 
	#__¡ub_fd‘ach


	)

19 
	#__¡ub_ãupd©“nv


	)

20 
	#__¡ub_g‘msg


	)

21 
	#__¡ub_g‰y


	)

22 
	#__¡ub_lchmod


	)

23 
	#__¡ub_lutimes


	)

24 
	#__¡ub_putmsg


	)

25 
	#__¡ub_»voke


	)

26 
	#__¡ub_£ogš


	)

27 
	#__¡ub_sig»tuº


	)

28 
	#__¡ub_s¡k


	)

29 
	#__¡ub_¡ty


	)

	@/usr/include/xlocale.h

21 #iâdeà
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loÿË_¡ruù


31 
loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

40 } *
	t__loÿË_t
;

	@
1
.
1
/usr/include
41
927
SpAddrSpace.C
SpAgent.C
SpArch-i386.C
SpArch-x86_64.C
SpContext.C
SpEvent.C
SpInstrumenter.C
SpIpcMgr.C
SpParser.C
SpPayload.C
SpPointMaker.h
SpPropeller.C
SpSnippet.C
/usr/include/sys/wait.h
/usr/include/bits/siginfo.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/features.h
/usr/include/signal.h
/usr/include/sys/resource.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/resource.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/signum.h
/usr/include/bits/sigset.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/bits/types.h
/usr/include/bits/wordsize.h
/usr/include/endian.h
/usr/include/gnu/stubs.h
/usr/include/sys/cdefs.h
/usr/include/sys/ucontext.h
/usr/include/time.h
/usr/include/bits/endian.h
/usr/include/bits/time.h
/usr/include/bits/typesizes.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/xlocale.h
